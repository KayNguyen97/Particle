LavaPack.loadBundle([[3556,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"eth-receipt-log-trie":153,"eth-reciept-log":154,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,"caip-50":202,streamid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,noise:454,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,"swhid-1-snp":496,json:512,messagepack:513,"libp2p-peer-record":769,"libp2p-relay-rsvp":770,"car-index-sorted":1024,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,"secp256k1-priv":4865,"x25519-priv":4866,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056,"arweave-ns":11704592});t.exports={baseTable:r}}}},{package:"@ensdomains/content-hash>multicodec",file:"node_modules/multicodec/src/generated-table.js"}],[3557,{"./maps":3558,"./util":3559,"uint8arrays/concat":3551,varint:4108},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("varint"),{concat:s}=e("uint8arrays/concat"),i=e("./util"),{nameToVarint:o,constantToCode:a,nameToCode:l,codeToName:c}=e("./maps");function d(e){const t=r.decode(e),n=c[t];if(n===undefined)throw new Error(`Code "${t}" not found`);return n}function u(e){return c[e]}function h(e){const t=l[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function p(e){return r.decode(e)}function f(e){const t=o[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function g(e){return i.varintEncode(e)}t.exports={addPrefix:function(e,t){let n;if(e instanceof Uint8Array)n=i.varintUint8ArrayEncode(e);else{if(!o[e])throw new Error("multicodec not recognized");n=o[e]}return s([n,t],n.length+t.length)},rmPrefix:function(e){return r.decode(e),e.slice(r.decode.bytes)},getNameFromData:d,getNameFromCode:u,getCodeFromName:h,getCodeFromData:p,getVarintFromName:f,getVarintFromCode:g,getCodec:function(e){return d(e)},getName:function(e){return u(e)},getNumber:function(e){return h(e)},getCode:function(e){return p(e)},getCodeVarint:function(e){return f(e)},getVarint:function(e){return Array.from(g(e))},...a,nameToVarint:o,nameToCode:l,codeToName:c}}}},{package:"@ensdomains/content-hash>multicodec",file:"node_modules/multicodec/src/index.js"}],[3558,{"./generated-table":3556,"./util":3559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{baseTable:r}=e("./generated-table"),s=e("./util").varintEncode,i={},o={},a={};for(const e in r){const t=e,n=r[t];i[t]=s(n);o[t.toUpperCase().replace(/-/g,"_")]=n,a[n]||(a[n]=t)}Object.freeze(i),Object.freeze(o),Object.freeze(a);const l=Object.freeze(r);t.exports={nameToVarint:i,constantToCode:o,nameToCode:l,codeToName:a}}}},{package:"@ensdomains/content-hash>multicodec",file:"node_modules/multicodec/src/maps.js"}],[3559,{"uint8arrays/from-string":3552,"uint8arrays/to-string":3553,varint:4108},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("varint"),{toString:s}=e("uint8arrays/to-string"),{fromString:i}=e("uint8arrays/from-string");function o(e){return parseInt(s(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return i(t,"base16")},uint8ArrayToNumber:o,varintUint8ArrayEncode:function(e){return Uint8Array.from(r.encode(o(e)))},varintEncode:function(e){return Uint8Array.from(r.encode(e))}}}}},{package:"@ensdomains/content-hash>multicodec",file:"node_modules/multicodec/src/util.js"}],[3561,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("./base.js").baseX({prefix:"9",name:"base10",alphabet:"0123456789"});n.base10=r}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base10.js"}],[3562,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base.js");const s=r.rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),i=r.rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});n.base16=s,n.base16upper=i}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base16.js"}],[3563,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("./base.js").rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});n.base2=r}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base2.js"}],[3564,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base.js");const s=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),i=s.reduce(((e,t,n)=>(e[n]=t,e)),[]),o=s.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const a=r.from({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=i[t]),"")},decode:function(e){const t=[];for(const n of e){const e=o[n.codePointAt(0)];if(e===undefined)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}});n.base256emoji=a}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base256emoji.js"}],[3566,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base.js");const s=r.baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),i=r.baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});n.base36=s,n.base36upper=i}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base36.js"}],[3568,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base.js");const s=r.rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),i=r.rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o=r.rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=r.rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});n.base64=s,n.base64pad=i,n.base64url=o,n.base64urlpad=a}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base64.js"}],[3569,{"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("./base.js").rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});n.base8=r}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/base8.js"}],[3570,{"../bytes.js":3572,"./base.js":3560},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base.js"),s=e("../bytes.js");const i=r.from({prefix:"\0",name:"identity",encode:e=>s.toString(e),decode:e=>s.fromString(e)});n.identity=i}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/bases/identity.js"}],[3571,{"./bases/base10.js":3561,"./bases/base16.js":3562,"./bases/base2.js":3563,"./bases/base256emoji.js":3564,"./bases/base32.js":3565,"./bases/base36.js":3566,"./bases/base58.js":3567,"./bases/base64.js":3568,"./bases/base8.js":3569,"./bases/identity.js":3570,"./bytes.js":3572,"./cid.js":3573,"./codecs/json.js":3574,"./codecs/raw.js":3575,"./hashes/digest.js":3576,"./hashes/hasher.js":3577,"./hashes/identity.js":3578,"./hashes/sha2.js":3579,"./index.js":3580,"./varint.js":3581},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./bases/identity.js"),s=e("./bases/base2.js"),i=e("./bases/base8.js"),o=e("./bases/base10.js"),a=e("./bases/base16.js"),l=e("./bases/base32.js"),c=e("./bases/base36.js"),d=e("./bases/base58.js"),u=e("./bases/base64.js"),h=e("./bases/base256emoji.js"),p=e("./hashes/sha2.js"),f=e("./hashes/identity.js"),g=e("./codecs/raw.js"),m=e("./codecs/json.js");e("./index.js");var b=e("./cid.js"),y=e("./hashes/hasher.js"),w=e("./hashes/digest.js"),k=e("./varint.js"),_=e("./bytes.js");const v={...r,...s,...i,...o,...a,...l,...c,...d,...u,...h},C={...p,...f},S={raw:g,json:m};n.CID=b.CID,n.hasher=y,n.digest=w,n.varint=k,n.bytes=_,n.bases=v,n.codecs=S,n.hashes=C}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/basics.js"}],[3574,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=new TextEncoder,s=new TextDecoder;n.code=512,n.decode=e=>JSON.parse(s.decode(e)),n.encode=e=>r.encode(JSON.stringify(e)),n.name="json"}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/codecs/json.js"}],[3575,{"../bytes.js":3572},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("../bytes.js");n.code=85,n.decode=e=>r.coerce(e),n.encode=e=>r.coerce(e),n.name="raw"}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/codecs/raw.js"}],[3577,{"./digest.js":3576},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./digest.js");class s{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?r.create(this.code,t):t.then((e=>r.create(this.code,e)))}throw Error("Unknown type, must be binary type")}}n.Hasher=s,n.from=({name:e,code:t,encode:n})=>new s(e,t,n)}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/hashes/hasher.js"}],[3578,{"../bytes.js":3572,"./digest.js":3576},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("../bytes.js"),s=e("./digest.js");const i=r.coerce,o={code:0,name:"identity",encode:i,digest:e=>s.create(0,i(e))};n.identity=o}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/hashes/identity.js"}],[3579,{"./hasher.js":3577},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./hasher.js");const s=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),i=r.from({name:"sha2-256",code:18,encode:s("SHA-256")}),o=r.from({name:"sha2-512",code:19,encode:s("SHA-512")});n.sha256=i,n.sha512=o}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/hashes/sha2-browser.js"}],[3580,{"./bytes.js":3572,"./cid.js":3573,"./hashes/digest.js":3576,"./hashes/hasher.js":3577,"./varint.js":3581},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./cid.js"),s=e("./varint.js"),i=e("./bytes.js"),o=e("./hashes/hasher.js"),a=e("./hashes/digest.js");n.CID=r.CID,n.varint=s,n.bytes=i,n.hasher=o,n.digest=a}}},{package:"@metamask/assets-controllers>multiformats",file:"node_modules/multiformats/cjs/src/index.js"}],[3584,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function e(t,n){var i,o=0,a=0,l=n=n||0,c=t.length;do{if(l>=c)throw e.bytes=0,new RangeError("Could not decode varint");i=t[l++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return e.bytes=l-n,o};var r=128,s=127}}},{package:"@ensdomains/content-hash>cids>multihashes>varint",file:"node_modules/multihashes/node_modules/varint/decode.js"}],[3585,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function e(t,n,o){n=n||[];var a=o=o||0;for(;t>=i;)n[o++]=255&t|r,t/=128;for(;t&s;)n[o++]=255&t|r,t>>>=7;return n[o]=0|t,e.bytes=o-a+1,n};var r=128,s=-128,i=Math.pow(2,31)}}},{package:"@ensdomains/content-hash>cids>multihashes>varint",file:"node_modules/multihashes/node_modules/varint/encode.js"}],[3586,{"./decode.js":3584,"./encode.js":3585,"./length.js":3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"@ensdomains/content-hash>cids>multihashes>varint",file:"node_modules/multihashes/node_modules/varint/index.js"}],[3587,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=Math.pow(2,7),s=Math.pow(2,14),i=Math.pow(2,21),o=Math.pow(2,28),a=Math.pow(2,35),l=Math.pow(2,42),c=Math.pow(2,49),d=Math.pow(2,56),u=Math.pow(2,63);t.exports=function(e){return e<r?1:e<s?2:e<i?3:e<o?4:e<a?5:e<l?6:e<c?7:e<d?8:e<u?9:10}}}},{package:"@ensdomains/content-hash>cids>multihashes>varint",file:"node_modules/multihashes/node_modules/varint/length.js"}],[3588,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});t.exports={names:r}}}},{package:"@ensdomains/content-hash>cids>multihashes",file:"node_modules/multihashes/src/constants.js"}],[3589,{"./constants":3588,multibase:3547,"uint8arrays/concat":4046,"uint8arrays/from-string":4048,"uint8arrays/to-string":4049,varint:3586},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("multibase"),s=e("varint"),{names:i}=e("./constants"),o=e("uint8arrays/to-string"),a=e("uint8arrays/from-string"),l=e("uint8arrays/concat"),c={};for(const e in i){const t=e;c[i[t]]=t}function d(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=s.decode(e);if(!p(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(s.decode.bytes);const n=s.decode(e);if(n<0)throw new Error(`multihash invalid length: ${n}`);if((e=e.slice(s.decode.bytes)).length!==n)throw new Error(`multihash length inconsistent: 0x${o(e,"base16")}`);return{code:t,name:c[t],length:n,digest:e}}function u(e){let t=e;if("string"==typeof e){if(i[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=i[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(c[t]===undefined&&!h(t))throw new Error(`Unrecognized function code: ${t}`);return t}function h(e){return e>0&&e<16}function p(e){return!!h(e)||!!c[e]}function f(e){d(e)}Object.freeze(c),t.exports={names:i,codes:c,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(r.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?o(e):e;return r.decode("z"+t)},decode:d,encode:function(e,t,n){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const r=u(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==n&&(n=e.length),n&&e.length!==n)throw new Error("digest length should be equal to specified length.");const i=s.encode(r),o=s.encode(n);return l([i,o,e],i.length+o.length+e.length)},coerceCode:u,isAppCode:h,validate:f,prefix:function(e){return f(e),e.subarray(0,2)},isValidCode:p}}}},{package:"@ensdomains/content-hash>cids>multihashes",file:"node_modules/multihashes/src/index.js"}],[3590,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){for(var r=self.crypto||self.msCrypto,s="-_",i=36;i--;)s+=i.toString(36);for(i=36;i---10;)s+=i.toString(36).toUpperCase();t.exports=function(e){var t="",n=r.getRandomValues(new Uint8Array(e||21));for(i=e||21;i--;)t+=s[63&n[i]];return t}}}},{package:"nanoid",file:"node_modules/nanoid/index.browser.js"}],[36,{loglevel:3503},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,r){r((r=>{n.error&&s.default.debug("Error in RPC response:\n",n),t.isMetamaskInternal||(s.default.info(`RPC (${e.origin}): ${t.method} -> ${n.error?"error":"success"}`),r())}))}};var r,s=(r=e("loglevel"))&&r.__esModule?r:{default:r}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[3699,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)}}},{package:"@metamask/snaps-controllers>tar-stream>streamx>queue-tick",file:"node_modules/queue-tick/queue-microtask.js"}],[37,{"../../../shared/modules/mv3.utils":4187,"eth-rpc-errors":2885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("eth-rpc-errors"),s=e("../../../shared/modules/mv3.utils");n.default=(e,t,n,i)=>async o=>{if(t._writableState.ended)return;if(!e[o.method])return void t.write({jsonrpc:"2.0",error:r.ethErrors.rpc.methodNotFound({message:`${o.method} not found`}),id:o.id});let a,l;try{a=await e[o.method](...o.params)}catch(e){l=e}finally{s.isManifestV3&&n&&"getState"!==o.method&&i.set(n.getState())}t._writableState.ended?l&&console.error(l):l?t.write({jsonrpc:"2.0",error:(0,r.serializeError)(l,{shouldIncludeStack:!0}),id:o.id}):t.write({jsonrpc:"2.0",result:a,id:o.id})}}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[38,{"./middleware/pending":56,"@metamask/eth-json-rpc-middleware":1114,"json-rpc-engine":3316},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({version:e,getAccounts:t,processTransaction:n,processEthSignMessage:o,processTypedMessage:a,processTypedMessageV3:l,processTypedMessageV4:c,processPersonalMessage:d,processDecryptMessage:u,processEncryptionPublicKey:h,getPendingNonce:p,getPendingTransactionByHash:f}){return(0,r.mergeMiddleware)([(0,r.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,s.createWalletMiddleware)({getAccounts:t,processTransaction:n,processEthSignMessage:o,processTypedMessage:a,processTypedMessageV3:l,processTypedMessageV4:c,processPersonalMessage:d,processDecryptMessage:u,processEncryptionPublicKey:h}),(0,i.createPendingNonceMiddleware)({getPendingNonce:p}),(0,i.createPendingTxMiddleware)({getPendingTransactionByHash:f})])};var r=e("json-rpc-engine"),s=e("@metamask/eth-json-rpc-middleware"),i=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[3879,{"readable-stream":3894},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ReadableWebToNodeStream=void 0;const r=e("readable-stream");class s extends r.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}n.ReadableWebToNodeStream=s}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream",file:"node_modules/readable-web-to-node-stream/lib/index.js"}],[3880,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r={};function s(e,t,n){n||(n=Error);var s=function(e){var n,r;function s(n,r,s){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,s))||this}return r=e,(n=s).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,s}(n);s.prototype.name=n.name,s.prototype.code=e,r[e]=s}function i(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}s("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),s("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,s,o,a;if("string"==typeof t&&(s="not ",t.substr(!o||o<0?0:+o,s.length)===s)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(n===undefined||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(r," ").concat(i(t,"type"));else{var l=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(l," ").concat(r," ").concat(i(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/errors-browser.js"}],[3881,{"./_stream_readable":3883,"./_stream_writable":3885,_process:3648,inherits:3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=c;var s=e("./_stream_readable"),i=e("./_stream_writable");e("inherits")(c,s);for(var o=r(i.prototype),a=0;a<o.length;a++){var l=o[a];c.prototype[l]||(c.prototype[l]=i.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);s.call(this,e),i.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||n.nextTick(u,this)}function u(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/_stream_duplex.js"}],[3882,{"./_stream_transform":3884,inherits:3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=s;var r=e("./_stream_transform");function s(e){if(!(this instanceof s))return new s(e);r.call(this,e)}e("inherits")(s,r),s.prototype._transform=function(e,t,n){n(null,e)}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/_stream_passthrough.js"}],[3883,{"../errors":3880,"./_stream_duplex":3881,"./internal/streams/async_iterator":3886,"./internal/streams/buffer_list":3887,"./internal/streams/destroy":3888,"./internal/streams/from":3890,"./internal/streams/state":3892,"./internal/streams/stream":3893,_process:3648,buffer:2654,events:2956,inherits:3277,"string_decoder/":4018,util:2619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;t.exports=S,S.ReadableState=C;e("events").EventEmitter;var s=function(e,t){return e.listeners(t).length},i=e("./internal/streams/stream"),o=e("buffer").Buffer,a=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,c=e("util");l=c&&c.debuglog?c.debuglog("stream"):function(){};var d,u,h,p=e("./internal/streams/buffer_list"),f=e("./internal/streams/destroy"),g=e("./internal/streams/state").getHighWaterMark,m=e("../errors").codes,b=m.ERR_INVALID_ARG_TYPE,y=m.ERR_STREAM_PUSH_AFTER_EOF,w=m.ERR_METHOD_NOT_IMPLEMENTED,k=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(S,i);var _=f.errorOrDestroy,v=["error","close","destroy","pause","resume"];function C(t,n,s){r=r||e("./_stream_duplex"),t=t||{},"boolean"!=typeof s&&(s=n instanceof r),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",s),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=e("string_decoder/").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function S(t){if(r=r||e("./_stream_duplex"),!(this instanceof S))return new S(t);var n=this instanceof r;this._readableState=new C(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),i.call(this)}function T(e,t,n,r,s){l("readableAddChunk",t);var i,c=e._readableState;if(null===t)c.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,x(e)))}(e,c);else if(s||(i=function(e,t){var n;r=t,o.isBuffer(r)||r instanceof a||"string"==typeof t||t===undefined||e.objectMode||(n=new b("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(c,t)),i)_(e,i);else if(c.objectMode||t&&t.length>0)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),r)c.endEmitted?_(e,new k):E(e,c,t,!0);else if(c.ended)_(e,new y);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?E(e,c,t,!1):R(e,c)):E(e,c,t,!1)}else r||(c.reading=!1,R(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function E(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&P(e)),R(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=f.destroy,S.prototype._undestroy=f.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=o.from(e,t),t=""),n=!0),T(this,e,t,!1,n)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(t){d||(d=e("string_decoder/").StringDecoder);var n=new d(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,s="";null!==r;)s+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==s&&this._readableState.buffer.push(s),this._readableState.length=s.length,this};var A=1073741824;function M(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(x,e))}function x(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function R(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(N,e,t))}function N(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function I(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function O(e){l("readable nexttick read 0"),e.read(0)}function j(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function U(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(F,t,e))}function F(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function q(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):P(this),null;if(0===(e=M(e,t))&&t.ended)return 0===t.length&&U(this),null;var r,s=t.needReadable;return l("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",s=!0),t.ended||t.reading?l("reading or ended",s=!1):s&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=M(n,t))),null===(r=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&U(this)),null!==r&&this.emit("data",r),r},S.prototype._read=function(e){_(this,new w("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:m;function a(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",f),e.removeListener("finish",g),e.removeListener("drain",d),e.removeListener("error",p),e.removeListener("unpipe",a),r.removeListener("end",c),r.removeListener("end",m),r.removeListener("data",h),u=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function c(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",a);var d=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,L(e))}}(r);e.on("drain",d);var u=!1;function h(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==q(i.pipes,e))&&!u&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function p(t){l("onerror",t),m(),e.removeListener("error",p),0===s(e,"error")&&_(e,t)}function f(){e.removeListener("finish",g),m()}function g(){l("onfinish"),e.removeListener("close",f),m()}function m(){l("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",p),e.once("close",f),e.once("finish",g),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<s;i++)r[i].emit("unpipe",this,{hasUnpiped:!1});return this}var o=q(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},S.prototype.on=function(e,t){var r=i.prototype.on.call(this,e,t),s=this._readableState;return"data"===e?(s.readableListening=this.listenerCount("readable")>0,!1!==s.flowing&&this.resume()):"readable"===e&&(s.endEmitted||s.readableListening||(s.readableListening=s.needReadable=!0,s.flowing=!1,s.emittedReadable=!1,l("on readable",s.length,s.reading),s.length?P(this):s.reading||n.nextTick(O,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=i.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(I,this),r},S.prototype.removeAllListeners=function(e){var t=i.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||n.nextTick(I,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(j,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var s in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){(l("wrapped data"),n.decoder&&(s=n.decoder.write(s)),!n.objectMode||null!==s&&s!==undefined)&&((n.objectMode||s&&s.length)&&(t.push(s)||(r=!0,e.pause())))})),e)this[s]===undefined&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var i=0;i<v.length;i++)e.on(v[i],this.emit.bind(this,v[i]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return u===undefined&&(u=e("./internal/streams/async_iterator")),u(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=D,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(t,n){return h===undefined&&(h=e("./internal/streams/from")),h(S,t,n)})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/_stream_readable.js"}],[3884,{"../errors":3880,"./_stream_duplex":3881,inherits:3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=d;var r=e("../errors").codes,s=r.ERR_METHOD_NOT_IMPLEMENTED,i=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new i);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function d(e){if(!(this instanceof d))return new d(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function u(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(d,l),d.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},d.prototype._transform=function(e,t,n){n(new s("_transform()"))},d.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var s=this._readableState;(r.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},d.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},d.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/_stream_transform.js"}],[3885,{"../errors":3880,"./_stream_duplex":3881,"./internal/streams/destroy":3888,"./internal/streams/state":3892,"./internal/streams/stream":3893,_process:3648,buffer:2654,inherits:3277,"util-deprecate":4083},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var s=r.callback;t.pendingcb--,s(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var s;t.exports=S,S.WritableState=C;var i={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,l=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,d=e("./internal/streams/destroy"),u=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,p=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,m=h.ERR_STREAM_CANNOT_PIPE,b=h.ERR_STREAM_DESTROYED,y=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,k=h.ERR_UNKNOWN_ENCODING,_=d.errorOrDestroy;function v(){}function C(t,i,o){s=s||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=i instanceof s),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=u(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,s=r.sync,i=r.writecb;if("function"!=typeof i)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,s,i){--t.pendingcb,r?(n.nextTick(i,s),n.nextTick(x,e,t),e._writableState.errorEmitted=!0,_(e,s)):(i(s),e._writableState.errorEmitted=!0,_(e,s),x(e,t))}(e,r,s,t,i);else{var o=M(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||A(e,r),s?n.nextTick(E,e,r,o,i):E(e,r,o,i)}}(i,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function S(t){var n=this instanceof(s=s||e("./_stream_duplex"));if(!n&&!c.call(S,this))return new S(t);this._writableState=new C(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function T(e,t,n,r,s,i,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):n?e._writev(s,t.onwrite):e._write(s,i,t.onwrite),t.sync=!1}function E(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),x(e,t)}function A(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var s=t.bufferedRequestCount,i=new Array(s),o=t.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)i[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;i.allBuffers=l,T(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,d=n.encoding,u=n.callback;if(T(e,t,!1,t.objectMode?1:c.length,c,d,u),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function M(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(e,t){var r=M(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var s=e._readableState;(!s||s.autoDestroy&&s.endEmitted)&&e.destroy()}return r}e("inherits")(S,o),C.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(C.prototype,"buffer",{get:i.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof C)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){_(this,new m)},S.prototype.write=function(e,t,r){var s,i=this._writableState,o=!1,c=!i.objectMode&&(s=e,a.isBuffer(s)||s instanceof l);return c&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(r=t,t=null),c?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=v),i.ending?function(e,t){var r=new w;_(e,r),n.nextTick(t,r)}(this,r):(c||function(e,t,r,s){var i;return null===r?i=new y:"string"==typeof r||t.objectMode||(i=new p("chunk",["string","Buffer"],r)),!i||(_(e,i),n.nextTick(s,i),!1)}(this,i,e,r))&&(i.pendingcb++,o=function(e,t,n,r,s,i){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,n));return t}(t,r,s);r!==o&&(n=!0,s="buffer",r=o)}var l=t.objectMode?1:r.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:s,isBuf:n,callback:i,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,l,r,s,i);return c}(this,i,c,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new k(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,n){n(new f("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var s=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),s.corked&&(s.corked=1,this.uncork()),s.ending||function(e,t,r){t.ending=!0,x(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,s,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=d.destroy,S.prototype._undestroy=d.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/_stream_writable.js"}],[3886,{"./end-of-stream":3889,_process:3648},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),d=Symbol("lastPromise"),u=Symbol("handlePromise"),h=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[o];if(null!==t){var n=e[h].read();null!==n&&(e[d]=null,e[o]=null,e[a]=null,t(p(n,!1)))}}function g(e){n.nextTick(f,e)}var m=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((s(r={get stream(){return this[h]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(p(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[l]?r(e[l]):t(p(undefined,!0))}))}));var r,s=this[d];if(s)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(p(undefined,!0)):t[u](n,r)}),r)}}(s,this));else{var i=this[h].read();if(null!==i)return Promise.resolve(p(i,!1));r=new Promise(this[u])}return this[d]=r,r}},Symbol.asyncIterator,(function(){return this})),s(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(p(undefined,!0))}))}))})),r),m);t.exports=function(e){var t,n=Object.create(b,(s(t={},h,{value:e,writable:!0}),s(t,o,{value:null,writable:!0}),s(t,a,{value:null,writable:!0}),s(t,l,{value:null,writable:!0}),s(t,c,{value:e._readableState.endEmitted,writable:!0}),s(t,u,{value:function(e,t){var r=n[h].read();r?(n[d]=null,n[o]=null,n[a]=null,e(p(r,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[d]=null,i(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[d]=null,n[o]=null,n[a]=null,t(e)),void(n[l]=e)}var r=n[o];null!==r&&(n[d]=null,n[o]=null,n[a]=null,r(p(undefined,!0))),n[c]=!0})),e.on("readable",g.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/async_iterator.js"}],[3887,{buffer:2654,util:2619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=e("buffer").Buffer,c=e("util").inspect,d=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return l.alloc(0);for(var t,n,r,s=l.allocUnsafe(e>>>0),i=this.head,o=0;i;)t=i.data,n=s,r=o,l.prototype.copy.call(t,n,r),o+=i.data.length,i=i.next;return s}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var s=t.data,i=e>s.length?s.length:e;if(i===s.length?r+=s:r+=s.slice(0,e),0==(e-=i)){i===s.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=s.slice(i));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=l.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var s=n.data,i=e>s.length?s.length:e;if(s.copy(t,t.length-e,0,i),0==(e-=i)){i===s.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(i));break}++r}return this.length-=r,t}},{key:d,value:function(e,t){return c(this,s(s({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/buffer_list.js"}],[3888,{_process:3648},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){s(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}t.exports={destroy:function(t,i){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(i?i(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(s,this,t)):e.nextTick(s,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!i&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(r,o):(o._writableState.errorEmitted=!0,e.nextTick(n,o,t)):e.nextTick(n,o,t):i?(e.nextTick(r,o),i(t)):e.nextTick(r,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/destroy.js"}],[3889,{"../../../errors":3880},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function s(){}t.exports=function e(t,n,i){if("function"==typeof n)return e(t,null,n);n||(n={}),i=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];e.apply(this,r)}}}(i||s);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||d()},c=t._writableState&&t._writableState.finished,d=function(){a=!1,c=!0,o||i.call(t)},u=t._readableState&&t._readableState.endEmitted,h=function(){o=!1,u=!0,a||i.call(t)},p=function(e){i.call(t,e)},f=function(){var e;return o&&!u?(t._readableState&&t._readableState.ended||(e=new r),i.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),i.call(t,e)):void 0},g=function(){t.req.on("finish",d)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",l),t.on("close",l)):(t.on("complete",d),t.on("abort",f),t.req?g():t.on("request",g)),t.on("end",h),t.on("finish",d),!1!==n.error&&t.on("error",p),t.on("close",f),function(){t.removeListener("complete",d),t.removeListener("abort",f),t.removeListener("request",g),t.req&&t.req.removeListener("finish",d),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",d),t.removeListener("end",h),t.removeListener("error",p),t.removeListener("close",f)}}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"}],[3890,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/from-browser.js"}],[3891,{"../../../errors":3880,"./end-of-stream":3889},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;var s=e("../../../errors").codes,i=s.ERR_MISSING_ARGS,o=s.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e){e()}function c(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var d,u=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(n);if(Array.isArray(n[0])&&(n=n[0]),n.length<2)throw new i("streams");var h=n.map((function(t,s){var i=s<n.length-1;return function(t,n,s,i){i=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(i);var a=!1;t.on("close",(function(){a=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:s},(function(e){if(e)return i(e);a=!0,i()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void i(e||new o("pipe"))}}(t,i,s>0,(function(e){d||(d=e),e&&h.forEach(l),i||(h.forEach(l),u(d))}))}));return n.reduce(c)}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/pipeline.js"}],[3892,{"../../../errors":3880},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,s){var i=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,s,n);if(null!=i){if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new r(s?n:"highWaterMark",i);return Math.floor(i)}return e.objectMode?16:16384}}}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/state.js"}],[3893,{events:2956},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/lib/internal/streams/stream-browser.js"}],[3894,{"./lib/_stream_duplex.js":3881,"./lib/_stream_passthrough.js":3882,"./lib/_stream_readable.js":3883,"./lib/_stream_transform.js":3884,"./lib/_stream_writable.js":3885,"./lib/internal/streams/end-of-stream.js":3889,"./lib/internal/streams/pipeline.js":3891},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/snaps-controllers>readable-web-to-node-stream>readable-stream",file:"node_modules/readable-web-to-node-stream/node_modules/readable-stream/readable-browser.js"}],[39,{loglevel:3503,"webextension-polyfill":4122},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({location:e,registerOnboarding:t}){return async function(n,i,o,a){try{if("wallet_registerOnboarding"!==n.method)return void o();n.tabId&&n.tabId!==s.default.tabs.TAB_ID_NONE?await t(e,n.tabId):r.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),i.result=!0,a()}catch(e){a(e)}}};var r=i(e("loglevel")),s=i(e("webextension-polyfill"));function i(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$",file:"app/scripts/lib/createOnboardingMiddleware.js"}],[3902,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(n=t.exports=function(e){return String(e).replace(n.expr,"")}).expr=/\/+$/}}},{package:"remove-trailing-slash",file:"node_modules/remove-trailing-slash/index.js"}],[3910,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e){if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t.push(r(e[n]));const n=p(...t);return p(o(n.length,192),n)}const t=b(e);return 1===t.length&&t[0]<128?t:p(o(t.length,128),t)}function s(e,t,n){if(n>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,n)}function i(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return u(d(e))}function o(e,t){if(e<56)return Uint8Array.from([e+t]);const n=g(e),r=g(t+55+n.length/2);return Uint8Array.from(h(r+n))}function a(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const n=l(b(e));if(t)return n;if(0!==n.remainder.length)throw new Error("invalid RLP: remainder must be zero");return n.data}function l(e){let t,n,r,o,a;const c=[],d=e[0];if(d<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(d<=183){if(t=d-127,r=128===d?Uint8Array.from([]):s(e,1,t),2===t&&r[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:r,remainder:e.slice(t)}}if(d<=191){if(n=d-182,e.length-1<n)throw new Error("invalid RLP: not enough bytes for string length");if(t=i(s(e,1,n)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return r=s(e,n,t+n),{data:r,remainder:e.slice(t+n)}}if(d<=247){for(t=d-191,o=s(e,1,t);o.length;)a=l(o),c.push(a.data),o=a.remainder;return{data:c,remainder:e.slice(t)}}{if(n=d-246,t=i(s(e,1,n)),t<56)throw new Error("invalid RLP: encoded list too short");const r=n+t;if(r>e.length)throw new Error("invalid RLP: total length is larger than the data");for(o=s(e,n,r);o.length;)a=l(o),c.push(a.data),o=a.remainder;return{data:c,remainder:e.slice(r)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.utils=n.decode=n.encode=void 0,n.encode=r,n.decode=a;const c=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function d(e){let t="";for(let n=0;n<e.length;n++)t+=c[e[n]];return t}function u(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n;t[n]=u(e.slice(r,r+2))}return t}function p(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return n}function f(e){return(new TextEncoder).encode(e)}function g(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function m(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function b(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return m(e)?h((t="string"!=typeof(n=e)?n:m(n)?n.slice(2):n).length%2?`0${t}`:t):f(e);var t,n;if("number"==typeof e||"bigint"==typeof e)return e?h(g(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}n.utils={bytesToHex:d,concatBytes:p,hexToBytes:h,utf8ToBytes:f};const y={encode:r,decode:a};n.default=y}}},{package:"eth-lattice-keyring>rlp",file:"node_modules/rlp/dist/index.js"}],[3919,{timers:4029},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){!function(r){const s=2147483647;function i(e){const t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let n=1779033703,r=3144134277,s=1013904242,i=2773480762,o=1359893119,a=2600822924,l=528734635,c=1541459225;const d=new Uint32Array(64);function u(e){let u=0,h=e.length;for(;h>=64;){let p,f,g,m,b,y=n,w=r,k=s,_=i,v=o,C=a,S=l,T=c;for(f=0;f<16;f++)g=u+4*f,d[f]=(255&e[g])<<24|(255&e[g+1])<<16|(255&e[g+2])<<8|255&e[g+3];for(f=16;f<64;f++)p=d[f-2],m=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,p=d[f-15],b=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,d[f]=(m+d[f-7]|0)+(b+d[f-16]|0)|0;for(f=0;f<64;f++)m=(((v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&C^~v&S)|0)+(T+(t[f]+d[f]|0)|0)|0,b=((y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10))+(y&w^y&k^w&k)|0,T=S,S=C,C=v,v=_+m|0,_=k,k=w,w=y,y=m+b|0;n=n+y|0,r=r+w|0,s=s+k|0,i=i+_|0,o=o+v|0,a=a+C|0,l=l+S|0,c=c+T|0,u+=64,h-=64}}u(e);let h,p=e.length%64,f=e.length/536870912|0,g=e.length<<3,m=p<56?56:120,b=e.slice(e.length-p,e.length);for(b.push(128),h=p+1;h<m;h++)b.push(0);return b.push(f>>>24&255),b.push(f>>>16&255),b.push(f>>>8&255),b.push(f>>>0&255),b.push(g>>>24&255),b.push(g>>>16&255),b.push(g>>>8&255),b.push(g>>>0&255),u(b),[n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255,r>>>24&255,r>>>16&255,r>>>8&255,r>>>0&255,s>>>24&255,s>>>16&255,s>>>8&255,s>>>0&255,i>>>24&255,i>>>16&255,i>>>8&255,i>>>0&255,o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255,a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255,l>>>24&255,l>>>16&255,l>>>8&255,l>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255]}function o(e,t,n){e=e.length<=64?e:i(e);const r=64+t.length+4,s=new Array(r),o=new Array(64);let a,l=[];for(a=0;a<64;a++)s[a]=54;for(a=0;a<e.length;a++)s[a]^=e[a];for(a=0;a<t.length;a++)s[64+a]=t[a];for(a=r-4;a<r;a++)s[a]=0;for(a=0;a<64;a++)o[a]=92;for(a=0;a<e.length;a++)o[a]^=e[a];function c(){for(let e=r-1;e>=r-4;e--){if(s[e]++,s[e]<=255)return;s[e]=0}}for(;n>=32;)c(),l=l.concat(i(o.concat(i(s)))),n-=32;return n>0&&(c(),l=l.concat(i(o.concat(i(s))).slice(0,n))),l}function a(e,t,n,r,s){let i;for(u(e,16*(2*n-1),s,0,16),i=0;i<2*n;i++)d(e,16*i,s,16),c(s,r),u(s,0,e,t+16*i,16);for(i=0;i<n;i++)u(e,t+2*i*16,e,16*i,16);for(i=0;i<n;i++)u(e,t+16*(2*i+1),e,16*(i+n),16)}function l(e,t){return e<<t|e>>>32-t}function c(e,t){u(e,0,t,0,16);for(let e=8;e>0;e-=2)t[4]^=l(t[0]+t[12],7),t[8]^=l(t[4]+t[0],9),t[12]^=l(t[8]+t[4],13),t[0]^=l(t[12]+t[8],18),t[9]^=l(t[5]+t[1],7),t[13]^=l(t[9]+t[5],9),t[1]^=l(t[13]+t[9],13),t[5]^=l(t[1]+t[13],18),t[14]^=l(t[10]+t[6],7),t[2]^=l(t[14]+t[10],9),t[6]^=l(t[2]+t[14],13),t[10]^=l(t[6]+t[2],18),t[3]^=l(t[15]+t[11],7),t[7]^=l(t[3]+t[15],9),t[11]^=l(t[7]+t[3],13),t[15]^=l(t[11]+t[7],18),t[1]^=l(t[0]+t[3],7),t[2]^=l(t[1]+t[0],9),t[3]^=l(t[2]+t[1],13),t[0]^=l(t[3]+t[2],18),t[6]^=l(t[5]+t[4],7),t[7]^=l(t[6]+t[5],9),t[4]^=l(t[7]+t[6],13),t[5]^=l(t[4]+t[7],18),t[11]^=l(t[10]+t[9],7),t[8]^=l(t[11]+t[10],9),t[9]^=l(t[8]+t[11],13),t[10]^=l(t[9]+t[8],18),t[12]^=l(t[15]+t[14],7),t[13]^=l(t[12]+t[15],9),t[14]^=l(t[13]+t[12],13),t[15]^=l(t[14]+t[13],18);for(let n=0;n<16;++n)e[n]+=t[n]}function d(e,t,n,r){for(let s=0;s<r;s++)n[s]^=e[t+s]}function u(e,t,n,r,s){for(;s--;)n[r++]=e[t++]}function h(e){if(!e||"number"!=typeof e.length)return!1;for(let t=0;t<e.length;t++){const n=e[t];if("number"!=typeof n||n%1||n<0||n>=256)return!1}return!0}function p(e,t){if("number"!=typeof e||e%1)throw new Error("invalid "+t);return e}function f(t,n,r,i,l,c,f){if(r=p(r,"N"),i=p(i,"r"),l=p(l,"p"),c=p(c,"dkLen"),0===r||r&r-1)throw new Error("N must be power of 2");if(r>s/128/i)throw new Error("N too large");if(i>s/128/l)throw new Error("r too large");if(!h(t))throw new Error("password must be an array or buffer");if(t=Array.prototype.slice.call(t),!h(n))throw new Error("salt must be an array or buffer");n=Array.prototype.slice.call(n);let g=o(t,n,128*l*i);const m=new Uint32Array(32*l*i);for(let e=0;e<m.length;e++){const t=4*e;m[e]=(255&g[t+3])<<24|(255&g[t+2])<<16|(255&g[t+1])<<8|255&g[t+0]}const b=new Uint32Array(64*i),y=new Uint32Array(32*i*r),w=32*i,k=new Uint32Array(16),_=new Uint32Array(16),v=l*r*2;let C,S,T=0,E=null,A=!1,M=0,P=0;const x=f?parseInt(1e3/i):4294967295,R=void 0!==e?e:setTimeout,N=function(){if(A)return f(new Error("cancelled"),T/v);let e;switch(M){case 0:S=32*P*i,u(m,S,b,0,w),M=1,C=0;case 1:e=r-C,e>x&&(e=x);for(let t=0;t<e;t++)u(b,0,y,(C+t)*w,w),a(b,w,i,k,_);if(C+=e,T+=e,f){const e=parseInt(1e3*T/v);if(e!==E){if(A=f(null,T/v),A)break;E=e}}if(C<r)break;C=0,M=2;case 2:e=r-C,e>x&&(e=x);for(let t=0;t<e;t++){const e=b[16*(2*i-1)]&r-1;d(y,e*w,b,w),a(b,w,i,k,_)}if(C+=e,T+=e,f){const e=parseInt(1e3*T/v);if(e!==E){if(A=f(null,T/v),A)break;E=e}}if(C<r)break;if(u(b,0,m,S,w),P++,P<l){M=0;break}g=[];for(let e=0;e<m.length;e++)g.push(255&m[e]),g.push(m[e]>>8&255),g.push(m[e]>>16&255),g.push(m[e]>>24&255);const n=o(t,g,c);return f&&f(null,1,n),n}f&&R(N)};if(!f)for(;;){const e=N();if(e!=undefined)return e}N()}const g={scrypt:function(e,t,n,r,s,i,o){return new Promise((function(a,l){let c=0;o&&o(0),f(e,t,n,r,s,i,(function(e,t,n){if(e)l(e);else if(n)o&&1!==c&&o(1),a(new Uint8Array(n));else if(o&&t!==c)return c=t,o(t)}))}))},syncScrypt:function(e,t,n,r,s,i){return new Uint8Array(f(e,t,n,r,s,i))}};void 0!==n?t.exports=g:"function"==typeof define&&define.amd?define(g):r&&(r.scrypt&&(r._scrypt=r.scrypt),r.scrypt=g)}(this)}).call(this)}).call(this,e("timers").setImmediate)}}},{package:"ethereumjs-util>ethereum-cryptography>scrypt-js",file:"node_modules/scrypt-js/scrypt.js"}],[40,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,r){t.origin=e.origin,r()}}}}},{package:"$root$",file:"app/scripts/lib/createOriginMiddleware.js"}],[4017,{events:2956,"fast-fifo":2986,"queue-tick":3699},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{EventEmitter:r}=e("events"),s=new Error("Stream was destroyed"),i=new Error("Premature close"),o=e("queue-tick"),a=e("fast-fifo"),l=134217727,c=1^l,d=2^l,u=64,h=128,p=256,f=1024,g=2048,m=4096,b=8192,y=16384,w=32768,k=16^l,_=768^l,v=134184959,C=32^l,S=2<<17,T=4<<17,E=8<<17,A=16<<17,M=32<<17,P=64<<17,x=128<<17,R=256<<17,N=512<<17,I=100532223,O=133693439,j=117440511,L=131088,D=134086639,U=4210688,F=14,q=15,B=4210702,K=16809984,$=16809999,H=1179648,W=1179663,G=Symbol.asyncIterator||Symbol("asyncIterator");class z{constructor(e,{highWaterMark:t=16384,map:n=null,mapWritable:r,byteLength:s,byteLengthWritable:i}={}){this.stream=e,this.queue=new a,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=i||s||fe,this.map=r||n,this.afterWrite=ee.bind(this),this.afterUpdateNextTick=re.bind(this)}get ended(){return!!(this.stream._duplexState&M)}push(e){return null!==this.map&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),this.buffered<this.highWaterMark?(this.stream._duplexState|=E,!0):(this.stream._duplexState|=3145728,!1)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=133169151),e}end(e){"function"==typeof e?this.stream.once("finish",e):e!==undefined&&null!==e&&this.push(e),this.stream._duplexState=(this.stream._duplexState|N)&O}autoBatch(e,t){const n=[],r=this.stream;for(n.push(e);(r._duplexState&W)===H;)n.push(r._writableState.shift());if(r._duplexState&q)return t(null);r._writev(n,t)}update(){const e=this.stream;e._duplexState|=S;do{for(;(e._duplexState&W)===E;){const t=this.shift();e._duplexState|=33685504,e._write(t,this.afterWrite)}655360&e._duplexState||this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=133955583}updateNonPrimary(){const e=this.stream;if((72482831&e._duplexState)===N)return e._duplexState=67108863&e._duplexState|131072,void e._final(X.bind(this));4!=(e._duplexState&F)?1==(e._duplexState&$)&&(e._duplexState=(e._duplexState|L)&c,e._open(se.bind(this))):e._duplexState&K||(e._duplexState|=L,e._destroy(Z.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&x)&&(this.stream._duplexState&=j,!0)}updateCallback(){(17563663&this.stream._duplexState)===T?this.update():this.updateNextTick()}updateNextTick(){this.stream._duplexState&x||(this.stream._duplexState|=x,this.stream._duplexState&S||o(this.afterUpdateNextTick))}}class V{constructor(e,{highWaterMark:t=16384,map:n=null,mapReadable:r,byteLength:s,byteLengthReadable:i}={}){this.stream=e,this.queue=new a,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.byteLength=i||s||fe,this.map=r||n,this.pipeTo=null,this.afterRead=te.bind(this),this.afterUpdateNextTick=ne.bind(this)}get ended(){return!!(this.stream._duplexState&y)}pipe(e,t){if(null!==this.pipeTo)throw new Error("Can only pipe to one destination");if("function"!=typeof t&&(t=null),this.stream._duplexState|=512,this.pipeTo=e,this.pipeline=new Q(this.stream,e,t),t&&this.stream.on("error",ge),pe(e))e._writableState.pipeline=this.pipeline,t&&e.on("error",ge),e.on("finish",this.pipeline.finished.bind(this.pipeline));else{const t=this.pipeline.done.bind(this.pipeline,e),n=this.pipeline.done.bind(this.pipeline,e,null);e.on("error",t),e.on("close",n),e.on("finish",this.pipeline.finished.bind(this.pipeline))}e.on("drain",J.bind(this)),this.stream.emit("piping",e),e.emit("pipe",this.stream)}push(e){const t=this.stream;return null===e?(this.highWaterMark=0,t._duplexState=134152127&t._duplexState|1024,!1):(null!==this.map&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),t._duplexState=134152191&t._duplexState|128,this.buffered<this.highWaterMark)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=134209407),e}unshift(e){const t=[null!==this.map?this.map(e):e];for(;this.buffered>0;)t.push(this.shift());for(let e=0;e<t.length-1;e++){const n=t[e];this.buffered+=this.byteLength(n),this.queue.push(n)}this.push(t[t.length-1])}read(){const e=this.stream;if((16527&e._duplexState)===h){const t=this.shift();return null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=_),e._duplexState&g&&e.emit("data",t),t}return null}drain(){const e=this.stream;for(;(16527&e._duplexState)===h&&768&e._duplexState;){const t=this.shift();null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=_),e._duplexState&g&&e.emit("data",t)}}update(){const e=this.stream;e._duplexState|=32;do{for(this.drain();this.buffered<this.highWaterMark&&!(82975&e._duplexState);)e._duplexState|=65552,e._read(this.afterRead),this.drain();4224==(12431&e._duplexState)&&(e._duplexState|=b,e.emit("readable")),80&e._duplexState||this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=C}updateNonPrimary(){const e=this.stream;(1167&e._duplexState)===f&&(e._duplexState=134216703&e._duplexState|16384,e.emit("end"),(e._duplexState&B)===U&&(e._duplexState|=4),null!==this.pipeTo&&this.pipeTo.end()),4!=(e._duplexState&F)?1==(e._duplexState&$)&&(e._duplexState=(e._duplexState|L)&c,e._open(se.bind(this))):e._duplexState&K||(e._duplexState|=L,e._destroy(Z.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&w)&&(this.stream._duplexState&=v,!0)}updateCallback(){(32879&this.stream._duplexState)===u?this.update():this.updateNextTick()}updateNextTick(){this.stream._duplexState&w||(this.stream._duplexState|=w,32&this.stream._duplexState||o(this.afterUpdateNextTick))}}class Y{constructor(e){this.data=null,this.afterTransform=ie.bind(e),this.afterFinal=null}}class Q{constructor(e,t,n){this.from=e,this.to=t,this.afterPipe=n,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(e,t){t&&(this.error=t),e!==this.to||(this.to=null,null===this.from)?e!==this.from||(this.from=null,null===this.to)?(null!==this.afterPipe&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null):e._duplexState&y||this.to.destroy(this.error||new Error("Readable stream closed before ending")):this.from._duplexState&y&&this.pipeToFinished||this.from.destroy(this.error||new Error("Writable stream closed prematurely"))}}function J(){this.stream._duplexState|=512,this.updateCallback()}function X(e){const t=this.stream;e&&t.destroy(e),t._duplexState&F||(t._duplexState|=M,t.emit("finish")),(t._duplexState&B)===U&&(t._duplexState|=4),t._duplexState&=I,t._duplexState&S?this.updateNextTick():this.update()}function Z(e){const t=this.stream;e||this.error===s||(e=this.error),e&&t.emit("error",e),t._duplexState|=8,t.emit("close");const n=t._readableState,r=t._writableState;if(null!==n&&null!==n.pipeline&&n.pipeline.done(t,e),null!==r){for(;null!==r.drains&&r.drains.length>0;)r.drains.shift().resolve(!1);null!==r.pipeline&&r.pipeline.done(t,e)}}function ee(e){const t=this.stream;e&&t.destroy(e),t._duplexState&=I,null!==this.drains&&function(e){for(let t=0;t<e.length;t++)0==--e[t].writes&&(e.shift().resolve(!0),t--)}(this.drains),(3276815&t._duplexState)===A&&(t._duplexState&=132120575,(t._duplexState&P)===P&&t.emit("drain")),this.updateCallback()}function te(e){e&&this.stream.destroy(e),this.stream._duplexState&=k,this.updateCallback()}function ne(){32&this.stream._duplexState||(this.stream._duplexState&=v,this.update())}function re(){this.stream._duplexState&S||(this.stream._duplexState&=j,this.update())}function se(e){const t=this.stream;e&&t.destroy(e),4&t._duplexState||(17423&t._duplexState||(t._duplexState|=u),71303183&t._duplexState||(t._duplexState|=T),t.emit("open")),t._duplexState&=D,null!==t._writableState&&t._writableState.updateCallback(),null!==t._readableState&&t._readableState.updateCallback()}function ie(e,t){t!==undefined&&null!==t&&this.push(t),this._writableState.afterWrite(e)}class oe extends r{constructor(e){super(),this._duplexState=0,this._readableState=null,this._writableState=null,e&&(e.open&&(this._open=e.open),e.destroy&&(this._destroy=e.destroy),e.predestroy&&(this._predestroy=e.predestroy),e.signal&&e.signal.addEventListener("abort",me.bind(this)))}_open(e){e(null)}_destroy(e){e(null)}_predestroy(){}get readable(){return null!==this._readableState||undefined}get writable(){return null!==this._writableState||undefined}get destroyed(){return!!(8&this._duplexState)}get destroying(){return!!(this._duplexState&F)}destroy(e){this._duplexState&F||(e||(e=s),this._duplexState=133693375&this._duplexState|4,null!==this._readableState&&(this._readableState.highWaterMark=0,this._readableState.error=e),null!==this._writableState&&(this._writableState.highWaterMark=0,this._writableState.error=e),this._duplexState|=2,this._predestroy(),this._duplexState&=d,null!==this._readableState&&this._readableState.updateNextTick(),null!==this._writableState&&this._writableState.updateNextTick())}on(e,t){return null!==this._readableState&&("data"===e&&(this._duplexState|=2304,this._readableState.updateNextTick()),"readable"===e&&(this._duplexState|=m,this._readableState.updateNextTick())),null!==this._writableState&&"drain"===e&&(this._duplexState|=P,this._writableState.updateNextTick()),super.on(e,t)}}class ae extends oe{constructor(e){super(e),this._duplexState|=4194305,this._readableState=new V(this,e),e&&(e.read&&(this._read=e.read),e.eagerOpen&&this._readableState.updateNextTick())}_read(e){e(null)}pipe(e,t){return this._readableState.updateNextTick(),this._readableState.pipe(e,t),e}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(e){return this._readableState.updateNextTick(),this._readableState.push(e)}unshift(e){return this._readableState.updateNextTick(),this._readableState.unshift(e)}resume(){return this._duplexState|=p,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=134217471,this}static _fromAsyncIterator(e,t){let n;const r=new ae({...t,read(t){e.next().then(s).then(t.bind(null,null)).catch(t)},predestroy(){n=e.return()},destroy(e){if(!n)return e(null);n.then(e.bind(null,null)).catch(e)}});return r;function s(e){e.done?r.push(null):r.push(e.value)}}static from(e,t){if(pe(n=e)&&n.readable)return e;var n;if(e[G])return this._fromAsyncIterator(e[G](),t);Array.isArray(e)||(e=e===undefined?[]:[e]);let r=0;return new ae({...t,read(t){this.push(r===e.length?null:e[r++]),t(null)}})}static isBackpressured(e){return!!(17422&e._duplexState)||e._readableState.buffered>=e._readableState.highWaterMark}static isPaused(e){return!(e._duplexState&p)}[G](){const e=this;let t=null,n=null,r=null;return this.on("error",(e=>{t=e})),this.on("readable",(function(){null!==n&&i(e.read())})),this.on("close",(function(){null!==n&&i(null)})),{[G](){return this},next:()=>new Promise((function(t,s){n=t,r=s;const o=e.read();null!==o?i(o):8&e._duplexState&&i(null)})),return:()=>o(null),throw:e=>o(e)};function i(i){null!==r&&(t?r(t):null!==i||e._duplexState&y?n({value:i,done:null===i}):r(s),r=n=null)}function o(t){return e.destroy(t),new Promise(((n,r)=>{if(8&e._duplexState)return n({value:undefined,done:!0});e.once("close",(function(){t?r(t):n({value:undefined,done:!0})}))}))}}}class le extends ae{constructor(e){super(e),this._duplexState=1,this._writableState=new z(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}}class ce extends le{constructor(e){super(e),this._transformState=new Y(this),e&&(e.transform&&(this._transform=e.transform),e.flush&&(this._flush=e.flush))}_write(e,t){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=e:this._transform(e,this._transformState.afterTransform)}_read(e){if(null!==this._transformState.data){const t=this._transformState.data;this._transformState.data=null,e(null),this._transform(t,this._transformState.afterTransform)}else e(null)}_transform(e,t){t(null,e)}_flush(e){e(null)}_final(e){this._transformState.afterFinal=e,this._flush(de.bind(this))}}function de(e,t){const n=this._transformState.afterFinal;if(e)return n(e);null!==t&&t!==undefined&&this.push(t),this.push(null),n(null)}function ue(e,...t){const n=Array.isArray(e)?[...e,...t]:[e,...t],r=n.length&&"function"==typeof n[n.length-1]?n.pop():null;if(n.length<2)throw new Error("Pipeline requires at least 2 streams");let s=n[0],o=null,a=null;for(let e=1;e<n.length;e++)o=n[e],pe(s)?s.pipe(o,c):(l(s,!0,e>1,c),s.pipe(o)),s=o;if(r){let e=!1;const t=pe(o)||!(!o._writableState||!o._writableState.autoDestroy);o.on("error",(e=>{null===a&&(a=e)})),o.on("finish",(()=>{e=!0,t||r(a)})),t&&o.on("close",(()=>r(a||(e?null:i))))}return o;function l(e,t,n,r){e.on("error",r),e.on("close",(function(){if(t&&e._readableState&&!e._readableState.ended)return r(i);if(n&&e._writableState&&!e._writableState.ended)return r(i)}))}function c(e){if(e&&!a){a=e;for(const t of n)t.destroy(e)}}}function he(e){return!!e._readableState||!!e._writableState}function pe(e){return"number"==typeof e._duplexState&&he(e)}function fe(e){return function(e){return"object"==typeof e&&null!==e&&"number"==typeof e.byteLength}(e)?e.byteLength:1024}function ge(){}function me(){this.destroy(new Error("Stream aborted."))}t.exports={pipeline:ue,pipelinePromise:function(...e){return new Promise(((t,n)=>ue(...e,(e=>{if(e)return n(e);t()}))))},isStream:he,isStreamx:pe,getStreamError:function(e){const t=e._readableState&&e._readableState.error||e._writableState&&e._writableState.error;return t===s?null:t},Stream:oe,Writable:class extends oe{constructor(e){super(e),this._duplexState|=16385,this._writableState=new z(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final),e.eagerOpen&&this._writableState.updateNextTick())}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}static isBackpressured(e){return!!(73400334&e._duplexState)}static drained(e){if(e.destroyed)return Promise.resolve(!1);const t=e._writableState,n=t.queue.length+(e._duplexState&R?1:0);return 0===n?Promise.resolve(!0):(null===t.drains&&(t.drains=[]),new Promise((e=>{t.drains.push({writes:n,resolve:e})})))}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},Readable:ae,Duplex:le,Transform:ce,PassThrough:class extends ce{}}}}},{package:"@metamask/snaps-controllers>tar-stream>streamx",file:"node_modules/streamx/index.js"}],[4023,{fs:2619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r={S_IFMT:61440,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960};try{t.exports=e("fs").constants||r}catch{t.exports=r}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/tar-stream/constants.js"}],[4024,{"./headers":4025,b4a:2549,"fast-fifo":2986,streamx:4017},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{Writable:r,Readable:s,getStreamError:i}=e("streamx"),o=e("fast-fifo"),a=e("b4a"),l=e("./headers"),c=a.alloc(0);class d{constructor(){this.buffered=0,this.shifted=0,this.queue=new o,this._offset=0}push(e){this.buffered+=e.byteLength,this.queue.push(e)}shiftFirst(e){return 0===this._buffered?null:this._next(e)}shift(e){if(e>this.buffered)return null;if(0===e)return c;let t=this._next(e);if(e===t.byteLength)return t;const n=[t];for(;(e-=t.byteLength)>0;)t=this._next(e),n.push(t);return a.concat(n)}_next(e){const t=this.queue.peek(),n=t.byteLength-this._offset;if(e>=n){const e=this._offset?t.subarray(this._offset,t.byteLength):t;return this.queue.shift(),this._offset=0,this.buffered-=n,this.shifted+=n,e}return this.buffered-=e,this.shifted+=e,t.subarray(this._offset,this._offset+=e)}}class u extends s{constructor(e,t,n){super(),this.header=t,this.offset=n,this._parent=e}_read(e){0===this.header.size&&this.push(null),this._parent._stream===this&&this._parent._update(),e(null)}_predestroy(){this._parent.destroy(i(this))}_detach(){this._parent._stream===this&&(this._parent._stream=null,this._parent._missing=f(this.header.size),this._parent._update())}_destroy(e){this._detach(),e(null)}}class h extends r{constructor(e){super(e),e||(e={}),this._buffer=new d,this._offset=0,this._header=null,this._stream=null,this._missing=0,this._longHeader=!1,this._callback=p,this._locked=!1,this._finished=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null,this._filenameEncoding=e.filenameEncoding||"utf-8",this._allowUnknownFormat=!!e.allowUnknownFormat,this._unlockBound=this._unlock.bind(this)}_unlock(e){if(this._locked=!1,e)return this.destroy(e),void this._continueWrite(e);this._update()}_consumeHeader(){if(this._locked)return!1;this._offset=this._buffer.shifted;try{this._header=l.decode(this._buffer.shift(512),this._filenameEncoding,this._allowUnknownFormat)}catch(e){return this._continueWrite(e),!1}if(!this._header)return!0;switch(this._header.type){case"gnu-long-path":case"gnu-long-link-path":case"pax-global-header":case"pax-header":return this._longHeader=!0,this._missing=this._header.size,!0}return this._locked=!0,this._applyLongHeaders(),0===this._header.size||"directory"===this._header.type?(this.emit("entry",this._header,this._createStream(),this._unlockBound),!0):(this._stream=this._createStream(),this._missing=this._header.size,this.emit("entry",this._header,this._stream,this._unlockBound),!0)}_applyLongHeaders(){this._gnuLongPath&&(this._header.name=this._gnuLongPath,this._gnuLongPath=null),this._gnuLongLinkPath&&(this._header.linkname=this._gnuLongLinkPath,this._gnuLongLinkPath=null),this._pax&&(this._pax.path&&(this._header.name=this._pax.path),this._pax.linkpath&&(this._header.linkname=this._pax.linkpath),this._pax.size&&(this._header.size=parseInt(this._pax.size,10)),this._header.pax=this._pax,this._pax=null)}_decodeLongHeader(e){switch(this._header.type){case"gnu-long-path":this._gnuLongPath=l.decodeLongPath(e,this._filenameEncoding);break;case"gnu-long-link-path":this._gnuLongLinkPath=l.decodeLongPath(e,this._filenameEncoding);break;case"pax-global-header":this._paxGlobal=l.decodePax(e);break;case"pax-header":this._pax=null===this._paxGlobal?l.decodePax(e):Object.assign({},this._paxGlobal,l.decodePax(e))}}_consumeLongHeader(){this._longHeader=!1,this._missing=f(this._header.size);const e=this._buffer.shift(this._header.size);try{this._decodeLongHeader(e)}catch(e){return this._continueWrite(e),!1}return!0}_consumeStream(){const e=this._buffer.shiftFirst(this._missing);if(null===e)return!1;this._missing-=e.byteLength;const t=this._stream.push(e);return 0===this._missing?(this._stream.push(null),t&&this._stream._detach(),t&&!1===this._locked):t}_createStream(){return new u(this,this._header,this._offset)}_update(){for(;this._buffer.buffered>0&&!this.destroying;)if(this._missing>0){if(null!==this._stream){if(!1===this._consumeStream())return;continue}if(!0===this._longHeader){if(this._missing>this._buffer.buffered)break;if(!1===this._consumeLongHeader())return!1;continue}const e=this._buffer.shiftFirst(this._missing);null!==e&&(this._missing-=e.byteLength)}else{if(this._buffer.buffered<512)break;if(null!==this._stream||!1===this._consumeHeader())return}this._continueWrite(null)}_continueWrite(e){const t=this._callback;this._callback=p,t(e)}_write(e,t){this._callback=t,this._buffer.push(e),this._update()}_final(e){this._finished=0===this._missing&&0===this._buffer.buffered,e(this._finished?null:new Error("Unexpected end of data"))}_predestroy(){this._continueWrite(null)}_destroy(e){this._stream&&this._stream.destroy(i(this)),e(null)}[Symbol.asyncIterator](){let e=null,t=null,n=null,r=null,s=null;const i=this;return this.on("entry",(function(e,i,o){s=o,i.on("error",p),t?(t({value:i,done:!1}),t=n=null):r=i})),this.on("error",(t=>{e=t})),this.on("close",(function(){if(o(e),!t)return;e?n(e):t({value:undefined,done:!0});t=n=null})),{[Symbol.asyncIterator](){return this},next:()=>new Promise(a),return:()=>l(null),throw:e=>l(e)};function o(e){if(!s)return;const t=s;s=null,t(e)}function a(s,a){return e?a(e):r?(s({value:r,done:!1}),void(r=null)):(t=s,n=a,o(null),void(i._finished&&t&&(t({value:undefined,done:!0}),t=n=null)))}function l(e){return i.destroy(e),o(e),new Promise(((t,n)=>{if(i.destroyed)return t({value:undefined,done:!0});i.once("close",(function(){e?n(e):t({value:undefined,done:!0})}))}))}}}function p(){}function f(e){return(e&=511)&&512-e}t.exports=function(e){return new h(e)}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/tar-stream/extract.js"}],[4025,{b4a:2549},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("b4a"),s="0000000000000000000",i="7777777777777777777",o="0".charCodeAt(0),a=r.from([117,115,116,97,114,0]),l=r.from([o,o]),c=r.from([117,115,116,97,114,32]),d=r.from([32,0]),u=257,h=263;function p(e,t,n,r){for(;n<r;n++)if(e[n]===t)return n;return r}function f(e){let t=256;for(let n=0;n<148;n++)t+=e[n];for(let n=156;n<512;n++)t+=e[n];return t}function g(e,t){return(e=e.toString(8)).length>t?i.slice(0,t)+" ":s.slice(0,t-e.length)+e+" "}function m(e,t,n){if(128&(e=e.subarray(t,t+n))[t=0])return function(e){let t;if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}const n=[];let r;for(r=e.length-1;r>0;r--){const s=e[r];t?n.push(s):n.push(255-s)}let s=0;const i=n.length;for(r=0;r<i;r++)s+=n[r]*Math.pow(256,r);return t?s:-1*s}(e);{for(;t<e.length&&32===e[t];)t++;const n=(s=p(e,32,t,e.length),i=e.length,o=e.length,"number"!=typeof s?o:(s=~~s)>=i?i:s>=0||(s+=i)>=0?s:0);for(;t<n&&0===e[t];)t++;return n===t?0:parseInt(r.toString(e.subarray(t,n)),8)}var s,i,o}function b(e,t,n,s){return r.toString(e.subarray(t,p(e,0,t,t+n)),s)}function y(e){const t=r.byteLength(e);let n=Math.floor(Math.log(t)/Math.log(10))+1;return t+n>=Math.pow(10,n)&&n++,t+n+e}n.decodeLongPath=function(e,t){return b(e,0,e.length,t)},n.encodePax=function(e){let t="";e.name&&(t+=y(" path="+e.name+"\n")),e.linkname&&(t+=y(" linkpath="+e.linkname+"\n"));const n=e.pax;if(n)for(const e in n)t+=y(" "+e+"="+n[e]+"\n");return r.from(t)},n.decodePax=function(e){const t={};for(;e.length;){let n=0;for(;n<e.length&&32!==e[n];)n++;const s=parseInt(r.toString(e.subarray(0,n)),10);if(!s)return t;const i=r.toString(e.subarray(n+1,s-1)),o=i.indexOf("=");if(-1===o)return t;t[i.slice(0,o)]=i.slice(o+1),e=e.subarray(s)}return t},n.encode=function(e){const t=r.alloc(512);let n=e.name,s="";if(5===e.typeflag&&"/"!==n[n.length-1]&&(n+="/"),r.byteLength(n)!==n.length)return null;for(;r.byteLength(n)>100;){const e=n.indexOf("/");if(-1===e)return null;s+=s?"/"+n.slice(0,e):n.slice(0,e),n=n.slice(e+1)}return r.byteLength(n)>100||r.byteLength(s)>155||e.linkname&&r.byteLength(e.linkname)>100?null:(r.write(t,n),r.write(t,g(4095&e.mode,6),100),r.write(t,g(e.uid,6),108),r.write(t,g(e.gid,6),116),function(e,t,n){e.toString(8).length>11?function(e,t,n){t[n]=128;for(let r=11;r>0;r--)t[n+r]=255&e,e=Math.floor(e/256)}(e,t,n):r.write(t,g(e,11),n)}(e.size,t,124),r.write(t,g(e.mtime.getTime()/1e3|0,11),136),t[156]=o+function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}(e.type),e.linkname&&r.write(t,e.linkname,157),r.copy(a,t,u),r.copy(l,t,263),e.uname&&r.write(t,e.uname,265),e.gname&&r.write(t,e.gname,297),r.write(t,g(e.devmajor||0,6),329),r.write(t,g(e.devminor||0,6),337),s&&r.write(t,s,345),r.write(t,g(f(t),6),148),t)},n.decode=function(e,t,n){let s=0===e[156]?0:e[156]-o,i=b(e,0,100,t);const l=m(e,100,8),p=m(e,108,8),g=m(e,116,8),y=m(e,124,12),w=m(e,136,12),k=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}(s),_=0===e[157]?null:b(e,157,100,t),v=b(e,265,32),C=b(e,297,32),S=m(e,329,8),T=m(e,337,8),E=f(e);if(256===E)return null;if(E!==m(e,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(function(e){return r.equals(a,e.subarray(u,263))}(e))e[345]&&(i=b(e,345,155,t)+"/"+i);else if(function(e){return r.equals(c,e.subarray(u,263))&&r.equals(d,e.subarray(h,265))}(e));else if(!n)throw new Error("Invalid tar header: unknown format.");return 0===s&&i&&"/"===i[i.length-1]&&(s=5),{name:i,mode:l,uid:p,gid:g,size:y,mtime:new Date(1e3*w),type:k,linkname:_,uname:v,gname:C,devmajor:S,devminor:T,pax:null}}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/tar-stream/headers.js"}],[4026,{"./extract":4024,"./pack":4027},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){n.extract=e("./extract"),n.pack=e("./pack")}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/tar-stream/index.js"}],[4027,{"./constants":4023,"./headers":4025,b4a:2549,streamx:4017},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{Readable:r,Writable:s,getStreamError:i}=e("streamx"),o=e("b4a"),a=e("./constants"),l=e("./headers"),c=o.alloc(1024);class d extends s{constructor(e,t,n){super({mapWritable:f,eagerOpen:!0}),this.written=0,this.header=t,this._callback=n,this._linkname=null,this._isLinkname="symlink"===t.type&&!t.linkname,this._isVoid="file"!==t.type&&"contiguous-file"!==t.type,this._finished=!1,this._pack=e,this._openCallback=null,null===this._pack._stream?this._pack._stream=this:this._pack._pending.push(this)}_open(e){this._openCallback=e,this._pack._stream===this&&this._continueOpen()}_continuePack(e){if(null===this._callback)return;const t=this._callback;this._callback=null,t(e)}_continueOpen(){null===this._pack._stream&&(this._pack._stream=this);const e=this._openCallback;if(this._openCallback=null,null!==e){if(this._pack.destroying)return e(new Error("pack stream destroyed"));if(this._pack._finalized)return e(new Error("pack stream is already finalized"));this._pack._stream=this,this._isLinkname||this._pack._encode(this.header),this._isVoid&&(this._finish(),this._continuePack(null)),e(null)}}_write(e,t){return this._isLinkname?(this._linkname=this._linkname?o.concat([this._linkname,e]):e,t(null)):this._isVoid?e.byteLength>0?t(new Error("No body allowed for this entry")):t():(this.written+=e.byteLength,this._pack.push(e)?t():void(this._pack._drain=t))}_finish(){this._finished||(this._finished=!0,this._isLinkname&&(this.header.linkname=this._linkname?o.toString(this._linkname,"utf-8"):"",this._pack._encode(this.header)),p(this._pack,this.header.size),this._pack._done(this))}_final(e){if(this.written!==this.header.size)return e(new Error("Size mismatch"));this._finish(),e(null)}_getError(){return i(this)||new Error("tar entry destroyed")}_predestroy(){this._pack.destroy(this._getError())}_destroy(e){this._pack._done(this),this._continuePack(this._finished?null:this._getError()),e()}}class u extends r{constructor(e){super(e),this._drain=h,this._finalized=!1,this._finalizing=!1,this._pending=[],this._stream=null}entry(e,t,n){if(this._finalized||this.destroying)throw new Error("already finalized or destroyed");"function"==typeof t&&(n=t,t=null),n||(n=h),e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=function(e){switch(e&a.S_IFMT){case a.S_IFBLK:return"block-device";case a.S_IFCHR:return"character-device";case a.S_IFDIR:return"directory";case a.S_IFIFO:return"fifo";case a.S_IFLNK:return"symlink"}return"file"}(e.mode)),e.mode||(e.mode="directory"===e.type?493:420),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"==typeof t&&(t=o.from(t));const r=new d(this,e,n);return o.isBuffer(t)?(e.size=t.byteLength,r.write(t),r.end(),r):(r._isVoid,r)}finalize(){this._stream||this._pending.length>0?this._finalizing=!0:this._finalized||(this._finalized=!0,this.push(c),this.push(null))}_done(e){e===this._stream&&(this._stream=null,this._finalizing&&this.finalize(),this._pending.length&&this._pending.shift()._continueOpen())}_encode(e){if(!e.pax){const t=l.encode(e);if(t)return void this.push(t)}this._encodePax(e)}_encodePax(e){const t=l.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),n={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.byteLength,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(l.encode(n)),this.push(t),p(this,t.byteLength),n.size=e.size,n.type=e.type,this.push(l.encode(n))}_doDrain(){const e=this._drain;this._drain=h,e()}_predestroy(){const e=i(this);for(this._stream&&this._stream.destroy(e);this._pending.length;){const t=this._pending.shift();t.destroy(e),t._continueOpen()}this._doDrain()}_read(e){this._doDrain(),e()}}function h(){}function p(e,t){(t&=511)&&e.push(c.subarray(0,512-t))}function f(e){return o.isBuffer(e)?e:o.from(e)}t.exports=function(e){return new u(e)}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/tar-stream/pack.js"}],[4028,{_process:3648,stream:3983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("stream");function s(e,t,s){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var i=!1,o=!1,a=[],l=!1,c=new r;function d(){for(;a.length&&!c.paused;){var e=a.shift();if(null===e)return c.emit("end");c.emit("data",e)}}return c.readable=c.writable=!0,c.paused=!1,c.autoDestroy=!(s&&!1===s.autoDestroy),c.write=function(t){return e.call(this,t),!c.paused},c.queue=c.push=function(e){return l||(null===e&&(l=!0),a.push(e),d()),c},c.on("end",(function(){c.readable=!1,!c.writable&&c.autoDestroy&&n.nextTick((function(){c.destroy()}))})),c.end=function(e){if(!i)return i=!0,arguments.length&&c.write(e),c.writable=!1,t.call(c),!c.readable&&c.autoDestroy&&c.destroy(),c},c.destroy=function(){if(!o)return o=!0,i=!0,a.length=0,c.writable=c.readable=!1,c.emit("close"),c},c.pause=function(){if(!c.paused)return c.paused=!0,c},c.resume=function(){return c.paused&&(c.paused=!1,c.emit("resume")),d(),c.paused||c.emit("drain"),c},c}t.exports=s,s.through=s}).call(this)}).call(this,e("_process"))}}},{package:"debounce-stream>through",file:"node_modules/through/index.js"}],[4032,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"base32-encode>to-data-view",file:"node_modules/to-data-view/index.js"}],[4035,{"./mixin-tracking":4037,"./util":4041},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decorate=n.getDecoratorsForClass=n.directDecoratorSearch=n.deepDecoratorSearch=void 0;const r=e("./util"),s=e("./mixin-tracking"),i=(e,t)=>{var n,s;const i=(0,r.unique)([...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(t)]),o={};for(let a of i)o[a]=(0,r.unique)([...null!==(n=null==e?void 0:e[a])&&void 0!==n?n:[],...null!==(s=null==t?void 0:t[a])&&void 0!==s?s:[]]);return o},o=(e,t)=>{var n,r,s,o;return{property:i(null!==(n=null==e?void 0:e.property)&&void 0!==n?n:{},null!==(r=null==t?void 0:t.property)&&void 0!==r?r:{}),method:i(null!==(s=null==e?void 0:e.method)&&void 0!==s?s:{},null!==(o=null==t?void 0:t.method)&&void 0!==o?o:{})}},a=(e,t)=>{var n,s,i,a,l,c;return{class:(0,r.unique)([...null!==(n=null==e?void 0:e.class)&&void 0!==n?n:[],...null!==(s=null==t?void 0:t.class)&&void 0!==s?s:[]]),static:o(null!==(i=null==e?void 0:e.static)&&void 0!==i?i:{},null!==(a=null==t?void 0:t.static)&&void 0!==a?a:{}),instance:o(null!==(l=null==e?void 0:e.instance)&&void 0!==l?l:{},null!==(c=null==t?void 0:t.instance)&&void 0!==c?c:{})}},l=new Map;n.deepDecoratorSearch=(...e)=>{const t=((...e)=>{var t;const n=new Set,i=new Set([...e]);for(;i.size>0;)for(let e of i){const o=[...(0,r.protoChain)(e.prototype).map((e=>e.constructor)),...null!==(t=(0,s.getMixinsForClass)(e))&&void 0!==t?t:[]].filter((e=>!n.has(e)));for(let e of o)i.add(e);n.add(e),i.delete(e)}return[...n]})(...e).map((e=>l.get(e))).filter((e=>!!e));return 0==t.length?{}:1==t.length?t[0]:t.reduce(((e,t)=>a(e,t)))};n.directDecoratorSearch=(...e)=>{const t=e.map((e=>(0,n.getDecoratorsForClass)(e)));return 0===t.length?{}:1===t.length?t[0]:t.reduce(((e,t)=>a(e,t)))};n.getDecoratorsForClass=e=>{let t=l.get(e);return t||(t={},l.set(e,t)),t};n.decorate=e=>(...t)=>1===t.length?(e=>t=>{const r=(0,n.getDecoratorsForClass)(t);let s=r.class;return s||(s=[],r.class=s),s.push(e),e(t)})(e)(t[0]):(e=>(t,r,...s)=>{var i,o,a;const l="function"==typeof t?"static":"instance",c="function"==typeof t[r]?"method":"property",d="static"===l?t:t.constructor,u=(0,n.getDecoratorsForClass)(d),h=null!==(i=null==u?void 0:u[l])&&void 0!==i?i:{};u[l]=h;let p=null!==(o=null==h?void 0:h[c])&&void 0!==o?o:{};h[c]=p;let f=null!==(a=null==p?void 0:p[r])&&void 0!==a?a:[];return p[r]=f,f.push(e),e(t,r,...s)})(e)(...t)}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/decorator.js"}],[4036,{"./decorator":4035,"./mixin-tracking":4037,"./mixins":4038,"./settings":4040},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hasMixin=n.decorate=n.settings=n.mix=n.Mixin=void 0;var r=e("./mixins");Object.defineProperty(n,"Mixin",{enumerable:!0,get:function(){return r.Mixin}}),Object.defineProperty(n,"mix",{enumerable:!0,get:function(){return r.mix}});var s=e("./settings");Object.defineProperty(n,"settings",{enumerable:!0,get:function(){return s.settings}});var i=e("./decorator");Object.defineProperty(n,"decorate",{enumerable:!0,get:function(){return i.decorate}});var o=e("./mixin-tracking");Object.defineProperty(n,"hasMixin",{enumerable:!0,get:function(){return o.hasMixin}})}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/index.js"}],[4037,{"./util":4041},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hasMixin=n.registerMixins=n.getMixinsForClass=void 0;const r=e("./util"),s=new WeakMap;n.getMixinsForClass=e=>s.get(e);n.registerMixins=(e,t)=>s.set(e,t);n.hasMixin=(e,t)=>{if(e instanceof t)return!0;const n=e.constructor,i=new Set;let o=new Set;for(o.add(n);o.size>0;){if(o.has(t))return!0;o.forEach((e=>i.add(e)));const e=new Set;o.forEach((t=>{var n;const a=null!==(n=s.get(t))&&void 0!==n?n:(0,r.protoChain)(t.prototype).map((e=>e.constructor)).filter((e=>null!==e));a&&a.forEach((t=>{i.has(t)||o.has(t)||e.add(t)}))})),o=e}return!1}}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/mixin-tracking.js"}],[4038,{"./decorator":4035,"./mixin-tracking":4037,"./proxy":4039,"./settings":4040,"./util":4041},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mix=n.Mixin=void 0;const r=e("./proxy"),s=e("./settings"),i=e("./util"),o=e("./decorator"),a=e("./mixin-tracking");function l(...e){var t,n,l;const d=e.map((e=>e.prototype)),u=s.settings.initFunction;if(null!==u){const e=d.map((e=>e[u])).filter((e=>"function"==typeof e)),t=function(...t){for(let n of e)n.apply(this,t)},n={[u]:t};d.push(n)}function h(...t){for(const n of e)(0,i.copyProps)(this,new n(...t));null!==u&&"function"==typeof this[u]&&this[u].apply(this,t)}h.prototype="copy"===s.settings.prototypeStrategy?(0,i.hardMixProtos)(d,h):(0,r.softMixProtos)(d,h),Object.setPrototypeOf(h,"copy"===s.settings.staticsStrategy?(0,i.hardMixProtos)(e,null,["prototype"]):(0,r.proxyMix)(e,Function.prototype));let p=h;if("none"!==s.settings.decoratorInheritance){const r="deep"===s.settings.decoratorInheritance?(0,o.deepDecoratorSearch)(...e):(0,o.directDecoratorSearch)(...e);for(let e of null!==(t=null==r?void 0:r.class)&&void 0!==t?t:[]){const t=e(p);t&&(p=t)}c(null!==(n=null==r?void 0:r.static)&&void 0!==n?n:{},p),c(null!==(l=null==r?void 0:r.instance)&&void 0!==l?l:{},p.prototype)}return(0,a.registerMixins)(p,e),p}n.Mixin=l;const c=(e,t)=>{const n=e.property,r=e.method;if(n)for(let e in n)for(let r of n[e])r(t,e);if(r)for(let e in r)for(let n of r[e])n(t,e,Object.getOwnPropertyDescriptor(t,e))};n.mix=(...e)=>t=>{const n=l(...e.concat([t]));return Object.defineProperty(n,"name",{value:t.name,writable:!1}),n}}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/mixins.js"}],[4039,{"./util":4041},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.softMixProtos=n.proxyMix=n.getIngredientWithProp=void 0;const r=e("./util");n.getIngredientWithProp=(e,t)=>{const n=t.map((e=>(0,r.protoChain)(e)));let s=0,i=!0;for(;i;){i=!1;for(let r=t.length-1;r>=0;r--){const t=n[r][s];if(t!==undefined&&null!==t&&(i=!0,Object.getOwnPropertyDescriptor(t,e)!=undefined))return n[r][0]}s++}return undefined};n.proxyMix=(e,t=Object.prototype)=>new Proxy({},{getPrototypeOf:()=>t,setPrototypeOf(){throw Error("Cannot set prototype of Proxies created by ts-mixer")},getOwnPropertyDescriptor:(t,r)=>Object.getOwnPropertyDescriptor((0,n.getIngredientWithProp)(r,e)||{},r),defineProperty(){throw new Error("Cannot define new properties on Proxies created by ts-mixer")},has:(r,s)=>(0,n.getIngredientWithProp)(s,e)!==undefined||t[s]!==undefined,get:(r,s)=>((0,n.getIngredientWithProp)(s,e)||t)[s],set(t,r,s){const i=(0,n.getIngredientWithProp)(r,e);if(i===undefined)throw new Error("Cannot set new properties on Proxies created by ts-mixer");return i[r]=s,!0},deleteProperty(){throw new Error("Cannot delete properties on Proxies created by ts-mixer")},ownKeys:()=>e.map(Object.getOwnPropertyNames).reduce(((e,t)=>t.concat(e.filter((e=>t.indexOf(e)<0)))))});n.softMixProtos=(e,t)=>(0,n.proxyMix)([...e,{constructor:t}])}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/proxy.js"}],[4040,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.settings=void 0,n.settings={initFunction:null,staticsStrategy:"copy",prototypeStrategy:"copy",decoratorInheritance:"deep"}}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/settings.js"}],[4041,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.flatten=n.unique=n.hardMixProtos=n.nearestCommonProto=n.protoChain=n.copyProps=void 0;n.copyProps=(e,t,n=[])=>{const r=Object.getOwnPropertyDescriptors(t);for(let e of n)delete r[e];Object.defineProperties(e,r)};n.protoChain=(e,t=[e])=>{const r=Object.getPrototypeOf(e);return null===r?t:(0,n.protoChain)(r,[...t,r])};n.nearestCommonProto=(...e)=>{if(0===e.length)return undefined;let t=undefined;const r=e.map((e=>(0,n.protoChain)(e)));for(;r.every((e=>e.length>0));){const e=r.map((e=>e.pop())),n=e[0];if(!e.every((e=>e===n)))break;t=n}return t};n.hardMixProtos=(e,t,r=[])=>{var s;const i=null!==(s=(0,n.nearestCommonProto)(...e))&&void 0!==s?s:Object.prototype,o=Object.create(i),a=(0,n.protoChain)(i);for(let t of e){let e=(0,n.protoChain)(t);for(let t=e.length-1;t>=0;t--){let s=e[t];-1===a.indexOf(s)&&((0,n.copyProps)(o,s,["constructor",...r]),a.push(s))}}return o.constructor=t,o};n.unique=e=>e.filter(((t,n)=>e.indexOf(t)==n));n.flatten=e=>0===e.length?[]:1===e.length?e[0]:e.reduce(((e,t)=>[...e,...t]))}}},{package:"@trezor/connect-web>@trezor/connect>@trezor/schema-utils>ts-mixer",file:"node_modules/ts-mixer/dist/cjs/util.js"}],[4045,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o=void 0,a=(r=Object.prototype.toString,s=Object.prototype.hasOwnProperty,{Class:function(e){return r.call(e).replace(/^\[object *|\]$/g,"")},HasProperty:function(e,t){return t in e},HasOwnProperty:function(e,t){return s.call(e,t)},IsCallable:function(e){return"function"==typeof e},ToInt32:function(e){return 0|e},ToUint32:function(e){return e>>>0}}),l=Math.LN2,c=Math.abs,d=Math.floor,u=Math.log,h=Math.min,p=Math.pow,f=Math.round;function g(e){if(m&&i){var t,n=m(e);for(t=0;t<n.length;t+=1)i(e,n[t],{value:e[n[t]],writable:!1,enumerable:!1,configurable:!1})}}i=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()?Object.defineProperty:function(e,t,n){if(!e===Object(e))throw new TypeError("Object.defineProperty called on non-object");return a.HasProperty(n,"get")&&Object.prototype.__defineGetter__&&Object.prototype.__defineGetter__.call(e,t,n.get),a.HasProperty(n,"set")&&Object.prototype.__defineSetter__&&Object.prototype.__defineSetter__.call(e,t,n.set),a.HasProperty(n,"value")&&(e[t]=n.value),e};var m=Object.getOwnPropertyNames||function(e){if(e!==Object(e))throw new TypeError("Object.getOwnPropertyNames called on non-object");var t,n=[];for(t in e)a.HasOwnProperty(e,t)&&n.push(t);return n};function b(e,t){var n=32-t;return e<<n>>n}function y(e,t){var n=32-t;return e<<n>>>n}function w(e){return[255&e]}function k(e){return b(e[0],8)}function _(e){return[255&e]}function v(e){return y(e[0],8)}function C(e){return[(e=f(Number(e)))<0?0:e>255?255:255&e]}function S(e){return[e>>8&255,255&e]}function T(e){return b(e[0]<<8|e[1],16)}function E(e){return[e>>8&255,255&e]}function A(e){return y(e[0]<<8|e[1],16)}function M(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}function P(e){return b(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function x(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}function R(e){return y(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function N(e,t,n){var r,s,i,o,a,f,g,m=(1<<t-1)-1;function b(e){var t=d(e),n=e-t;return n<.5?t:n>.5||t%2?t+1:t}for(e!=e?(s=(1<<t)-1,i=p(2,n-1),r=0):e===Infinity||e===-Infinity?(s=(1<<t)-1,i=0,r=e<0?1:0):0===e?(s=0,i=0,r=1/e==-Infinity?1:0):(r=e<0,(e=c(e))>=p(2,1-m)?(s=h(d(u(e)/l),1023),(i=b(e/p(2,s)*p(2,n)))/p(2,n)>=2&&(s+=1,i=1),s>m?(s=(1<<t)-1,i=0):(s+=m,i-=p(2,n))):(s=0,i=b(e/p(2,1-m-n)))),a=[],o=n;o;o-=1)a.push(i%2?1:0),i=d(i/2);for(o=t;o;o-=1)a.push(s%2?1:0),s=d(s/2);for(a.push(r?1:0),a.reverse(),f=a.join(""),g=[];f.length;)g.push(parseInt(f.substring(0,8),2)),f=f.substring(8);return g}function I(e,t,n){var r,s,i,o,a,l,c,d,u=[];for(r=e.length;r;r-=1)for(i=e[r-1],s=8;s;s-=1)u.push(i%2?1:0),i>>=1;return u.reverse(),o=u.join(""),a=(1<<t-1)-1,l=parseInt(o.substring(0,1),2)?-1:1,c=parseInt(o.substring(1,1+t),2),d=parseInt(o.substring(1+t),2),c===(1<<t)-1?0!==d?NaN:l*Infinity:c>0?l*p(2,c-a)*(1+d/p(2,n)):0!==d?l*p(2,-(a-1))*(d/p(2,n)):l<0?-0:0}function O(e){return I(e,11,52)}function j(e){return N(e,11,52)}function L(e){return I(e,8,23)}function D(e){return N(e,8,23)}!function(){var e=function(e){if((e=a.ToInt32(e))<0)throw new RangeError("ArrayBuffer size is not a small enough positive integer");var t;for(this.byteLength=e,this._bytes=[],this._bytes.length=e,t=0;t<this.byteLength;t+=1)this._bytes[t]=0;g(this)};n.ArrayBuffer=n.ArrayBuffer||e;var t=function(){};function r(n,r,s){var l;return l=function(t,n,r){var s,o,c,d;if(arguments.length&&"number"!=typeof arguments[0])if("object"==typeof arguments[0]&&arguments[0].constructor===l)for(s=arguments[0],this.length=s.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0,c=0;c<this.length;c+=1)this._setter(c,s._getter(c));else if("object"!=typeof arguments[0]||(arguments[0]instanceof e||"ArrayBuffer"===a.Class(arguments[0]))){if("object"!=typeof arguments[0]||!(arguments[0]instanceof e||"ArrayBuffer"===a.Class(arguments[0])))throw new TypeError("Unexpected argument type(s)");if(this.buffer=t,this.byteOffset=a.ToUint32(n),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");if(arguments.length<3){if(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT)throw new RangeError("length of buffer minus byteOffset not a multiple of the element size");this.length=this.byteLength/this.BYTES_PER_ELEMENT}else this.length=a.ToUint32(r),this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}else for(o=arguments[0],this.length=a.ToUint32(o.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0,c=0;c<this.length;c+=1)d=o[c],this._setter(c,Number(d));else{if(this.length=a.ToInt32(arguments[0]),r<0)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0}this.constructor=l,g(this),function(e){if(i){if(e.length>1e5)throw new RangeError("Array too large for polyfill");var t;for(t=0;t<e.length;t+=1)n(t)}function n(t){i(e,t,{get:function(){return e._getter(t)},set:function(n){e._setter(t,n)},enumerable:!0,configurable:!1})}}(this)},l.prototype=new t,l.prototype.BYTES_PER_ELEMENT=n,l.prototype._pack=r,l.prototype._unpack=s,l.BYTES_PER_ELEMENT=n,l.prototype._getter=function(e){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if((e=a.ToUint32(e))>=this.length)return o;var t,n,r=[];for(t=0,n=this.byteOffset+e*this.BYTES_PER_ELEMENT;t<this.BYTES_PER_ELEMENT;t+=1,n+=1)r.push(this.buffer._bytes[n]);return this._unpack(r)},l.prototype.get=l.prototype._getter,l.prototype._setter=function(e,t){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if((e=a.ToUint32(e))>=this.length)return o;var n,r,s=this._pack(t);for(n=0,r=this.byteOffset+e*this.BYTES_PER_ELEMENT;n<this.BYTES_PER_ELEMENT;n+=1,r+=1)this.buffer._bytes[r]=s[n]},l.prototype.set=function(e,t){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var n,r,s,i,o,l,c,d,u,h;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(n=arguments[0],(s=a.ToUint32(arguments[1]))+n.length>this.length)throw new RangeError("Offset plus length of array is out of range");if(d=this.byteOffset+s*this.BYTES_PER_ELEMENT,u=n.length*this.BYTES_PER_ELEMENT,n.buffer===this.buffer){for(h=[],o=0,l=n.byteOffset;o<u;o+=1,l+=1)h[o]=n.buffer._bytes[l];for(o=0,c=d;o<u;o+=1,c+=1)this.buffer._bytes[c]=h[o]}else for(o=0,l=n.byteOffset,c=d;o<u;o+=1,l+=1,c+=1)this.buffer._bytes[c]=n.buffer._bytes[l]}else{if("object"!=typeof arguments[0]||void 0===arguments[0].length)throw new TypeError("Unexpected argument type(s)");if(r=arguments[0],i=a.ToUint32(r.length),(s=a.ToUint32(arguments[1]))+i>this.length)throw new RangeError("Offset plus length of array is out of range");for(o=0;o<i;o+=1)l=r[o],this._setter(s+o,Number(l))}},l.prototype.subarray=function(e,t){function n(e,t,n){return e<t?t:e>n?n:e}e=a.ToInt32(e),t=a.ToInt32(t),arguments.length<1&&(e=0),arguments.length<2&&(t=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e=n(e,0,this.length);var r=(t=n(t,0,this.length))-e;return r<0&&(r=0),new this.constructor(this.buffer,this.byteOffset+e*this.BYTES_PER_ELEMENT,r)},l}var s=r(1,w,k),l=r(1,_,v),c=r(1,C,v),d=r(2,S,T),u=r(2,E,A),h=r(4,M,P),p=r(4,x,R),f=r(4,D,L),m=r(8,j,O);n.Int8Array=n.Int8Array||s,n.Uint8Array=n.Uint8Array||l,n.Uint8ClampedArray=n.Uint8ClampedArray||c,n.Int16Array=n.Int16Array||d,n.Uint16Array=n.Uint16Array||u,n.Int32Array=n.Int32Array||h,n.Uint32Array=n.Uint32Array||p,n.Float32Array=n.Float32Array||f,n.Float64Array=n.Float64Array||m}(),function(){function e(e,t){return a.IsCallable(e.get)?e.get(t):e[t]}var t,r=(t=new n.Uint16Array([4660]),18===e(new n.Uint8Array(t.buffer),0)),s=function(e,t,r){if(0===arguments.length)e=new n.ArrayBuffer(0);else if(!(e instanceof n.ArrayBuffer||"ArrayBuffer"===a.Class(e)))throw new TypeError("TypeError");if(this.buffer=e||new n.ArrayBuffer(0),this.byteOffset=a.ToUint32(t),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteLength=arguments.length<3?this.buffer.byteLength-this.byteOffset:a.ToUint32(r),this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");g(this)};function i(t){return function(s,i){if((s=a.ToUint32(s))+t.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");s+=this.byteOffset;var o,l=new n.Uint8Array(this.buffer,s,t.BYTES_PER_ELEMENT),c=[];for(o=0;o<t.BYTES_PER_ELEMENT;o+=1)c.push(e(l,o));return Boolean(i)===Boolean(r)&&c.reverse(),e(new t(new n.Uint8Array(c).buffer),0)}}function o(t){return function(s,i,o){if((s=a.ToUint32(s))+t.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");var l,c=new t([i]),d=new n.Uint8Array(c.buffer),u=[];for(l=0;l<t.BYTES_PER_ELEMENT;l+=1)u.push(e(d,l));Boolean(o)===Boolean(r)&&u.reverse(),new n.Uint8Array(this.buffer,s,t.BYTES_PER_ELEMENT).set(u)}}s.prototype.getUint8=i(n.Uint8Array),s.prototype.getInt8=i(n.Int8Array),s.prototype.getUint16=i(n.Uint16Array),s.prototype.getInt16=i(n.Int16Array),s.prototype.getUint32=i(n.Uint32Array),s.prototype.getInt32=i(n.Int32Array),s.prototype.getFloat32=i(n.Float32Array),s.prototype.getFloat64=i(n.Float64Array),s.prototype.setUint8=o(n.Uint8Array),s.prototype.setInt8=o(n.Int8Array),s.prototype.setUint16=o(n.Uint16Array),s.prototype.setInt16=o(n.Int16Array),s.prototype.setUint32=o(n.Uint32Array),s.prototype.setInt32=o(n.Int32Array),s.prototype.setFloat32=o(n.Float32Array),s.prototype.setFloat64=o(n.Float64Array),n.DataView=n.DataView||s}()}}},{package:"browserify>concat-stream>typedarray",file:"node_modules/typedarray/index.js"}],[4046,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/concat.js"}],[4047,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/equals.js"}],[4048,{multibase:3547},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{encoding:r}=e("multibase"),s=new TextEncoder;t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.encode(e):"ascii"===t?function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e):r(t).decode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/from-string.js"}],[4049,{multibase:3547},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{encoding:r}=e("multibase"),s=new TextDecoder("utf8");t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.decode(e):"ascii"===t?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):r(t).encode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/to-string.js"}],[4082,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){!function(e){var t,n,r,s=String.fromCharCode;function i(e){for(var t,n,r=[],s=0,i=e.length;s<i;)(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<i?56320==(64512&(n=e.charCodeAt(s++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),s--):r.push(t);return r}function o(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function a(e,t){return s(e>>t&63|128)}function l(e){if(!(4294967168&e))return s(e);var t="";return 4294965248&e?4294901760&e?4292870144&e||(t=s(e>>18&7|240),t+=a(e,12),t+=a(e,6)):(o(e),t=s(e>>12&15|224),t+=a(e,6)):t=s(e>>6&31|192),t+=s(63&e|128)}function c(){if(r>=n)throw Error("Invalid byte index");var e=255&t[r];if(r++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(){var e,s;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(e=255&t[r],r++,!(128&e))return e;if(192==(224&e)){if((s=(31&e)<<6|c())>=128)return s;throw Error("Invalid continuation byte")}if(224==(240&e)){if((s=(15&e)<<12|c()<<6|c())>=2048)return o(s),s;throw Error("Invalid continuation byte")}if(240==(248&e)&&(s=(7&e)<<18|c()<<12|c()<<6|c())>=65536&&s<=1114111)return s;throw Error("Invalid UTF-8 detected")}e.version="3.0.0",e.encode=function(e){for(var t=i(e),n=t.length,r=-1,s="";++r<n;)s+=l(t[r]);return s},e.decode=function(e){t=i(e),n=t.length,r=0;for(var o,a=[];!1!==(o=d());)a.push(o);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=s((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=s(t);return i}(a)}}(void 0===n?this.utf8={}:n)}}},{package:"@metamask/keyring-controller>ethereumjs-wallet>utf8",file:"node_modules/utf8/utf8.js"}],[41,{"../../../shared/constants/app":4138,"../../../shared/constants/metametrics":4148,"../../../shared/constants/security-provider":4155,"../../../shared/constants/time":4160,"../../../shared/constants/transaction":4162,"../../../ui/helpers/utils/metrics":4966,"./snap-keyring/metrics":84,"@metamask/controller-utils":1081,"eth-rpc-errors":2885,"ethereumjs-util":2916},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({trackEvent:e,getMetricsState:t,rateLimitSeconds:n=300,getAccountType:b,getDeviceModel:y,snapAndHardwareMessenger:w,appStateController:k}){return async function(_,v,C){const{origin:S,method:T}=_,E=f[T]??p.RATE_LIMITED,A=E===p.RATE_LIMITED&&void 0!==m[T],M=!0===t().participateInMetaMetrics,P=g[T],x={},R=S!==o.ORIGIN_METAMASK&&E!==p.BLOCKED&&!1===A&&!0===M;if(R){const t=P?P.REQUESTED:a.MetaMetricsEventName.ProviderMethodCalled;if(t===a.MetaMetricsEventName.SignatureRequested){var N,I,O,j,L;let e;var D,U;if(x.signature_type=T,(0,i.isValidAddress)(null==_||null===(N=_.params)||void 0===N?void 0:N[1]))e=null==_||null===(D=_.params)||void 0===D?void 0:D[0];else e=null==_||null===(U=_.params)||void 0===U?void 0:U[1];null!==(I=_.securityAlertResponse)&&void 0!==I&&I.providerRequestsCount&&Object.keys(_.securityAlertResponse.providerRequestsCount).forEach((e=>{x[`ppom_${e}_count`]=_.securityAlertResponse.providerRequestsCount[e]})),x.security_alert_response=(null===(O=_.securityAlertResponse)||void 0===O?void 0:O.result_type)??c.BlockaidResultType.NotApplicable,x.security_alert_reason=(null===(j=_.securityAlertResponse)||void 0===j?void 0:j.reason)??c.BlockaidReason.notApplicable,null!==(L=_.securityAlertResponse)&&void 0!==L&&L.description&&(x.security_alert_description=_.securityAlertResponse.description);const t=await(0,h.getSnapAndHardwareInfoForMetrics)(b,y,w);Object.assign(x,t);try{if(T===o.MESSAGE_TYPE.PERSONAL_SIGN){const{isSIWEMessage:t}=(0,r.detectSIWE)({data:e});t&&(x.ui_customizations=(x.ui_customizations||[]).concat(a.MetaMetricsEventUiCustomization.Siwe))}}catch(e){console.warn(`createRPCMethodTrackingMiddleware: Errored - ${e}`)}}else x.method=T;e({event:t,category:a.MetaMetricsEventCategory.InpageProvider,referrer:{url:S},properties:x}),m[T]=setTimeout((()=>{delete m[T]}),l.SECOND*n)}C((async t=>{var n,r,i,l;if(!1===R||void 0===P)return t();const h=T===o.MESSAGE_TYPE.ETH_SIGN&&(null===(n=v.error)||void 0===n?void 0:n.code)===s.errorCodes.rpc.methodNotFound;let p;h?(p=P.FAILED,x.error=v.error):(null===(r=v.error)||void 0===r?void 0:r.code)===s.errorCodes.provider.userRejectedRequest?p=P.REJECTED:(null===(i=v.error)||void 0===i?void 0:i.code)===s.errorCodes.rpc.internal&&"Request rejected by user or snap."===(null===(l=v.error)||void 0===l?void 0:l.message)?(p=P.REJECTED,x.status=v.error.message):p=P.APPROVED;let f={};if(!h&&d.SIGNING_METHODS.includes(T)){var g;const e=k.getSignatureSecurityAlertResponse(null===(g=_.securityAlertResponse)||void 0===g?void 0:g.securityAlertId);f=(0,u.getBlockaidMetricsProps)({securityAlertResponse:e})}const m={...x,...f,security_alert_reason:f.security_alert_response===c.BlockaidResultType.Benign?"":f.security_alert_reason};return e({event:p,category:a.MetaMetricsEventCategory.InpageProvider,referrer:{url:S},properties:m}),t()}))}};var r=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),i=e("ethereumjs-util"),o=e("../../../shared/constants/app"),a=e("../../../shared/constants/metametrics"),l=e("../../../shared/constants/time"),c=e("../../../shared/constants/security-provider"),d=e("../../../shared/constants/transaction"),u=e("../../../ui/helpers/utils/metrics"),h=e("./snap-keyring/metrics");const p={RATE_LIMITED:"rate_limited",BLOCKED:"blocked",NON_RATE_LIMITED:"non_rate_limited"},f={[o.MESSAGE_TYPE.ETH_SIGN]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.PERSONAL_SIGN]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_DECRYPT]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:p.NON_RATE_LIMITED,[o.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:p.RATE_LIMITED,[o.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:p.RATE_LIMITED,[o.MESSAGE_TYPE.SEND_METADATA]:p.BLOCKED,[o.MESSAGE_TYPE.GET_PROVIDER_STATE]:p.BLOCKED},g={[o.MESSAGE_TYPE.ETH_SIGN]:{APPROVED:a.MetaMetricsEventName.SignatureApproved,FAILED:a.MetaMetricsEventName.SignatureFailed,REJECTED:a.MetaMetricsEventName.SignatureRejected,REQUESTED:a.MetaMetricsEventName.SignatureRequested},[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:a.MetaMetricsEventName.SignatureApproved,REJECTED:a.MetaMetricsEventName.SignatureRejected,REQUESTED:a.MetaMetricsEventName.SignatureRequested},[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:a.MetaMetricsEventName.SignatureApproved,REJECTED:a.MetaMetricsEventName.SignatureRejected,REQUESTED:a.MetaMetricsEventName.SignatureRequested},[o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:a.MetaMetricsEventName.SignatureApproved,REJECTED:a.MetaMetricsEventName.SignatureRejected,REQUESTED:a.MetaMetricsEventName.SignatureRequested},[o.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:a.MetaMetricsEventName.SignatureApproved,REJECTED:a.MetaMetricsEventName.SignatureRejected,REQUESTED:a.MetaMetricsEventName.SignatureRequested},[o.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:a.MetaMetricsEventName.DecryptionApproved,REJECTED:a.MetaMetricsEventName.DecryptionRejected,REQUESTED:a.MetaMetricsEventName.DecryptionRequested},[o.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:a.MetaMetricsEventName.EncryptionPublicKeyApproved,REJECTED:a.MetaMetricsEventName.EncryptionPublicKeyRejected,REQUESTED:a.MetaMetricsEventName.EncryptionPublicKeyRequested},[o.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:a.MetaMetricsEventName.PermissionsApproved,REJECTED:a.MetaMetricsEventName.PermissionsRejected,REQUESTED:a.MetaMetricsEventName.PermissionsRequested},[o.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:a.MetaMetricsEventName.PermissionsApproved,REJECTED:a.MetaMetricsEventName.PermissionsRejected,REQUESTED:a.MetaMetricsEventName.PermissionsRequested}},m={}}}},{package:"$root$",file:"app/scripts/lib/createRPCMethodTrackingMiddleware.js"}],[4106,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function e(t,n){var i,o=0,a=0,l=n=n||0,c=t.length;do{if(l>=c||a>49)throw e.bytes=0,new RangeError("Could not decode varint");i=t[l++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return e.bytes=l-n,o};var r=128,s=127}}},{package:"sass-embedded>varint",file:"node_modules/varint/decode.js"}],[4107,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function e(t,n,o){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");n=n||[];var a=o=o||0;for(;t>=i;)n[o++]=255&t|r,t/=128;for(;t&s;)n[o++]=255&t|r,t>>>=7;return n[o]=0|t,e.bytes=o-a+1,n};var r=128,s=-128,i=Math.pow(2,31)}}},{package:"sass-embedded>varint",file:"node_modules/varint/encode.js"}],[4108,{"./decode.js":4106,"./encode.js":4107,"./length.js":4109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"sass-embedded>varint",file:"node_modules/varint/index.js"}],[4109,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=Math.pow(2,7),s=Math.pow(2,14),i=Math.pow(2,21),o=Math.pow(2,28),a=Math.pow(2,35),l=Math.pow(2,42),c=Math.pow(2,49),d=Math.pow(2,56),u=Math.pow(2,63);t.exports=function(e){return e<r?1:e<s?2:e<i?3:e<o?4:e<a?5:e<l?6:e<c?7:e<d?8:e<u?9:10}}}},{package:"sass-embedded>varint",file:"node_modules/varint/length.js"}],[4117,{util:4086},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){n.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:e("util").TextEncoder,n.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:e("util").TextDecoder}}},{package:"@ensdomains/content-hash>multihashes>web-encoding",file:"node_modules/web-encoding/src/lib.js"}],[4136,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM=n.AUTO_LOCK_TIMEOUT_ALARM=void 0;n.AUTO_LOCK_TIMEOUT_ALARM="AUTO_LOCK_TIMEOUT_ALARM",n.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM="METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM"}}},{package:"$root$",file:"shared/constants/alarms.js"}],[4147,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LOG_EVENT=void 0;n.LOG_EVENT={VERSION_UPDATE:"Extension version update"}}}},{package:"$root$",file:"shared/constants/logs.ts"}],[4151,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TrezorAction=n.OffscreenCommunicationTarget=n.OffscreenCommunicationEvents=n.LedgerAction=n.KnownOrigins=void 0;n.OffscreenCommunicationTarget=function(e){return e.trezorOffscreen="trezor-offscreen",e.ledgerOffscreen="ledger-offscreen",e.latticeOffscreen="lattice-offscreen",e.extension="extension-offscreen",e}({}),n.OffscreenCommunicationEvents=function(e){return e.trezorDeviceConnect="trezor-device-connect",e.ledgerDeviceConnect="ledger-device-connect",e}({}),n.TrezorAction=function(e){return e.init="trezor-init",e.dispose="trezor-dispose",e.getPublicKey="trezor-get-public-key",e.signTransaction="trezor-sign-transaction",e.signMessage="trezor-sign-message",e.signTypedData="trezor-sign-typed-data",e}({}),n.LedgerAction=function(e){return e.makeApp="ledger-make-app",e.updateTransport="ledger-update-transport",e.unlock="ledger-unlock",e.getPublicKey="ledger-unlock",e.signTransaction="ledger-sign-transaction",e.signMessage="ledger-sign-message",e.signTypedData="ledger-sign-typed-data",e}({}),n.KnownOrigins=function(e){return e.lattice="https://lattice.gridplus.io",e.ledger="https://metamask.github.io",e}({})}}},{package:"$root$",file:"shared/constants/offscreen-communication.ts"}],[4186,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSmartTransactionMetricsProperties=void 0;n.getSmartTransactionMetricsProperties=(e,t)=>{const n=e.getIsSmartTransaction(),r={is_smart_transaction:n};if(!n)return r;const s=e.getSmartTransactionByMinedTxHash(t.hash),i=null==s?void 0:s.statusMetadata;return i?(r.smart_transaction_duplicated=i.duplicated,r.smart_transaction_timed_out=i.timedOut,r.smart_transaction_proxied=i.proxied,r):r}}}},{package:"$root$",file:"shared/modules/metametrics.ts"}],[42,{"promise-to-callback":3649,"readable-stream":3878},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){return new o(e,t)};var r,s=e("readable-stream"),i=(r=e("promise-to-callback"))&&r.__esModule?r:{default:r};class o extends s.Writable{constructor(e,t){super({objectMode:!0,...t}),this._asyncWriteFn=e}_write(e,t,n){(0,i.default)(this._asyncWriteFn(e,t))(n)}}}}},{package:"$root$",file:"app/scripts/lib/createStreamSink.js"}],[43,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,r){t.tabId=e.tabId,r()}}}}},{package:"$root$",file:"app/scripts/lib/createTabIdMiddleware.js"}],[44,{"@metamask/browser-passworder":1073},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.encryptorFactory=void 0;var r=e("@metamask/browser-passworder");const s=e=>async(t,n,s,i)=>(0,r.encrypt)(t,n,s,i,{algorithm:"PBKDF2",params:{iterations:e}}),i=e=>async(t,n,s)=>(0,r.encryptWithDetail)(t,n,s,{algorithm:"PBKDF2",params:{iterations:e}}),o=e=>t=>(0,r.isVaultUpdated)(t,{algorithm:"PBKDF2",params:{iterations:e}});n.encryptorFactory=e=>({encrypt:s(e),encryptWithKey:r.encryptWithKey,encryptWithDetail:i(e),decrypt:r.decrypt,decryptWithKey:r.decryptWithKey,decryptWithDetail:r.decryptWithDetail,keyFromPassword:r.keyFromPassword,isVaultUpdated:o(e),importKey:r.importKey})}}},{package:"$root$",file:"app/scripts/lib/encryptor-factory.ts"}],[45,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/registry.js"}],[46,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[47,{"./contracts/registry":45,"./contracts/resolver":46,"@ensdomains/content-hash":326,"@metamask/ethjs-contract":1227,"@metamask/ethjs-query":1231,"eth-ens-namehash":2853},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=async function({provider:e,name:t}){const n=new s.default(e),c=r.default.hash(t),u=new i.default(n),h=Number.parseInt(await n.net_version(),10),p=function(e){switch(e){case 1:case 3:case 4:case 5:case 6:return"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";default:return null}}(h);if(!p)throw new Error(`EnsIpfsResolver - no known ens-ipfs registry for chainId "${h}"`);const f=u(a.default).at(p),g=(await f.resolver(c))[0];if(d(g))throw new Error(`EnsIpfsResolver - no resolver found for name "${t}"`);const m=u(l.default).at(g),b=await m.supportsInterface("0xbc1c58d1"),y=await m.supportsInterface("0xd8389dc5");if(b[0]){const e=(await m.contenthash(c))[0];let t=o.default.decode(e);const n=o.default.getCodec(e);return"ipfs-ns"!==n&&"ipns-ns"!==n||(t=o.default.helpers.cidV0ToV1Base32(t)),{type:n,hash:t}}if(y[0]){const e=(await m.content(c))[0];if(d(e))throw new Error(`EnsIpfsResolver - no content ID found for name "${t}"`);return{type:"swarm-ns",hash:e.slice(2)}}throw new Error(`EnsIpfsResolver - the resolver for name "${t}" is not standard, it should either supports contenthash() or content()`)};var r=c(e("eth-ens-namehash")),s=c(e("@metamask/ethjs-query")),i=c(e("@metamask/ethjs-contract")),o=c(e("@ensdomains/content-hash")),a=c(e("./contracts/registry")),l=c(e("./contracts/resolver"));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){return[undefined,null,"0x","0x0","0x0000000000000000000000000000000000000000000000000000000000000000"].includes(e)}}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/resolver.js"}],[48,{"../../../../shared/modules/fetch-with-timeout":4182,"./resolver":47,"base32-encode":2556,"base64-js":2557,"webextension-polyfill":4122},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({provider:e,getCurrentChainId:t,getIpfsGateway:n,getUseAddressBarEnsResolution:o}){const l=d.map((e=>`*://*.${e}/*`));return i.default.webRequest.onErrorOccurred.addListener(u,{urls:l,types:["main_frame"]}),{remove(){i.default.webRequest.onErrorOccurred.removeListener(u)}};async function u(l){const{tabId:u,url:h}=l;if(-1===u||"0x1"!==t())return;const{hostname:p,pathname:f,search:g,hash:m}=new URL(h),b=p.split("."),y=b[b.length-1];d.includes(y)&&async function({tabId:t,name:l,pathname:d,search:u,fragment:h}){const p=n(),f=o(),g=`https://app.ens.domains/name/${l}`;f&&p&&i.default.tabs.update(t,{url:"loading.html"});let m=g;0;try{const{type:t,hash:n}=await(0,a.default)({provider:e,name:l});if("ipfs-ns"===t||"ipns-ns"===t){if(""===p)return void(m=null);const e=`https://${n}.${t.slice(0,4)}.${p}${d}${u||""}${h||""}`;try{200===(await c(e,{method:"HEAD"})).status&&(m=e)}catch(e){console.warn(e)}}else if("swarm-ns"===t)m=`https://swarm-gateways.net/bzz:/${n}${d}${u||""}${h||""}`;else if("onion"===t||"onion3"===t)m=`http://${n}.onion${d}${u||""}${h||""}`;else if("zeronet"===t)m=`http://127.0.0.1:43110/${n}${d}${u||""}${h||""}`;else if("skynet-ns"===t){const e=n.padEnd(n.length+4-n.length%4,"="),t=s.default.toByteArray(e),i={padding:!1};m=`https://${(0,r.default)(t,"RFC4648-HEX",i).toLowerCase()}.siasky.net${d}${u||""}${h||""}`}}catch(e){console.warn(e)}finally{m&&(f||!f&&m!==g)&&i.default.tabs.update(t,{url:m})}}({tabId:u,name:p,pathname:f,search:g,fragment:m})}};var r=l(e("base32-encode")),s=l(e("base64-js")),i=l(e("webextension-polyfill")),o=l(e("../../../../shared/modules/fetch-with-timeout")),a=l(e("./resolver"));function l(e){return e&&e.__esModule?e:{default:e}}const c=(0,o.default)(),d=["eth"]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/setup.js"}],[5,{"../../../shared/constants/network":4149},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SINGLE_CALL_BALANCES_ADDRESSES=void 0;var r=e("../../../shared/constants/network");n.SINGLE_CALL_BALANCES_ADDRESSES={[r.CHAIN_IDS.MAINNET]:"0xb1f8e55c7f64d203c1400b9d8555d050f94adf39",[r.CHAIN_IDS.GOERLI]:"0x9788C4E93f9002a7ad8e72633b11E8d1ecd51f9b",[r.CHAIN_IDS.SEPOLIA]:"",[r.CHAIN_IDS.BSC]:"0x2352c63A83f9Fd126af8676146721Fa00924d7e4",[r.CHAIN_IDS.OPTIMISM]:"0xB1c568e9C3E6bdaf755A60c7418C269eb11524FC",[r.CHAIN_IDS.POLYGON]:"0x2352c63A83f9Fd126af8676146721Fa00924d7e4",[r.CHAIN_IDS.AVALANCHE]:"0xD023D153a0DFa485130ECFdE2FAA7e612EF94818",[r.CHAIN_IDS.FANTOM]:"0x07f697424ABe762bB808c109860c04eA488ff92B",[r.CHAIN_IDS.ARBITRUM]:"0x151E24A486D7258dd7C33Fb67E4bB01919B7B32c",[r.CHAIN_IDS.BLAST]:"0xfd5730e96f9dffae40d99b77015bd42816280998",[r.CHAIN_IDS.LINEA_GOERLI]:"0x10dAd7Ca3921471f616db788D9300DC97Db01783",[r.CHAIN_IDS.LINEA_MAINNET]:"0xF62e6a41561b3650a69Bb03199C735e3E3328c0D",[r.CHAIN_IDS.AURORA]:"0x1286415D333855237f89Df27D388127181448538",[r.CHAIN_IDS.BASE]:"0x6AA75276052D96696134252587894ef5FFA520af",[r.CHAIN_IDS.ZKSYNC_ERA]:"0x458fEd3144680a5b8bcfaa0F9594aa19B4Ea2D34"}}}},{package:"$root$",file:"app/scripts/constants/contracts.ts"}],[51,{lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return s((0,r.cloneDeep)(e),(e=>null===e?"null":typeof e))};var r=e("lodash");function s(e={},t){return Object.entries(e).forEach((([n,r])=>{e[n]="object"==typeof r&&null!==r?s(r,t):t(r)})),e}}}},{package:"$root$",file:"app/scripts/lib/getObjStructure.js"}],[52,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hardwareKeyringBuilderFactory=function(e,t){const n=()=>new e({bridge:new t});return n.type=e.type,n}}}},{package:"$root$",file:"app/scripts/lib/hardware-keyring-builder-factory.ts"}],[522,{"@ethereumjs/tx":388,"@ethereumjs/util":400,"@keystonehq/bc-ur-registry-eth":527,buffer:2654,hdkey:3265,rlp:3910,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(n,"__esModule",{value:!0});var s=r(e("hdkey")),i=e("@ethereumjs/util"),o=r(e("rlp")),a=e("@ethereumjs/tx"),l=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid");const d="QR Hardware Wallet Device",u="m",h="0/*";var p,f;!function(e){e.hd="hd",e.pubkey="pubkey"}(p||(p={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(f||(f={}));class g{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type=d,this.requestSignature=async(e,t,n,r)=>{const s=await this.getInteraction().requestSignature(t,n,r),i=s.getRequestId(),o=s.getSignature();if(i){if(c.stringify(i)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId")}return{r:o.slice(0,32),s:o.slice(32,64),v:o.slice(64)}},this.__readCryptoHDKey=e=>{var t,n;const r=`m/${e.getOrigin().getPath()}`,s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),i=(null==(n=e.getChildren())?void 0:n.getPath())||h,o=e.getName();if(e.getNote()===f.standard?this.keyringAccount=f.standard:e.getNote()===f.ledger_legacy&&(this.keyringAccount=f.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const a=e.getBip32Key();this.xfp=s,this.xpub=a,this.hdPath=r,this.childrenPath=i,o!==undefined&&""!==o&&(this.name=o),this.initialized=!0},this.__readCryptoAccount=e=>{var t,n;const r=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!r)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=r,this.initialized=!0;let s=!1;const o=e.getOutputDescriptors();if(!o||0===o.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(o.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(n=e.getOutputDescriptors())||n.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),n=`M/${t.getOrigin().getPath()}`,r="0x"+i.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===f.ledger_live&&(this.keyringAccount=f.ledger_live),this.paths[i.toChecksumAddress(r)]===undefined&&(s=!0),this.paths[i.toChecksumAddress(r)]=n}}catch(e){throw new Error(`KeystoneError#invalid_data: ${e}`)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,n=t+this.perPage,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex(u,e);r.push({address:t,balance:null,index:e}),this.indexes[i.toChecksumAddress(t)]=e}return r},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,n=t+this.perPage,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex(u,e);r.push({address:t,balance:null,index:e})}return this.page+=e,r},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===p.hd){this.checkKeyring(),this.hdk||(this.hdk=s.fromExtendedKey(this.xpub));const n=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),r=this.hdk.derive(`${e}/${n}`),o="0x"+i.publicToAddress(r.publicKey,!0).toString("hex");return i.toChecksumAddress(o)}{const e=Object.keys(this.paths)[t];if(e)return i.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=p.hd,this.keyringAccount=f.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath=h,this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===l.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=p.hd,this.__readCryptoHDKey(e)):(this.keyringMode=p.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||p.hd,this.keyringAccount=e.keyringAccount||f.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||h)}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,n=t+e,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex(u,e);r.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(r),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===p.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,n){const r=0===n.type?l.DataType.transaction:l.DataType.typedTransaction;let s;s=0===n.type?t.from(o.encode(n.getMessageToSign(!1))):n.getMessageToSign(!1);const i=await this._pathFromAddress(e),d=Number(n.common.chainId()),u=c.v4(),h=l.EthSignRequest.constructETHRequest(s,r,i,this.xfp,u,d),{r:p,s:f,v:g}=await this.requestSignature(u,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return a.TransactionFactory.fromTxData({...n.toJSON(),type:n.type,r:p,s:f,v:g},{common:n.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,n){const r=i.stripHexPrefix(n),s=await this._pathFromAddress(e),o=c.v4(),a=l.EthSignRequest.constructETHRequest(t.from(r,"hex"),l.DataType.personalMessage,s,this.xfp,o,undefined,e),{r:d,s:u,v:h}=await this.requestSignature(o,a,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([d,u,h]).toString("hex")}async signTypedData(e,n){const r=await this._pathFromAddress(e),s=c.v4(),i=l.EthSignRequest.constructETHRequest(t.from(JSON.stringify(n),"utf-8"),l.DataType.typedData,r,this.xfp,s,undefined,e),{r:o,s:a,v:d}=await this.requestSignature(s,i,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([o,a,d]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===p.hd){const t=i.toChecksumAddress(e);let n=this.indexes[t];if(void 0===n)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex(u,e)){n=e;break}if(void 0===n)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",n.toString()).replace(/\*/g,"0")}`}{const t=i.toChecksumAddress(e),n=this.paths[t];if(void 0===n)throw new Error("Unknown address");return n}}}g.type=d,n.BaseKeyring=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.development.js"}],[523,{"@ethereumjs/tx":388,"@ethereumjs/util":400,"@keystonehq/bc-ur-registry-eth":527,buffer:2654,hdkey:3265,rlp:3910,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(n,"__esModule",{value:!0});var s,i,o=r(e("hdkey")),a=e("@ethereumjs/util"),l=r(e("rlp")),c=e("@ethereumjs/tx"),d=e("@keystonehq/bc-ur-registry-eth"),u=e("uuid");!function(e){e.hd="hd",e.pubkey="pubkey"}(s||(s={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(i||(i={}));class h{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type="QR Hardware Wallet Device",this.requestSignature=async(e,t,n,r)=>{const s=await this.getInteraction().requestSignature(t,n,r),i=s.getRequestId(),o=s.getSignature();if(i&&u.stringify(i)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId");return{r:o.slice(0,32),s:o.slice(32,64),v:o.slice(64)}},this.__readCryptoHDKey=e=>{var t,n;const r="m/"+e.getOrigin().getPath(),s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),o=(null==(n=e.getChildren())?void 0:n.getPath())||"0/*",a=e.getName();if(e.getNote()===i.standard?this.keyringAccount=i.standard:e.getNote()===i.ledger_legacy&&(this.keyringAccount=i.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const l=e.getBip32Key();this.xfp=s,this.xpub=l,this.hdPath=r,this.childrenPath=o,void 0!==a&&""!==a&&(this.name=a),this.initialized=!0},this.__readCryptoAccount=e=>{var t,n;const r=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!r)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=r,this.initialized=!0;let s=!1;const o=e.getOutputDescriptors();if(!o||0===o.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(o.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(n=e.getOutputDescriptors())||n.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),n="M/"+t.getOrigin().getPath(),r="0x"+a.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===i.ledger_live&&(this.keyringAccount=i.ledger_live),void 0===this.paths[a.toChecksumAddress(r)]&&(s=!0),this.paths[a.toChecksumAddress(r)]=n}}catch(e){throw new Error("KeystoneError#invalid_data: "+e)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,n=t+this.perPage,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex("m",e);r.push({address:t,balance:null,index:e}),this.indexes[a.toChecksumAddress(t)]=e}return r},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,n=t+this.perPage,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex("m",e);r.push({address:t,balance:null,index:e})}return this.page+=e,r},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===s.hd){this.checkKeyring(),this.hdk||(this.hdk=o.fromExtendedKey(this.xpub));const n=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),r=this.hdk.derive(`${e}/${n}`),s="0x"+a.publicToAddress(r.publicKey,!0).toString("hex");return a.toChecksumAddress(s)}{const e=Object.keys(this.paths)[t];if(e)return a.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=s.hd,this.keyringAccount=i.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath="0/*",this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===d.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=s.hd,this.__readCryptoHDKey(e)):(this.keyringMode=s.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||s.hd,this.keyringAccount=e.keyringAccount||i.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||"0/*")}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,n=t+e,r=[];for(let e=t;e<n;e++){const t=await this.__addressFromIndex("m",e);r.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(r),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===s.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,n){const r=0===n.type?d.DataType.transaction:d.DataType.typedTransaction;let s;s=0===n.type?t.from(l.encode(n.getMessageToSign(!1))):n.getMessageToSign(!1);const i=await this._pathFromAddress(e),o=Number(n.common.chainId()),a=u.v4(),h=d.EthSignRequest.constructETHRequest(s,r,i,this.xfp,a,o),{r:p,s:f,v:g}=await this.requestSignature(a,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return c.TransactionFactory.fromTxData({...n.toJSON(),type:n.type,r:p,s:f,v:g},{common:n.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,n){const r=a.stripHexPrefix(n),s=await this._pathFromAddress(e),i=u.v4(),o=d.EthSignRequest.constructETHRequest(t.from(r,"hex"),d.DataType.personalMessage,s,this.xfp,i,void 0,e),{r:l,s:c,v:h}=await this.requestSignature(i,o,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([l,c,h]).toString("hex")}async signTypedData(e,n){const r=await this._pathFromAddress(e),s=u.v4(),i=d.EthSignRequest.constructETHRequest(t.from(JSON.stringify(n),"utf-8"),d.DataType.typedData,r,this.xfp,s,void 0,e),{r:o,s:a,v:l}=await this.requestSignature(s,i,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([o,a,l]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===s.hd){const t=a.toChecksumAddress(e);let n=this.indexes[t];if(void 0===n)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex("m",e)){n=e;break}if(void 0===n)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",n.toString()).replace(/\*/g,"0")}`}{const t=a.toChecksumAddress(e),n=this.paths[t];if(void 0===n)throw new Error("Unknown address");return n}}}h.type="QR Hardware Wallet Device",n.BaseKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.production.min.js"}],[524,{"./base-eth-keyring.cjs.development.js":522,"./base-eth-keyring.cjs.production.min.js":523},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("./base-eth-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/index.js"}],[53,{"@metamask/keyring-api":1318,"@metamask/permission-controller":1484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isProtocolAllowed=l,n.keyringSnapPermissionsBuilder=function(e,t){return()=>{if("metamask"===t)return i;const n=e.getSubjectMetadata(t);return(null==n?void 0:n.subjectType)===r.SubjectType.Website&&l(t)?o:[]}};var r=e("@metamask/permission-controller"),s=e("@metamask/keyring-api");const i=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.SubmitRequest,s.KeyringRpcMethod.RejectRequest],o=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.CreateAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.UpdateAccount,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ExportAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.ApproveRequest,s.KeyringRpcMethod.RejectRequest,s.KeyringRpcMethod.SubmitRequest],a=["https:"];function l(e){try{const t=new URL(e);return a.includes(t.protocol)}catch(e){return!1}}}}},{package:"$root$",file:"app/scripts/lib/keyring-snaps-permissions.ts"}],[554,{"./metamask-airgapped-keyring.cjs.development.js":555,"./metamask-airgapped-keyring.cjs.production.min.js":556},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/index.js"}],[555,{"@ethereumjs/tx":388,"@keystonehq/base-eth-keyring":524,"@keystonehq/bc-ur-registry-eth":527,"@metamask/obs-store":561,buffer:2654,events:2956,rlp:564,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0});var r,s=e("@keystonehq/base-eth-keyring"),i=e("events"),o=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),l=e("uuid"),c=e("@ethereumjs/tx"),d=(r=e("rlp"))&&"object"==typeof r&&"default"in r?r.default:r;class u extends i.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(`${e}-signed`),this.removeAllListeners(`${e}-canceled`)},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,n)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(n=>{const r=a.CryptoHDKey.fromCBOR(t.from(n,"hex"));this.resetState(),e(r)})),this.on("keystone-sync_success-account",(n=>{const r=a.CryptoAccount.fromCBOR(t.from(n,"hex"));this.resetState(),e(r)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),n(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,n,r)=>new Promise(((s,i)=>{const o=e.toUR(),c=e.getRequestId(),d=l.stringify(c),u={requestId:d,payload:{type:o.type,cbor:o.cbor.toString("hex")},title:n,description:r};this.memStore.updateState({sign:{request:u}}),this.once(`${d}-signed`,(e=>{const n=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(n)})),this.once(`${d}-canceled`,(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},u.instance)return u.instance;this.memStore=new o.ObservableStore({sync:{reading:!1},sign:{},_version:1}),u.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new u,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const n=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let r;r=0===t.type?d.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),i=t.common.chainId(),o=l.v4(),u=a.EthSignRequest.constructETHRequest(r,n,s,this.xfp,o,i,e),{r:h,s:p,v:f}=await this.requestSignature(o,u,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();g.v=f,g.s=p,g.r=h,g.type=t.type;return c.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,n.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[556,{"@ethereumjs/tx":388,"@keystonehq/base-eth-keyring":524,"@keystonehq/bc-ur-registry-eth":527,"@metamask/obs-store":561,buffer:2654,events:2956,rlp:564,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0});var r,s=e("@keystonehq/base-eth-keyring"),i=e("events"),o=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),l=e("uuid"),c=e("@ethereumjs/tx"),d=(r=e("rlp"))&&"object"==typeof r&&"default"in r?r.default:r;class u extends i.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(e+"-signed"),this.removeAllListeners(e+"-canceled")},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,n)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(n=>{const r=a.CryptoHDKey.fromCBOR(t.from(n,"hex"));this.resetState(),e(r)})),this.on("keystone-sync_success-account",(n=>{const r=a.CryptoAccount.fromCBOR(t.from(n,"hex"));this.resetState(),e(r)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),n(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,n,r)=>new Promise(((s,i)=>{const o=e.toUR(),c=e.getRequestId(),d=l.stringify(c),u={requestId:d,payload:{type:o.type,cbor:o.cbor.toString("hex")},title:n,description:r};this.memStore.updateState({sign:{request:u}}),this.once(d+"-signed",(e=>{const n=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(n)})),this.once(d+"-canceled",(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},u.instance)return u.instance;this.memStore=new o.ObservableStore({sync:{reading:!1},sign:{},_version:1}),u.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new u,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const n=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let r;r=0===t.type?d.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),i=t.common.chainId(),o=l.v4(),u=a.EthSignRequest.constructETHRequest(r,n,s,this.xfp,o,i,e),{r:h,s:p,v:f}=await this.requestSignature(o,u,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();return g.v=f,g.s=p,g.r=h,g.type=t.type,c.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,n.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[557,{"./ObservableStore":559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComposedStore=void 0;const r=e("./ObservableStore");class s extends r.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const n=t=>{const n=this.getState();n[e]=t,this.putState(n)};t.subscribe(n),n(t.getState())}}n.ComposedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[558,{"./ObservableStore":559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MergedStore=void 0;const r=e("./ObservableStore");class s extends r.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}n.MergedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/MergedStore.js"}],[559,{"@metamask/safe-event-emitter":563},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ObservableStore=void 0;const s=r(e("@metamask/safe-event-emitter"));class i extends s.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}n.ObservableStore=i}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[56,{"../util":92,"json-rpc-engine":3316},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,r.createAsyncMiddleware)((async(t,n,r)=>{const{method:s,params:i}=t;if("eth_getTransactionCount"!==s)return void r();const[o,a]=i;"pending"===a?n.result=await e(o,t.networkClientId):r()}))},n.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,r.createAsyncMiddleware)((async(t,n,r)=>{const{method:i,params:o}=t;if("eth_getTransactionByHash"!==i)return void r();const[a]=o,l=e(a);l?n.result=(0,s.formatTxMetaForRpcResult)(l):r()}))};var r=e("json-rpc-engine"),s=e("../util")}}},{package:"$root$",file:"app/scripts/lib/middleware/pending.js"}],[560,{stream:3983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeAsStream=void 0;const r=e("stream");class s extends r.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const n=super.pipe(e,t);return e.write(this.obsStore.getState()),n}_write(e,t,n){this.obsStore.putState(e),n()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}n.storeAsStream=function(e){return new s(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/asStream.js"}],[561,{"./ComposedStore":557,"./MergedStore":558,"./ObservableStore":559,"./asStream":560,"./transform":562},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),s(e("./asStream"),n),s(e("./ComposedStore"),n),s(e("./MergedStore"),n),s(e("./ObservableStore"),n),s(e("./transform"),n)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/index.js"}],[562,{through2:565},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeTransformStream=void 0;const r=e("through2");n.storeTransformStream=function(e){return r.obj(((t,n,r)=>{try{return r(null,e(t)),undefined}catch(e){return r(e),undefined}}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/transform.js"}],[563,{events:2956},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("events");function s(e,t,n){try{Reflect.apply(e,t,n)}catch(e){setTimeout((()=>{throw e}))}}class i extends r.EventEmitter{emit(e,...t){let n="error"===e;const r=this._events;if(r!==undefined)n=n&&r.error===undefined;else if(!n)return!1;if(n){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const n=new Error("Unhandled error."+(e?` (${e.message})`:""));throw n.context=e,n}const i=r[e];if(i===undefined)return!1;if("function"==typeof i)s(i,this,t);else{const e=i.length,n=function(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}(i);for(let r=0;r<e;r+=1)s(n[r],this,t)}return!0}}n.default=i}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>@metamask/safe-event-emitter",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/safe-event-emitter/index.js"}],[564,{"bn.js":2606,buffer:2654},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getLength=n.decode=n.encode=void 0;var s=r(e("bn.js"));function i(e,t){if("0"===e[0]&&"0"===e[1])throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}function o(e,n){if(e<56)return t.from([e+n]);var r=c(e),s=c(n+55+r.length/2);return t.from(s+r,"hex")}function a(e){var n,r,s,o,l,c=[],d=e[0];if(d<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(d<=183){if(n=d-127,s=128===d?t.from([]):e.slice(1,n),2===n&&s[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:s,remainder:e.slice(n)}}if(d<=191){if(r=d-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if((n=i(e.slice(1,r).toString("hex"),16))<=55)throw new Error("invalid RLP: expected string length to be greater than 55");if((s=e.slice(r,n+r)).length<n)throw new Error("invalid RLP: not enough bytes for string");return{data:s,remainder:e.slice(n+r)}}if(d<=247){for(n=d-191,o=e.slice(1,n);o.length;)l=a(o),c.push(l.data),o=l.remainder;return{data:c,remainder:e.slice(n)}}var u=(r=d-246)+(n=i(e.slice(1,r).toString("hex"),16));if(u>e.length)throw new Error("invalid rlp: total length is larger than the data");if(0===(o=e.slice(r,u)).length)throw new Error("invalid rlp, List has a invalid length");for(;o.length;)l=a(o),c.push(l.data),o=l.remainder;return{data:c,remainder:e.slice(u)}}function l(e){return"0x"===e.slice(0,2)}function c(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");var t=e.toString(16);return t.length%2?"0"+t:t}function d(e){if(!t.isBuffer(e)){if("string"==typeof e)return l(e)?t.from((r="string"!=typeof(i=e)?i:l(i)?i.slice(2):i).length%2?"0"+r:r,"hex"):t.from(e);if("number"==typeof e||"bigint"==typeof e)return e?(n=c(e),t.from(n,"hex")):t.from([]);if(null===e||e===undefined)return t.from([]);if(e instanceof Uint8Array)return t.from(e);if(s.default.isBN(e))return t.from(e.toArray());throw new Error("invalid type")}var n,r,i;return e}n.encode=function e(n){if(Array.isArray(n)){for(var r=[],s=0;s<n.length;s++)r.push(e(n[s]));var i=t.concat(r);return t.concat([o(i.length,192),i])}var a=d(n);return 1===a.length&&a[0]<128?a:t.concat([o(a.length,128),a])},n.decode=function(e,n){if(void 0===n&&(n=!1),!e||0===e.length)return t.from([]);var r=a(d(e));if(n)return r;if(0!==r.remainder.length)throw new Error("invalid remainder");return r.data},n.getLength=function(e){if(!e||0===e.length)return t.from([]);var n=d(e),r=n[0];if(r<=127)return n.length;if(r<=183)return r-127;if(r<=191)return r-182;if(r<=247)return r-191;var s=r-246;return s+i(n.slice(1,s).toString("hex"),16)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>rlp",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/rlp/dist.browser/index.js"}],[565,{_process:3648,"readable-stream":3878,util:4086,xtend:4128},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("readable-stream").Transform,s=e("util").inherits,i=e("xtend");function o(e){r.call(this,e),this._destroyed=!1}function a(e,t,n){n(null,e)}function l(e){return function(t,n,r){return"function"==typeof t&&(r=n,n=t,t={}),"function"!=typeof n&&(n=a),"function"!=typeof r&&(r=null),e(t,n,r)}}s(o,r),o.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;n.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=l((function(e,t,n){var r=new o(e);return r._transform=t,n&&(r._flush=n),r})),t.exports.ctor=l((function(e,t,n){function r(t){if(!(this instanceof r))return new r(t);this.options=i(e,t),o.call(this,this.options)}return s(r,o),r.prototype._transform=t,n&&(r.prototype._flush=n),r})),t.exports.obj=l((function(e,t,n){var r=new o(i({objectMode:!0,highWaterMark:16},e));return r._transform=t,n&&(r._flush=n),r}))}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/through2/through2.js"}],[57,{events:2956,loglevel:3503},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("events")),s=i(e("loglevel"));function i(e){return e&&e.__esModule?e:{default:e}}class o extends r.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort(((e,t)=>e.version-t.version));const n=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||n&&n.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter((function(t){return t.version>e.meta.version}));for(const n of t)try{s.default.info(`Running migration ${n.version}...`);const t=await n.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==n.version)throw new Error("Migrator - Migration did not update version number correctly");e=t,s.default.info(`Migration ${n.version} complete`)}catch(t){const r=t.message;return t.message=`MetaMask Migration Error #${n.version}: ${r}`,this.emit("error",t),e}return e}generateInitialState(e){return{meta:{version:this.defaultVersion},data:e}}}n.default=o}}},{package:"$root$",file:"app/scripts/lib/migrator/index.js"}],[59,{"../../../shared/constants/notifications":4150,"../platforms/extension":216,"@metamask/safe-event-emitter":1588},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.NOTIFICATION_MANAGER_EVENTS=void 0;var r=o(e("@metamask/safe-event-emitter")),s=o(e("../platforms/extension")),i=e("../../../shared/constants/notifications");function o(e){return e&&e.__esModule?e:{default:e}}const a=n.NOTIFICATION_MANAGER_EVENTS={POPUP_CLOSED:"onPopupClosed"};class l extends r.default{constructor(){super(),this.platform=new s.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(e,t){this._popupId=t,this._setCurrentPopupId=e;const n=await this._getPopup(t);if(n)await this.platform.focusWindow(n.id);else{let e=0,t=0;try{const n=await this.platform.getLastFocusedWindow();t=n.top,e=Math.max(n.left+(n.width-i.NOTIFICATION_WIDTH),0)}catch(n){const{screenX:r,screenY:s,outerWidth:o}=window;t=Math.max(s,0),e=Math.max(r+(o-i.NOTIFICATION_WIDTH),0)}const n=await this.platform.openWindow({url:"notification.html",type:"popup",width:i.NOTIFICATION_WIDTH,height:i.NOTIFICATION_HEIGHT,left:e,top:t});n.left!==e&&"fullscreen"!==n.state&&await this.platform.updateWindowPosition(n.id,e,t),this._setCurrentPopupId(n.id),this._popupId=n.id}}_onWindowClosed(e){e===this._popupId&&(this._setCurrentPopupId(undefined),this._popupId=undefined,this.emit(a.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find((e=>e&&"popup"===e.type&&e.id===this._popupId)):null}}n.default=l}}},{package:"$root$",file:"app/scripts/lib/notification-manager.js"}],[6,{"@metamask/base-controller":1072},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountOrderController=void 0;var r=e("@metamask/base-controller");const s={pinnedAccountList:[],hiddenAccountList:[]},i={pinnedAccountList:{persist:!0,anonymous:!0},hiddenAccountList:{persist:!0,anonymous:!0}};class o extends r.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:i,name:"AccountOrderController",state:{...s,...t}})}updateAccountsList(e){this.update((t=>(t.pinnedAccountList=e,t)))}updateHiddenAccountsList(e){this.update((t=>(t.hiddenAccountList=e,t)))}}n.AccountOrderController=o}}},{package:"$root$",file:"app/scripts/controllers/account-order.ts"}],[60,{"../../../../shared/constants/offscreen-communication":4151,"eth-lattice-keyring":2854},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LatticeKeyringOffscreen=void 0;var r,s=(r=e("eth-lattice-keyring"))&&r.__esModule?r:{default:r},i=e("../../../../shared/constants/offscreen-communication");class o extends s.default{constructor(e={}){super(e)}async _getCreds(){try{const e=this.appName?this.appName:"Unknown",t=`${i.KnownOrigins.lattice}?keyring=${e}&forceLogin=true`;return await new Promise(((e,n)=>{chrome.runtime.sendMessage({target:i.OffscreenCommunicationTarget.latticeOffscreen,params:{url:t}},(t=>{t.error&&n(t.error),e(t.result)}))}))}catch(e){throw new Error(e)}}}n.LatticeKeyringOffscreen=o,function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(o,"type",void 0),o.type=s.default.type}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/lattice-offscreen-keyring.ts"}],[61,{"../../../../shared/constants/offscreen-communication":4151},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerOffscreenBridge=void 0;var r=e("../../../../shared/constants/offscreen-communication");function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.LedgerOffscreenBridge=class{constructor(){s(this,"isDeviceConnected",!1)}init(){return chrome.runtime.onMessage.addListener((e=>{e.target===r.OffscreenCommunicationTarget.extension&&e.event===r.OffscreenCommunicationEvents.ledgerDeviceConnect&&(this.isDeviceConnected=!0)})),Promise.resolve()}destroy(){return Promise.resolve()}attemptMakeApp(){return new Promise(((e,t)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.makeApp},(n=>{n.success?e(!0):n.error?t(n.error):t(new Error("Unknown error occurred"))}))}))}updateTransportMethod(e){return new Promise(((t,n)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.updateTransport,params:{transportType:e}},(e=>{e.success?t(!0):n(new Error("Ledger transport could not be updated"))}))}))}getPublicKey(e){return new Promise(((t,n)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.getPublicKey,params:e},(e=>{e.success?t(e.payload):n(e.payload.error)}))}))}deviceSignTransaction(e){return new Promise(((t,n)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.signTransaction,params:e},(e=>{e.success?t(e.payload):n(e.payload.error)}))}))}deviceSignMessage(e){return new Promise(((t,n)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.signMessage,params:e},(e=>{e.success?t(e.payload):n(e.payload.error)}))}))}deviceSignTypedData(e){return new Promise(((t,n)=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.ledgerOffscreen,action:r.LedgerAction.signTypedData,params:e},(e=>{e.success?t(e.payload):n(e.payload.error)}))}))}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/ledger-offscreen-bridge.ts"}],[62,{"../../../../shared/constants/offscreen-communication":4151},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TrezorOffscreenBridge=void 0;var r=e("../../../../shared/constants/offscreen-communication");function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.TrezorOffscreenBridge=class{constructor(){s(this,"model",void 0)}init(e){return chrome.runtime.onMessage.addListener((e=>{e.target===r.OffscreenCommunicationTarget.extension&&e.event===r.OffscreenCommunicationEvents.trezorDeviceConnect&&(this.model=e.payload)})),new Promise((t=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.init,params:e},(()=>{t()}))}))}dispose(){return new Promise((e=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.dispose},(()=>{e()}))}))}getPublicKey(e){return new Promise((t=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.getPublicKey,params:e},(e=>{t(e)}))}))}ethereumSignTransaction(e){return new Promise((t=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.signTransaction,params:e},(e=>{t(e)}))}))}ethereumSignMessage(e){return new Promise((t=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.signMessage,params:e},(e=>{t(e)}))}))}ethereumSignTypedData(e){return new Promise((t=>{chrome.runtime.sendMessage({target:r.OffscreenCommunicationTarget.trezorOffscreen,action:r.TrezorAction.signTypedData,params:e},(e=>{t(e)}))}))}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/trezor-offscreen-bridge.ts"}],[63,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.IndexedDBPPOMStorage=void 0;const i=async(e,t,n)=>{const r=await crypto.subtle.digest("SHA-256",t);if(Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")!==n)throw new Error(`Checksum mismatch for key ${e}`)};var o=new WeakSet;function a(e){return new Promise(((t,n)=>{const r=indexedDB.open(this.storeName,this.dbVersion);r.onerror=e=>{var t;n(new Error(`Failed to open database ${this.storeName}: ${null===(t=e.target)||void 0===t?void 0:t.error}`))},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:["name","chainId"]})},r.onsuccess=n=>{const r=n.target.result.transaction([this.storeName],e).objectStore(this.storeName);t(r)}}))}n.IndexedDBPPOMStorage=class{constructor(e,t){r(this,o),s(this,"storeName",void 0),s(this,"dbVersion",void 0),this.storeName=e,this.dbVersion=t}async objectStoreAction(e,t,n="readonly"){return new Promise(((r,s)=>{(function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n})(this,o,a).call(this,n).then((n=>{const i=n[e](t);i.onsuccess=async e=>{r(e)},i.onerror=t=>{var n;s(new Error(`Error in indexDB operation ${e}: ${null===(n=t.target)||void 0===n?void 0:n.error}`))}})).catch((e=>{s(e)}))}))}async read(e,t){var n;const r=null===(n=(await this.objectStoreAction("get",[e.name,e.chainId])).target)||void 0===n||null===(n=n.result)||void 0===n?void 0:n.data;return await i(e,r,t),r}async write(e,t,n){await i(e,t,n),await this.objectStoreAction("put",{...e,data:t},"readwrite")}async delete(e){await this.objectStoreAction("delete",[e.name,e.chainId],"readwrite")}async dir(){var e;return null===(e=(await this.objectStoreAction("getAllKeys")).target)||void 0===e?void 0:e.result.map((([e,t])=>({name:e,chainId:t})))}}}}},{package:"$root$",file:"app/scripts/lib/ppom/indexed-db-backend.ts"}],[66,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){let r;Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.PPOM=void 0,n.initSync=function(e){if(r!==undefined)return r;const t=E();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const n=new WebAssembly.Instance(e,t);return A(n,e)},n.main=function(){r.main()};const s="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&s.decode();let i=null;function o(){return null!==i&&0!==i.byteLength||(i=new Uint8Array(r.memory.buffer)),i}function a(e,t){return e>>>=0,s.decode(o().subarray(e,e+t))}const l=new Array(128).fill(undefined);l.push(undefined,null,!0,!1);let c=l.length;function d(e){c===l.length&&l.push(l.length+1);const t=c;return c=l[t],l[t]=e,t}function u(e){return l[e]}function h(e){const t=u(e);return function(e){e<132||(l[e]=c,c=e)}(e),t}let p=0;const f="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},g="function"==typeof f.encodeInto?function(e,t){return f.encodeInto(e,t)}:function(e,t){const n=f.encode(e);return t.set(n),{read:e.length,written:n.length}};function m(e,t,n){if(n===undefined){const n=f.encode(e),r=t(n.length,1)>>>0;return o().subarray(r,r+n.length).set(n),p=n.length,r}let r=e.length,s=t(r,1)>>>0;const i=o();let a=0;for(;a<r;a++){const t=e.charCodeAt(a);if(t>127)break;i[s+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),s=n(s,r,r=a+3*e.length,1)>>>0;const t=o().subarray(s+a,s+r);a+=g(e,t).written}return p=a,s}let b=null;function y(){return null!==b&&0!==b.byteLength||(b=new Int32Array(r.memory.buffer)),b}function w(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=w(e[0]));for(let r=1;r<t;r++)n+=", "+w(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}function k(e,t,n){r.wasm_bindgen__convert__closures__invoke1_mut(e,t,d(n))}function _(e,t){r._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__destroy(e,t)}let v=null;function C(e,t){const n=t(4*e.length,4)>>>0,s=(null!==v&&0!==v.byteLength||(v=new Uint32Array(r.memory.buffer)),v);for(let t=0;t<e.length;t++)s[n/4+t]=d(e[t]);return p=e.length,n}function S(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(d(e))}}class T{static __wrap(e){e>>>=0;const t=Object.create(T.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_ppom_free(e)}static new(e,t){const n=C(t,r.__wbindgen_malloc),s=p;return h(r.ppom_new(d(e),n,s))}validateJsonRpc(e){return h(r.ppom_validateJsonRpc(this.__wbg_ptr,d(e)))}static version(){return h(r.ppom_version())}}function E(){const e={wbg:{}};return e.wbg.__wbg_buffer_085ec1f694018c4f=function(e){return d(u(e).buffer)},e.wbg.__wbg_call_01734de55d61e11d=function(){return S((function(e,t,n){return d(u(e).call(u(t),u(n)))}),arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return S((function(e,t,n,r){return d(u(e).call(u(t),u(n),u(r)))}),arguments)},e.wbg.__wbg_from_d7c216d4616bb368=function(e){return d(Array.from(u(e)))},e.wbg.__wbg_get_44be0491f933a435=function(e,t){return d(u(e)[t>>>0])},e.wbg.__wbg_length_72e2208bbc0efc61=function(e){return u(e).length},e.wbg.__wbg_length_d813e535247d427e=function(e){return u(e).length},e.wbg.__wbg_length_fff51ee6522a1a18=function(e){return u(e).length},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var n={a:e,b:t};const s=new Promise(((e,t)=>{const s=n.a;n.a=0;try{return function(e,t,n,s){r.wasm_bindgen__convert__closures__invoke2_mut(e,t,d(n),d(s))}(s,n.b,e,t)}finally{n.a=s}}));return d(s)}finally{n.a=n.b=0}},e.wbg.__wbg_new_8125e318e6245eed=function(e){return d(new Uint8Array(u(e)))},e.wbg.__wbg_parse_670c19d4e984792e=function(){return S((function(e,t){return d(JSON.parse(a(e,t)))}),arguments)},e.wbg.__wbg_ppom_new=function(e){return d(T.__wrap(e))},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){return d(Promise.resolve(u(e)))},e.wbg.__wbg_set_5cf90238115182c3=function(e,t,n){u(e).set(u(t),n>>>0)},e.wbg.__wbg_stringify_e25465938f3f611f=function(){return S((function(e){return d(JSON.stringify(u(e)))}),arguments)},e.wbg.__wbg_then_b2267541e2a73865=function(e,t,n){return d(u(e).then(u(t),u(n)))},e.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){return d(u(e).then(u(t)))},e.wbg.__wbindgen_cb_drop=function(e){const t=h(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbindgen_closure_wrapper_wasm_bindgen__closure__Closure_T___wrap__breaks_if_inlined=function(e,t,n){const r=function(e,t,n,r){const s={a:e,b:t,cnt:1},i=(...e)=>{s.cnt++;const t=s.a;s.a=0;try{return r(t,s.b,...e)}finally{0==--s.cnt?n(t,s.b):s.a=t}};return i.original=s,i}(e,t,_,k);return d(r)},e.wbg.__wbindgen_debug_string=function(e,t){const n=m(w(u(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),s=p;y()[e/4+1]=s,y()[e/4+0]=n},e.wbg.__wbindgen_error_new=function(e,t){return d(new Error(a(e,t)))},e.wbg.__wbindgen_is_undefined=function(e){return u(e)===undefined},e.wbg.__wbindgen_memory=function(){return d(r.memory)},e.wbg.__wbindgen_object_drop_ref=function(e){h(e)},e.wbg.__wbindgen_string_get=function(e,t){const n=u(t),s="string"==typeof n?n:undefined;var i,o=(i=s)===undefined||null===i?0:m(s,r.__wbindgen_malloc,r.__wbindgen_realloc),a=p;y()[e/4+1]=a,y()[e/4+0]=o},e.wbg.__wbindgen_string_new=function(e,t){return d(a(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(a(e,t))},e}function A(e,t){return r=e.exports,M.__wbindgen_wasm_module=t,b=null,v=null,i=null,r.__wbindgen_start(),r}async function M(e){if(r!==undefined)return r;const t=E();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return A(n,s)}n.PPOM=T;n.default=M}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom.js"}],[67,{"../../../../shared/constants/network":4149,"./handlers":71,"@metamask/permission-controller":1484,"@metamask/snaps-rpc-methods":1883,"eth-rpc-errors":2885,lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMethodMiddleware=function(e){const t=u.filter((t=>!Object.hasOwnProperty.call(e,t)));if(t.length>0)throw new Error(`Missing expected hooks:\n\n${t.join("\n")}\n`);return async function(t,n,r,s){if(l.UNSUPPORTED_RPC_METHODS.has(t.method))return s(o.ethErrors.rpc.methodNotSupported());const a=d.get(t.method);if(a){const{implementation:o,hookNames:l}=a;try{return await o(t,n,r,s,(0,i.selectHooks)(e,l))}catch(e){return s(e)}}return r()}};var r,s=e("@metamask/permission-controller"),i=e("@metamask/snaps-rpc-methods"),o=e("eth-rpc-errors"),a=e("lodash"),l=e("../../../../shared/constants/network");const c=[...((r=e("./handlers"))&&r.__esModule?r:{default:r}).default,...s.permissionRpcMethods.handlers],d=c.reduce(((e,t)=>{for(const n of t.methodNames)e.set(n,t);return e}),new Map),u=Array.from(new Set((0,a.flatten)(c.map((({hookNames:e})=>Object.keys(e))))).values())}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[68,{"../../../../../shared/constants/app":4138,"../../../../../shared/constants/metametrics":4148,"../../../../../shared/modules/network.utils":4188,"../../util":92,"@metamask/controller-utils":1081,"eth-rpc-errors":2885,lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),i=e("lodash"),o=e("../../../../../shared/constants/app"),a=e("../../../../../shared/constants/metametrics"),l=e("../../../../../shared/modules/network.utils"),c=e("../../util");const d={methodNames:[o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,n,d,{upsertNetworkConfiguration:u,getCurrentChainId:h,getCurrentRpcUrl:p,findNetworkConfigurationBy:f,setNetworkClientIdForDomain:g,setActiveNetwork:m,requestUserApproval:b,startApprovalFlow:y,endApprovalFlow:w,getProviderConfig:k,hasPermissions:_}){var v;if(null===(v=e.params)||void 0===v||!v[0]||"object"!=typeof e.params[0])return d(s.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:C}=e,{chainId:S,chainName:T=null,blockExplorerUrls:E=null,nativeCurrency:A=null,rpcUrls:M}=e.params[0],P=Object.keys((0,i.omit)(e.params[0],["chainId","chainName","blockExplorerUrls","iconUrls","rpcUrls","nativeCurrency"]));if(P.length>0)return d(s.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${P}`}));function x(e){const t=(0,c.getValidUrl)(e);return null!==t&&("localhost"===t.hostname||"127.0.0.1"===t.hostname||"https:"===t.protocol)}const R=Array.isArray(M)?M.find((e=>x(e))):null,N=null!==E&&Array.isArray(E)?E.find((e=>x(e))):null;if(!R)return d(s.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${M}`}));if(null!==E&&!N)return d(s.ethErrors.rpc.invalidParams({message:`Expected null or array with at least one valid string HTTPS URL 'blockExplorerUrl'. Received: ${E}`}));const I="string"==typeof S&&S.toLowerCase();if(!(0,l.isPrefixedFormattedHexString)(I))return d(s.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${S}`}));if(!(0,l.isSafeChainId)(parseInt(I,16)))return d(s.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${I}": numerical value greater than max safe value. Received:\n${S}`}));const O=f({chainId:I});if(O&&O.rpcUrl===R){t.result=null;const e=h(),n=p();if(e===I&&n===R)return d();try{await b({origin:C,type:r.ApprovalType.SwitchEthereumChain,requestData:{toNetworkConfiguration:O,fromNetworkConfiguration:k()}}),await m(O.id),t.result=null}catch(e){if(e.code!==s.errorCodes.provider.userRejectedRequest)return d(e)}return d()}if("string"!=typeof T||!T)return d(s.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${T}`}));const j=T.length>100?T.substring(0,100):T;if(null!==A){if("object"!=typeof A||Array.isArray(A))return d(s.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${A}`}));if(18!==A.decimals)return d(s.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${A.decimals}`}));if(!A.symbol||"string"!=typeof A.symbol)return d(s.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${A.symbol}`}))}const L=(null==A?void 0:A.symbol)||o.UNKNOWN_TICKER_SYMBOL;if(L!==o.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof L||L.length<2||L.length>6))return d(s.ethErrors.rpc.invalidParams({message:`Expected 2-6 character string 'nativeCurrency.symbol'. Received:\n${L}`}));if(O&&O.chainId===I&&O.ticker!==L)return d(s.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${L}`}));let D;const{id:U}=await y();try{await b({origin:C,type:r.ApprovalType.AddEthereumChain,requestData:{chainId:I,rpcPrefs:{blockExplorerUrl:N},chainName:j,rpcUrl:R,ticker:L}}),D=await u({chainId:I,rpcPrefs:{blockExplorerUrl:N},nickname:j,rpcUrl:R,ticker:L},{source:a.MetaMetricsNetworkEventSource.Dapp,referrer:C}),t.result=null}catch(e){return w({id:U}),d(e)}try{await b({origin:C,type:r.ApprovalType.SwitchEthereumChain,requestData:{toNetworkConfiguration:{rpcUrl:R,chainId:I,nickname:j,ticker:L,networkConfigurationId:D},fromNetworkConfiguration:k()}}),_(e.origin)&&g(e.origin,D)}catch(e){return d(e.code===s.errorCodes.provider.userRejectedRequest?undefined:e)}finally{w({id:U})}try{await m(D)}catch(e){return d(e)}return d()},hookNames:{upsertNetworkConfiguration:!0,getCurrentChainId:!0,getCurrentRpcUrl:!0,findNetworkConfigurationBy:!0,setNetworkClientIdForDomain:!0,setActiveNetwork:!0,requestUserApproval:!0,startApprovalFlow:!0,endApprovalFlow:!0,getProviderConfig:!0,hasPermissions:!0}};n.default=d}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[69,{"../../../../../shared/constants/app":4138},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,n,r,{getAccounts:s}){return t.result=await s(),r()},hookNames:{getAccounts:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.js"}],[7,{"../../../shared/constants/alerts":4137,"@metamask/obs-store":1468},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/obs-store"),s=e("../../../shared/constants/alerts");const i={alertEnabledness:s.TOGGLEABLE_ALERT_TYPES.reduce(((e,t)=>(e[t]=!0,e)),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}};n.default=class{constructor(e={}){const{initState:t={},controllerMessenger:n}=e,s={...i,alertEnabledness:{...i.alertEnabledness,...t.alertEnabledness}};this.store=new r.ObservableStore(s),this.controllerMessenger=n,this.selectedAddress=this.controllerMessenger.call("AccountsController:getSelectedAccount"),this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(e=>{this.store.getState().unconnectedAccountAlertShownOrigins&&this.selectedAddress!==e.address&&(this.selectedAddress=e.address,this.store.updateState({unconnectedAccountAlertShownOrigins:{}}))}))}setAlertEnabledness(e,t){let{alertEnabledness:n}=this.store.getState();n={...n},n[e]=t,this.store.updateState({alertEnabledness:n})}setUnconnectedAccountAlertShown(e){let{unconnectedAccountAlertShownOrigins:t}=this.store.getState();t={...t},t[e]=!0,this.store.updateState({unconnectedAccountAlertShownOrigins:t})}getWeb3ShimUsageState(e){return this.store.getState().web3ShimUsageOrigins[e]}setWeb3ShimUsageRecorded(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.dismissed)}_setWeb3ShimUsageState(e,t){let{web3ShimUsageOrigins:n}=this.store.getState();n={...n},n[e]=t,this.store.updateState({web3ShimUsageOrigins:n})}}}}},{package:"$root$",file:"app/scripts/controllers/alert.js"}],[70,{"../../../../../shared/constants/app":4138},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,n,r,{getProviderState:s}){return t.result={...await s(e.origin)},r()},hookNames:{getProviderState:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.js"}],[71,{"./add-ethereum-chain":68,"./eth-accounts":69,"./get-provider-state":70,"./log-web3-shim-usage":72,"./request-accounts":73,"./send-metadata":74,"./switch-ethereum-chain":75,"./watch-asset":76},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=u(e("./add-ethereum-chain")),s=u(e("./eth-accounts")),i=u(e("./get-provider-state")),o=u(e("./log-web3-shim-usage")),a=u(e("./request-accounts")),l=u(e("./send-metadata")),c=u(e("./switch-ethereum-chain")),d=u(e("./watch-asset"));function u(e){return e&&e.__esModule?e:{default:e}}const h=[r.default,s.default,i.default,o.default,a.default,l.default,c.default,d.default];n.default=h}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.js"}],[72,{"../../../../../shared/constants/app":4138},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,n,r,{getWeb3ShimUsageState:s,setWeb3ShimUsageRecorded:i}){const{origin:o}=e;s(o)===undefined&&i(o);return t.result=!0,r()},hookNames:{getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.js"}],[73,{"../../../../../shared/constants/app":4138,"../../../../../shared/constants/metametrics":4148,"eth-rpc-errors":2885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),i=e("../../../../../shared/constants/metametrics");const o={methodNames:[s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,n,o,{origin:l,getAccounts:c,getUnlockPromise:d,hasPermission:u,requestAccountsPermission:h,sendMetrics:p,getPermissionsForOrigin:f,metamaskState:g}){if(a.has(l))return t.error=r.ethErrors.rpc.resourceUnavailable(`Already processing ${s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),o();if(u(s.MESSAGE_TYPE.ETH_ACCOUNTS)){try{a.add(l),await d(!0),t.result=await c(),o()}catch(e){o(e)}finally{a.delete(l)}return undefined}try{await h()}catch(e){return t.error=e,o()}const m=await c();if(m.length>0){t.result=m;const e=f(l).eth_accounts.caveats[0].value.length,n=!Object.keys(g.permissionHistory).includes(l);p({event:i.MetaMetricsEventName.DappViewed,category:i.MetaMetricsEventCategory.InpageProvider,referrer:{url:l},properties:{is_first_visit:n,number_of_accounts:Object.keys(g.accounts).length,number_of_accounts_connected:e}})}else t.error=r.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return o()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0,sendMetrics:!0,getPermissionsForOrigin:!0,metamaskState:!0}};n.default=o;const a=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.js"}],[74,{"../../../../../shared/constants/app":4138,"eth-rpc-errors":2885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("eth-rpc-errors");const s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,n,s,{addSubjectMetadata:i,subjectType:o}){const{origin:a,params:l}=e;if(!l||"object"!=typeof l||Array.isArray(l))return s(r.ethErrors.rpc.invalidParams({data:l}));{const{icon:e=null,name:t=null,...n}=l;i({...n,iconUrl:e,name:t,subjectType:o,origin:a})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};n.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[75,{"../../../../../shared/constants/app":4138,"../../../../../shared/constants/network":4149,"../../../../../shared/modules/network.utils":4188,"@metamask/controller-utils":1081,"eth-rpc-errors":2885,lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("eth-rpc-errors"),s=e("lodash"),i=e("@metamask/controller-utils"),o=e("../../../../../shared/constants/app"),a=e("../../../../../shared/constants/network"),l=e("../../../../../shared/modules/network.utils");const c={methodNames:[o.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,n,c,{getCurrentChainId:u,findNetworkConfigurationBy:h,findNetworkClientIdByChainId:p,setNetworkClientIdForDomain:f,setProviderType:g,setActiveNetwork:m,requestUserApproval:b,getProviderConfig:y,hasPermissions:w}){var k;if(null===(k=e.params)||void 0===k||!k[0]||"object"!=typeof e.params[0])return c(r.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:_}=e,{chainId:v}=e.params[0],C=Object.keys((0,s.omit)(e.params[0],["chainId"]));if(C.length>0)return c(r.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${C}`}));const S="string"==typeof v&&v.toLowerCase();if(!(0,l.isPrefixedFormattedHexString)(S))return c(r.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${v}`}));if(!(0,l.isSafeChainId)(parseInt(S,16)))return c(r.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${S}": numerical value greater than max safe value. Received:\n${v}`}));const T={toNetworkConfiguration:d(S,h)};if(T.fromNetworkConfiguration=y(),T.toNetworkConfiguration){const n=u(),r=p(S);if(n===S)return w(e.origin)&&f(e.origin,r),t.result=null,c();try{const n=await b({origin:_,type:i.ApprovalType.SwitchEthereumChain,requestData:T});Object.values(a.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(S)?await g(n.type):await m(n.id),w(e.origin)&&f(e.origin,r),t.result=null}catch(e){return c(e)}return c()}return c(r.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${v}". Try adding the chain using ${o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}))},hookNames:{getCurrentChainId:!0,findNetworkConfigurationBy:!0,findNetworkClientIdByChainId:!0,setNetworkClientIdForDomain:!0,setProviderType:!0,setActiveNetwork:!0,requestUserApproval:!0,getNetworkConfigurations:!0,getProviderConfig:!0,hasPermissions:!0}};n.default=c;function d(e,t){return Object.values(a.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(e)?{chainId:e,ticker:a.CURRENCY_SYMBOLS.ETH,nickname:a.NETWORK_TO_NAME_MAP[e],rpcUrl:a.CHAIN_ID_TO_RPC_URL_MAP[e],type:a.CHAIN_ID_TO_TYPE_MAP[e]}:t({chainId:e})}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[76,{"../../../../../shared/constants/app":4138,"@metamask/controller-utils":1081,"eth-rpc-errors":2885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),i=e("../../../../../shared/constants/app");const o={methodNames:[i.MESSAGE_TYPE.WATCH_ASSET,i.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,n,i,{handleWatchAssetRequest:o}){try{const{params:{options:n,type:a},origin:l,networkClientId:c}=e,{tokenId:d}=n;return[r.ERC721,r.ERC1155].includes(a)&&d!==undefined&&"string"!=typeof d?i(s.ethErrors.rpc.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof d}'`})):(await o({asset:n,type:a,origin:l,networkClientId:c}),t.result=!0,i())}catch(e){return i(e)}},hookNames:{handleWatchAssetRequest:!0}};n.default=o}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[77,{"./createMethodMiddleware":67},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./createMethodMiddleware");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[78,{"../util":92,"@segment/loosely-validate-event":2059,buffer:2654,"is-retry-allowed":3295,lodash:3497,"remove-trailing-slash":3902,timers:4029},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t,r){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=c(e("remove-trailing-slash")),i=c(e("@segment/loosely-validate-event")),o=e("lodash"),a=c(e("is-retry-allowed")),l=e("../util");function c(e){return e&&e.__esModule?e:{default:e}}const d=()=>({});n.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,i.default)(e,t)}_message(e,t,n){return this._validate(t,e),this.enqueue(e,t,n),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,n=d){if(!this.enable)return void r(n);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,l.generateRandomId)()),s.anonymousId&&!(0,o.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,o.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:n}),!this.flushed)return this.flushed=!0,void this.flush();const i=this.queue.length>=this.flushAt,a=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(i||a)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=d){if(!this.enable)return r(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return r(e),Promise.resolve();const n=this.queue.splice(0,this.flushAt),s=n.map((e=>e.callback)),i={batch:n.map((e=>e.message)),timestamp:new Date,sentAt:new Date},o={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(i),headers:o},(t=>{r((()=>{s.forEach((e=>e(t,i))),e(t,i)}))}),0)}_retryRequest(e,t,n,r){const s=100*Math.pow(2,r);setTimeout((()=>{this._sendRequest(e,t,n,r+1)}),s)}async _sendRequest(e,t,n,r){return fetch(e,t).then((async s=>{if(s.ok)n();else if(this._isErrorRetryable({response:s})&&r<=this.retryCount)this._retryRequest(e,t,n,r);else{const e=new Error(s.statusText);n(e)}})).catch((s=>{this._isErrorRetryable(s)&&r<=this.retryCount?this._retryRequest(e,t,n,r):n(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,a.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[79,{"../../../../shared/constants/time":4160,"./analytics":78},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.segment=n.createSegmentMock=void 0;var r,s=e("../../../../shared/constants/time"),i=(r=e("./analytics"))&&r.__esModule?r:{default:r};const o="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP",a=undefined,l=5*s.SECOND,c=(e=a)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(n,r=(()=>undefined)){t.queue.push([n,r]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};n.createSegmentMock=c;n.segment=o?new i.default(o,{host:null,flushAt:a,flushInterval:l}):c(a)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[8,{"@metamask/obs-store":1468,events:2956},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=(r=e("events"))&&r.__esModule?r:{default:r},i=e("@metamask/obs-store");function o(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function a(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}const c={currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0};var d=new WeakSet,u=new WeakSet;class h extends s.default{constructor({currentAppVersion:e="",currentMigrationVersion:t=0,state:n={}}){super(),o(this,u),o(this,d),a(this,"store",void 0),this.store=new i.ObservableStore({...c,...n}),l(this,d,p).call(this,e),l(this,u,f).call(this,t)}}function p(e){const t=this.store.getState().currentAppVersion;e!==t&&this.store.updateState({currentAppVersion:e,previousAppVersion:t})}function f(e){const t=this.store.getState().currentMigrationVersion;e!==t&&this.store.updateState({previousMigrationVersion:t,currentMigrationVersion:e})}n.default=h}}},{package:"$root$",file:"app/scripts/controllers/app-metadata.ts"}],[83,{"./snap-keyring":85},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getAccountsBySnapId",{enumerable:!0,get:function(){return r.getAccountsBySnapId}}),Object.defineProperty(n,"snapKeyringBuilder",{enumerable:!0,get:function(){return r.snapKeyringBuilder}});var r=e("./snap-keyring")}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/index.ts"}],[84,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapAndHardwareInfoForMetrics=async function(e,t,n){var r,s,i;if(!n)return{};const o=n.call("AccountsController:getSelectedAccount"),a=o.address,{keyring:l}=o.metadata;let c;var d;null!==(r=o.metadata.snap)&&void 0!==r&&r.id&&(c=n.call("SnapController:get",null===(d=o.metadata.snap)||void 0===d?void 0:d.id));return{account_type:await e(a),device_model:await t(a),account_hardware_type:await async function(){var e;return null!=l&&null!==(e=l.type)&&void 0!==e&&e.includes("Hardware")?l.type:undefined}(),account_snap_type:null===(s=c)||void 0===s?void 0:s.id,account_snap_version:null===(i=c)||void 0===i?void 0:i.version}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/metrics.ts"}],[85,{"../../../../shared/constants/app":4138,"../../../../shared/constants/metametrics":4148,"../../../../ui/components/component-library/icon":4562,"../../translate":218,"./utils/isBlockedUrl":86,"./utils/showResult":87,"@metamask/eth-snap-keyring":1169,"webextension-polyfill":4122},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.snapKeyringBuilder=n.getAccountsBySnapId=void 0;var r,s=e("@metamask/eth-snap-keyring"),i=(r=e("webextension-polyfill"))&&r.__esModule?r:{default:r},o=e("../../../../shared/constants/metametrics"),a=e("../../../../shared/constants/app"),l=e("../../translate"),c=e("../../../../ui/components/component-library/icon"),d=e("./utils/isBlockedUrl"),u=e("./utils/showResult");n.getAccountsBySnapId=async(e,t)=>{const n=await e.getSnapKeyring();return await n.getAccountsBySnapId(t)};n.snapKeyringBuilder=(e,t,n,r,h,p,f)=>{const g=()=>new s.SnapKeyring(t(),{addressExists:async t=>(await e.call("KeyringController:getAccounts")).includes(t.toLowerCase()),redirectUser:async(t,n,r)=>{if(n.length>0||r.length>0){const s=await(0,d.isBlockedUrl)(n,(async()=>await e.call("PhishingController:maybeUpdateState")),(t=>e.call("PhishingController:testOrigin",t))),o=await e.call("ApprovalController:addRequest",{origin:t,requestData:{url:n,message:r,isBlockedUrl:s},type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect},!0);Boolean(o)&&n.length>0?i.default.tabs.create({url:n}):console.log("User refused snap account redirection to:",n)}else console.log("Error occurred when redirecting snap account. url or message must be defined")},saveState:async()=>{await n()},addAccount:async(t,s,i)=>{const d=f(s),{id:h}=e.call("ApprovalController:startFlow"),g=e=>{p({event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:s,snap_name:d}})},m="https://support.metamask.io/hc/en-us/articles/360015289452-How-to-add-accounts-in-your-wallet";let b=!1;try{if(b=Boolean(await e.call("ApprovalController:addRequest",{origin:s,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation},!0)),!b)throw await i(b),new Error("User denied account creation");try{await i(b),await n(),r(t);const a=e.call("AccountsController:getAccountByAddress",t);if(!a)throw new Error(`Internal account not found for address: ${t}`);e.call("AccountsController:setSelectedAccount",a.id),g(o.MetaMetricsEventName.AddSnapAccountSuccessViewed),await(0,u.showSuccess)(e,s,{icon:c.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreated")},{message:(0,l.t)("snapAccountCreatedDescription"),address:t,learnMoreLink:m}),g(o.MetaMetricsEventName.AddSnapAccountSuccessClicked)}catch(t){const n=t.message;throw await(0,u.showError)(e,s,{icon:c.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreationFailed")},{message:(0,l.t)("snapAccountCreationFailedDescription",d),learnMoreLink:m,error:n}),g(o.MetaMetricsEventName.AccountAddFailed),new Error(`Error occurred while creating snap account: ${n}`)}}finally{b&&g(o.MetaMetricsEventName.AccountAdded),e.call("ApprovalController:endFlow",{id:h})}},removeAccount:async(t,r,s)=>{const i=f(r),{id:d}=e.call("ApprovalController:startFlow"),g="https://support.metamask.io/hc/en-us/articles/360057435092-How-to-remove-an-account-from-your-MetaMask-wallet",m=e=>{p({event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:r,snap_name:i}})};let b=!1;try{if(b=Boolean(await e.call("ApprovalController:addRequest",{origin:r,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval,requestData:{publicAddress:t}},!0)),!b)throw await s(b),new Error("User denied account removal");try{await h(t),await s(b),await n(),m(o.MetaMetricsEventName.RemoveSnapAccountSuccessViewed),await(0,u.showError)(e,r,{icon:c.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemoved")},{message:(0,l.t)("snapAccountRemovedDescription"),learnMoreLink:g}),m(o.MetaMetricsEventName.RemoveSnapAccountSuccessClicked)}catch(t){const n=t.message;throw await(0,u.showError)(e,r,{icon:c.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemovalFailed")},{message:(0,l.t)("snapAccountRemovalFailedDescription",i),learnMoreLink:g,error:n}),m(o.MetaMetricsEventName.AccountRemoveFailed),new Error(`Error occurred while removing snap account: ${n}`)}}finally{b&&m(o.MetaMetricsEventName.AccountRemoved),e.call("ApprovalController:endFlow",{id:d})}}});return g.type=s.SnapKeyring.type,g}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/snap-keyring.ts"}],[86,{"../../keyring-snaps-permissions":53},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isBlockedUrl=void 0;var r=e("../../keyring-snaps-permissions");n.isBlockedUrl=async(e,t,n)=>{try{return!(0,r.isProtocolAllowed)(e)||(await t(),n(e).result)}catch(e){return console.error("Invalid URL passed into snap-keyring:",e),!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/isBlockedUrl.ts"}],[87,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showSuccess=n.showError=void 0;const r=e=>({name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:e}});n.showError=(e,t,n,s)=>e.call("ApprovalController:showError",{header:[r(t)],title:n.title,icon:n.icon,error:{key:"snapAccountErrorMessage",name:"SnapAccountErrorMessage",properties:s}});n.showSuccess=(e,t,n,s)=>e.call("ApprovalController:showSuccess",{header:[r(t)],title:n.title,icon:n.icon,message:{key:"snapAccountSuccessMessage",name:"SnapAccountSuccessMessage",properties:s}})}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/showResult.ts"}],[89,{"../../../../shared/constants/app":4138,"../../../../shared/constants/gas":4143,"../../../../shared/constants/metametrics":4148,"../../../../shared/constants/transaction":4162,"../../../../shared/lib/transactions-controller-utils":4171,"../../../../shared/modules/conversion.utils":4177,"../../../../shared/modules/metametrics":4186,"../../../../shared/modules/transaction.utils":4199,"../../../../ui/helpers/utils/metrics":4966,"../snap-keyring/metrics":84,"@metamask/eth-query":1156,"@metamask/transaction-controller":1955,"bignumber.js":2559,"ethereumjs-util":2916},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handleTransactionSubmitted=n.handleTransactionRejected=n.handleTransactionFailed=n.handleTransactionDropped=n.handleTransactionConfirmed=n.handleTransactionApproved=n.handleTransactionAdded=n.handlePostTransactionBalanceUpdate=n.createTransactionEventFragmentWithTxId=n.METRICS_STATUS_FAILED=void 0;var r,s=e("ethereumjs-util"),i=(r=e("@metamask/eth-query"))&&r.__esModule?r:{default:r},o=e("bignumber.js"),a=e("@metamask/transaction-controller"),l=e("../../../../shared/constants/app"),c=e("../../../../shared/modules/transaction.utils"),d=e("../../../../shared/modules/conversion.utils"),u=e("../../../../shared/constants/transaction"),h=e("../../../../shared/constants/metametrics"),p=e("../../../../shared/constants/gas"),f=e("../../../../shared/lib/transactions-controller-utils"),g=e("../../../../ui/helpers/utils/metrics"),m=e("../../../../shared/modules/metametrics"),b=e("../snap-keyring/metrics");const y=n.METRICS_STATUS_FAILED="failed on-chain";n.handleTransactionAdded=async(e,t)=>{if(!t.transactionMeta)return;const{properties:n,sensitiveProperties:r}=await v({transactionEventPayload:t,transactionMetricsRequest:e});w({eventName:u.TransactionMetaMetricsEvent.added,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:n,sensitiveProperties:r}})};n.handleTransactionApproved=async(e,t)=>{t.transactionMeta&&await k({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionFailed=async(e,t)=>{if(!t.transactionMeta)return;const n={};t.error&&(n.error=t.error),await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:n,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionConfirmed=async(e,t)=>{if(0===Object.keys(t).length)return;const n={},r={...t},{txReceipt:s}=r;n.gas_used=null==s?void 0:s.gasUsed;const{submittedTime:i}=r;i&&(n.completion_time=function(e){return Math.round((Date.now()-e)/1e3).toString()}(i)),"0x0"===(null==s?void 0:s.status)&&(n.status=y),await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:n,transactionEventPayload:{actionId:r.actionId,transactionMeta:r},transactionMetricsRequest:e})};n.handleTransactionDropped=async(e,t)=>{if(!t.transactionMeta)return;await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:{dropped:!0},transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionRejected=async(e,t)=>{t.transactionMeta&&await k({eventName:u.TransactionMetaMetricsEvent.rejected,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionSubmitted=async(e,t)=>{if(!t.transactionMeta)return;const{properties:n,sensitiveProperties:r}=await v({transactionEventPayload:t,transactionMetricsRequest:e});w({eventName:u.TransactionMetaMetricsEvent.submitted,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:n,sensitiveProperties:r}})};n.createTransactionEventFragmentWithTxId=async(e,{transactionId:t,actionId:n})=>{const r={...e.getTransaction(t),actionId:n},{properties:s,sensitiveProperties:i}=await v({transactionEventPayload:{transactionMeta:r},transactionMetricsRequest:e});w({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:{actionId:r.actionId,transactionMeta:r},transactionMetricsRequest:e,payload:{properties:s,sensitiveProperties:i}})};function w({eventName:e,transactionEventPayload:{transactionMeta:t,actionId:n},transactionMetricsRequest:r,payload:s}){if(function(e,t,n){const r=_(t,n.id);return void 0!==e(r)}(r.getEventFragmentById,e,t))return;const i=_(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.added:r.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.added,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:r.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.submitted:r.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.submitted,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.finalized:r.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0})}}async function k({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,extraParams:r={}}){const{properties:s,sensitiveProperties:i}=await v({transactionEventPayload:t,transactionMetricsRequest:n,extraParams:r});w({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionEventPayload:{transactionMeta:t},transactionMetricsRequest:n,payload:r}){const s=_(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:case u.TransactionMetaMetricsEvent.finalized:n.updateEventFragment(s,{properties:r.properties,sensitiveProperties:r.sensitiveProperties})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionMetricsRequest:t,transactionEventPayload:{transactionMeta:n}}){const r=_(e,n.id);switch(e){case u.TransactionMetaMetricsEvent.approved:t.finalizeEventFragment(r);break;case u.TransactionMetaMetricsEvent.rejected:t.finalizeEventFragment(r,{abandoned:!0});break;case u.TransactionMetaMetricsEvent.finalized:t.finalizeEventFragment(r)}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n})}function _(e,t){return`transaction-${e===u.TransactionMetaMetricsEvent.finalized||e===u.TransactionMetaMetricsEvent.submitted?"submitted":"added"}-${t}`}async function v({transactionEventPayload:{transactionMeta:e},transactionMetricsRequest:t,extraParams:n={}}){var r;const{type:y,time:w,status:k,chainId:_,origin:v,txParams:{gasPrice:C,gas:S,maxFeePerGas:T,maxPriorityFeePerGas:E,estimateSuggested:A,estimateUsed:M},defaultGasEstimates:P,originalType:x,replacedById:R,customTokenAmount:N,dappProposedTokenAmount:I,currentTokenBalance:O,originalApprovalAmount:j,finalApprovalAmount:L,contractMethodName:D,securityProviderResponse:U,simulationFails:F}=e,q=new i.default(t.provider),B=v===l.ORIGIN_METAMASK?"user":"dapp",{assetType:K,tokenStandard:$}=await(0,c.determineTransactionAssetType)(e,q,t.getTokenStandardAndDetails),H={};if((0,c.isEIP1559Transaction)(e)?(H.max_fee_per_gas=T,H.max_priority_fee_per_gas=E):H.gas_price=C,P){var W,G;const{estimateType:n}=P;if(n){var z,V;H.default_estimate=n;let r=null===(z=e.defaultGasEstimates)||void 0===z?void 0:z.maxFeePerGas,s=null===(V=e.defaultGasEstimates)||void 0===V?void 0:V.maxPriorityFeePerGas;if([p.GasRecommendations.low,p.GasRecommendations.medium,p.GasRecommendations.high].includes(n)){var Y,Q;const{gasFeeEstimates:e}=await t.getEIP1559GasFeeEstimates();var J,X;if(null!=e&&null!==(Y=e[n])&&void 0!==Y&&Y.suggestedMaxFeePerGas)r=null===(J=e[n])||void 0===J?void 0:J.suggestedMaxFeePerGas,H.default_max_fee_per_gas=r;if(null!=e&&null!==(Q=e[n])&&void 0!==Q&&Q.suggestedMaxPriorityFeePerGas)s=null===(X=e[n])||void 0===X?void 0:X.suggestedMaxPriorityFeePerGas,H.default_max_priority_fee_per_gas=s}}null!==(W=e.defaultGasEstimates)&&void 0!==W&&W.gas&&(H.default_gas=e.defaultGasEstimates.gas),null!==(G=e.defaultGasEstimates)&&void 0!==G&&G.gasPrice&&(H.default_gas_price=e.defaultGasEstimates.gasPrice)}A&&(H.estimate_suggested=A),M&&(H.estimate_used=M),null!=n&&n.gas_used&&(H.gas_used=n.gas_used);const Z=function(e){const t={};for(const n in e)(0,s.isHexString)(e[n])?t[n]=(0,d.hexWEIToDecGWEI)(e[n]):t[n]=e[n];return t}(H);let ee="0";e.txParams.maxFeePerGas&&(ee="2");const te=y&&[a.TransactionType.contractInteraction,a.TransactionType.tokenMethodApprove,a.TransactionType.tokenMethodIncreaseAllowance,a.TransactionType.tokenMethodSafeTransferFrom,a.TransactionType.tokenMethodSetApprovalForAll,a.TransactionType.tokenMethodTransfer,a.TransactionType.tokenMethodTransferFrom,a.TransactionType.swap,a.TransactionType.swapApproval].includes(y),ne="Approve";let re,se,ie,oe,ae=a.TransactionType.simpleSend;y===a.TransactionType.cancel?ae=a.TransactionType.cancel:y===a.TransactionType.retry&&x?ae=x:y===a.TransactionType.deployContract?ae=a.TransactionType.deployContract:te&&(ae=a.TransactionType.contractInteraction,se=D,se===ne&&$===u.TokenStandard.ERC20&&("0"===I||"0"===N?re=u.TransactionApprovalAmountType.revoke:N&&N!==I?re=u.TransactionApprovalAmountType.custom:I&&(re=u.TransactionApprovalAmountType.dappProposed),ie=function(e,t,n){if(e===u.TransactionApprovalAmountType.custom&&t&&n)return`${new o.BigNumber(t,10).div(n,10).times(100).round(2)}`;return null}(re,j,L),oe=function(e,t,n){if((e===u.TransactionApprovalAmountType.custom||e===u.TransactionApprovalAmountType.dappProposed)&&t&&n)return`${new o.BigNumber(t,16).div(n,10).times(100).round(2)}`;return null}(re,I,O)));const le=t.getTransaction(R),ce={RETRY:a.TransactionType.retry,CANCEL:a.TransactionType.cancel,SAME_NONCE:"other"};let de;null!=n&&n.dropped&&(de=ce.SAME_NONCE,(null==le?void 0:le.type)===a.TransactionType.cancel?de=ce.CANCEL:(null==le?void 0:le.type)===a.TransactionType.retry&&(de=ce.RETRY));const ue=[];1===(null==U?void 0:U.flagAsDangerous)?ue.push(h.MetaMetricsEventUiCustomization.FlaggedAsMalicious):2===(null==U?void 0:U.flagAsDangerous)&&ue.push(h.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown);const he=(0,g.getBlockaidMetricsProps)(e);(null==he||null===(r=he.ui_customizations)||void 0===r?void 0:r.length)>0&&ue.push(...he.ui_customizations),F&&ue.push(h.MetaMetricsEventUiCustomization.GasEstimationFailed);const pe=(0,m.getSmartTransactionMetricsProperties)(t,e);let fe={chain_id:_,referrer:v,source:B,status:k,network:`${parseInt(_,16)}`,eip_1559_version:ee,gas_edit_type:"none",gas_edit_attempted:"none",gas_estimation_failed:Boolean(F),account_type:await t.getAccountType(t.getSelectedAddress()),device_model:await t.getDeviceModel(t.getSelectedAddress()),asset_type:K,token_standard:$,transaction_type:ae,transaction_speed_up:y===a.TransactionType.retry,...he,ui_customizations:ue.length>0?ue:null,...pe};const ge=await(0,b.getSnapAndHardwareInfoForMetrics)(t.getAccountType,t.getDeviceModel,t.snapAndHardwareMessenger);Object.assign(fe,ge),se===ne&&(fe={...fe,transaction_approval_amount_type:re});let me={transaction_envelope_type:(0,c.isEIP1559Transaction)(e)?f.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:f.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:w,gas_limit:S,transaction_contract_method:se,transaction_replaced:de,...n,...Z};return se===ne&&(me={...me,transaction_approval_amount_vs_balance_ratio:oe,transaction_approval_amount_vs_proposed_ratio:ie}),{properties:fe,sensitiveProperties:me}}n.handlePostTransactionBalanceUpdate=async({getParticipateInMetrics:e,trackEvent:t},{transactionMeta:n,approvalTransactionMeta:r})=>{var s;if(e()&&n.swapMetaData)if("0x0"===(null===(s=n.txReceipt)||void 0===s?void 0:s.status))t({event:"Swap Failed",sensitiveProperties:{...n.swapMetaData},category:h.MetaMetricsEventCategory.Swaps});else{var i;const e=(0,f.getSwapsTokensReceivedFromTxMeta)(n.destinationTokenSymbol,n,n.destinationTokenAddress,n.txParams.from,n.destinationTokenDecimals,r,n.chainId),s=e?`${new o.BigNumber(e,10).div(n.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,a=null!==(i=n.txReceipt)&&void 0!==i&&i.gasUsed&&n.swapMetaData.estimated_gas?`${new o.BigNumber(n.txReceipt.gasUsed,16).div(n.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,l=function(e,t){var n,r;let s="0x0";null!=t&&t.txReceipt&&(s=(0,f.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const i=(0,f.calcGasTotal)(null===(n=e.txReceipt)||void 0===n?void 0:n.gasUsed,null===(r=e.txReceipt)||void 0===r?void 0:r.effectiveGasPrice),a=new o.BigNumber(i,16).plus(s,16).toString(16);return{approvalGasCostInEth:Number((0,d.hexWEIToDecETH)(s)),tradeGasCostInEth:Number((0,d.hexWEIToDecETH)(i)),tradeAndApprovalGasCostInEth:Number((0,d.hexWEIToDecETH)(a))}}(n,r);t({event:h.MetaMetricsEventName.SwapCompleted,category:h.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...n.swapMetaData,token_to_amount_received:e,quote_vs_executionRatio:s,estimated_vs_used_gasRatio:a,approval_gas_cost_in_eth:l.approvalGasCostInEth,trade_gas_cost_in_eth:l.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:l.tradeAndApprovalGasCostInEth,token_to_amount:n.swapMetaData.token_to_amount.toString(10)}})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/metrics.ts"}],[9,{"../../../shared/constants/alarms":4136,"../../../shared/constants/app":4138,"../../../shared/constants/preferences":4154,"../../../shared/constants/time":4160,"../../../shared/modules/mv3.utils":4187,"../../../ui/helpers/utils/build-types":4956,"../metamask-controller":93,"@metamask/controller-utils":1081,"@metamask/obs-store":1468,events:2956,loglevel:3503,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=g(e("events")),s=e("@metamask/obs-store"),i=e("uuid"),o=g(e("loglevel")),a=e("@metamask/controller-utils"),l=e("../metamask-controller"),c=e("../../../shared/constants/time"),d=e("../../../shared/constants/alarms"),u=e("../../../shared/modules/mv3.utils"),h=e("../../../ui/helpers/utils/build-types"),p=e("../../../shared/constants/app"),f=e("../../../shared/constants/preferences");function g(e){return e&&e.__esModule?e:{default:e}}class m extends r.default{constructor(e={}){const{addUnlockListener:t,isUnlocked:n,initState:r,onInactiveTimeout:i,preferencesStore:o,messenger:a,extension:l}=e;super(),this.extension=l,this.onInactiveTimeout=i||(()=>undefined),this.store=new s.ObservableStore({timeoutMinutes:f.DEFAULT_AUTO_LOCK_TIME_LIMIT,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),outdatedBrowserWarningLastShown:(new Date).getTime(),nftsDetectionNoticeDismissed:!1,showTestnetMessageInDropdown:!0,showBetaHeader:(0,h.isBeta)(),showPermissionsTour:!0,showProductTour:!0,showNetworkBanner:!0,showAccountBanner:!0,trezorModel:null,currentPopupId:undefined,hadAdvancedGasFeesSetPriorToMigration92_3:!1,...r,qrHardware:{},nftsDropdownState:{},usedNetworks:{"0x1":!0,"0x5":!0,"0x539":!0},surveyLinkLastClickedOrClosed:null,signatureSecurityAlertResponses:{},switchedNetworkDetails:null,switchedNetworkNeverShowMessage:!1,currentExtensionPopupId:0}),this.timer=null,this.isUnlocked=n,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),o.subscribe((({preferences:e})=>{this.store.getState().timeoutMinutes!==e.autoLockTimeLimit&&this._setInactiveTimeout(e.autoLockTimeLimit)})),a.subscribe("KeyringController:qrKeyringStateChange",(e=>this.store.updateState({qrHardware:e})));const{preferences:c}=o.getState();this._setInactiveTimeout(c.autoLockTimeLimit),this.messagingSystem=a,this._approvalRequestId=null}getUnlockPromise(e){return new Promise((t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)}))}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE),t&&this._requestApproval()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}this._acceptApproval()}setDefaultHomeActiveTabName(e){this.store.updateState({defaultHomeActiveTabName:e})}setConnectedStatusPopoverHasBeenShown(){this.store.updateState({connectedStatusPopoverHasBeenShown:!0})}setRecoveryPhraseReminderHasBeenShown(){this.store.updateState({recoveryPhraseReminderHasBeenShown:!0})}setSurveyLinkLastClickedOrClosed(e){this.store.updateState({surveyLinkLastClickedOrClosed:e})}setRecoveryPhraseReminderLastShown(e){this.store.updateState({recoveryPhraseReminderLastShown:e})}setTermsOfUseLastAgreed(e){this.store.updateState({termsOfUseLastAgreed:e})}setSnapsInstallPrivacyWarningShownStatus(e){this.store.updateState({snapsInstallPrivacyWarningShown:e})}setOutdatedBrowserWarningLastShown(e){this.store.updateState({outdatedBrowserWarningLastShown:e})}setLastActiveTime(){this._resetTimer()}_setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this._resetTimer()}_resetTimer(){const{timeoutMinutes:e}=this.store.getState();this.timer?clearTimeout(this.timer):u.isManifestV3&&this.extension.alarms.clear(d.AUTO_LOCK_TIMEOUT_ALARM),e&&(u.isManifestV3?(this.extension.alarms.create(d.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:e,periodInMinutes:e}),this.extension.alarms.onAlarm.addListener((e=>{e.name===d.AUTO_LOCK_TIMEOUT_ALARM&&(this.onInactiveTimeout(),this.extension.alarms.clear(d.AUTO_LOCK_TIMEOUT_ALARM))}))):this.timer=setTimeout((()=>this.onInactiveTimeout()),e*c.MINUTE))}setBrowserEnvironment(e,t){this.store.updateState({browserEnvironment:{os:e,browser:t}})}addPollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const n=this.store.getState()[t];this.store.updateState({[t]:[...n,e]})}}removePollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const n=this.store.getState()[t];this.store.updateState({[t]:n.filter((t=>t!==e))})}}clearPollingTokens(){this.store.updateState({popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[]})}setShowTestnetMessageInDropdown(e){this.store.updateState({showTestnetMessageInDropdown:e})}setShowBetaHeader(e){this.store.updateState({showBetaHeader:e})}setShowPermissionsTour(e){this.store.updateState({showPermissionsTour:e})}setShowProductTour(e){this.store.updateState({showProductTour:e})}setShowNetworkBanner(e){this.store.updateState({showNetworkBanner:e})}setShowAccountBanner(e){this.store.updateState({showAccountBanner:e})}setCurrentExtensionPopupId(e){this.store.updateState({currentExtensionPopupId:e})}setSwitchedNetworkDetails(e){this.store.updateState({switchedNetworkDetails:e})}clearSwitchedNetworkDetails(){this.store.updateState({switchedNetworkDetails:null})}setSwitchedNetworkNeverShowMessage(e){this.store.updateState({switchedNetworkDetails:null,switchedNetworkNeverShowMessage:e})}setTrezorModel(e){this.store.updateState({trezorModel:e})}updateNftDropDownState(e){this.store.updateState({nftsDropdownState:e})}setFirstTimeUsedNetwork(e){const t=this.store.getState(),{usedNetworks:n}=t;n[e]=!0,this.store.updateState({usedNetworks:n})}getSignatureSecurityAlertResponse(e){return this.store.getState().signatureSecurityAlertResponses[e]}addSignatureSecurityAlertResponse(e){const t=this.store.getState(),{signatureSecurityAlertResponses:n}=t;this.store.updateState({signatureSecurityAlertResponses:{...n,[e.securityAlertId]:e}})}setCurrentPopupId(e){this.store.updateState({currentPopupId:e})}getCurrentPopupId(){return this.store.getState().currentPopupId}_requestApproval(){this._approvalRequestId||(this._approvalRequestId=(0,i.v4)(),this.messagingSystem.call("ApprovalController:addRequest",{id:this._approvalRequestId,origin:p.ORIGIN_METAMASK,type:a.ApprovalType.Unlock},!0).catch((()=>{this._approvalRequestId=null})))}_acceptApproval(){if(this._approvalRequestId){try{this.messagingSystem.call("ApprovalController:acceptRequest",this._approvalRequestId)}catch(e){o.default.error("Failed to unlock approval request",e)}this._approvalRequestId=null}}}n.default=m}}},{package:"$root$",file:"app/scripts/controllers/app-state.js"}],[90,{"../../../../shared/constants/app":4138,"../../../../shared/constants/smartTransactions":4156,"../../../../shared/modules/conversion.utils":4177,"@metamask/smart-transactions-controller/dist/types":1615,loglevel:3503},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.submitSmartTransactionHook=void 0;var r,s=e("@metamask/smart-transactions-controller/dist/types"),i=(r=e("loglevel"))&&r.__esModule?r:{default:r},o=e("../../../../shared/modules/conversion.utils"),a=e("../../../../shared/constants/smartTransactions"),l=e("../../../../shared/constants/app");function c(e,t){u(e,t),t.add(e)}function d(e,t,n){u(e,t),t.set(e,n)}function u(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function p(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,g(e,t,"get"))}function f(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,g(e,t,"set"),n),n}function g(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var m=new WeakMap,b=new WeakMap,y=new WeakMap,w=new WeakMap,k=new WeakMap,_=new WeakMap,v=new WeakMap,C=new WeakMap,S=new WeakMap,T=new WeakMap,E=new WeakMap,A=new WeakSet,M=new WeakSet,P=new WeakSet,x=new WeakSet,R=new WeakSet,N=new WeakSet,I=new WeakSet,O=new WeakSet;class j{constructor(e){c(this,O),c(this,I),c(this,N),c(this,R),c(this,x),c(this,P),c(this,M),c(this,A),d(this,m,{writable:!0,value:void 0}),d(this,b,{writable:!0,value:void 0}),d(this,y,{writable:!0,value:void 0}),d(this,w,{writable:!0,value:void 0}),d(this,k,{writable:!0,value:void 0}),d(this,_,{writable:!0,value:void 0}),d(this,v,{writable:!0,value:void 0}),d(this,C,{writable:!0,value:void 0}),d(this,S,{writable:!0,value:void 0}),d(this,T,{writable:!0,value:void 0}),d(this,E,{writable:!0,value:void 0});const{transactionMeta:t,smartTransactionsController:n,transactionController:r,isSmartTransaction:s,controllerMessenger:i,featureFlags:o}=e;f(this,b,""),f(this,m,!1),f(this,T,t),f(this,C,n),f(this,S,r),f(this,v,s),f(this,w,i),f(this,k,o),f(this,_,t.origin!==l.ORIGIN_METAMASK),f(this,y,t.chainId),f(this,E,t.txParams)}async submit(){const e={transactionHash:undefined};if(!p(this,v))return e;const{id:t}=await p(this,w).call("ApprovalController:startFlow");let n;f(this,b,t);try{n=await p(this,C).getFees({...p(this,E),chainId:p(this,y)},undefined)}catch(t){return i.default.error("Error in smart transaction publish hook, falling back to regular transaction submission",t),h(this,A,L).call(this),e}try{var r;const e=await h(this,N,B).call(this,{getFeesResponse:n}),t=null==e?void 0:e.uuid;if(!t)throw new Error("No smart transaction UUID");const s=null===(r=p(this,k))||void 0===r||null===(r=r.smartTransactions)||void 0===r?void 0:r.returnTxHashAsap;let i;if(h(this,M,D).call(this,{uuid:t}),h(this,x,F).call(this,{uuid:t}),i=s&&null!=e&&e.txHash?e.txHash:await h(this,R,q).call(this,{uuid:t}),null===i)throw new Error("Transaction does not have a transaction hash, there was a problem");return{transactionHash:i}}catch(e){throw i.default.error("Error in smart transaction publish hook",e),h(this,A,L).call(this),e}}}function L(){p(this,m)||(f(this,m,!0),p(this,w).call("ApprovalController:endFlow",{id:p(this,b)}))}function D({uuid:e}){const t=()=>{h(this,A,L).call(this)};p(this,w).call("ApprovalController:addRequest",{id:p(this,b),origin:origin,type:l.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage,requestState:{smartTransaction:{status:s.SmartTransactionStatuses.PENDING,creationTime:Date.now(),uuid:e},isDapp:p(this,_),txId:p(this,T).id}},!0).then(t,t)}async function U({smartTransaction:e}){return await p(this,w).call("ApprovalController:updateRequestState",{id:p(this,b),requestState:{smartTransaction:e,isDapp:p(this,_),txId:p(this,T).id}})}async function F({uuid:e}){p(this,C).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:t}=e;t&&t!==s.SmartTransactionStatuses.PENDING&&(p(this,m)||await h(this,P,U).call(this,{smartTransaction:e}))}))}function q({uuid:e}){return new Promise((t=>{p(this,C).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:n,statusMetadata:r}=e;n&&n!==s.SmartTransactionStatuses.PENDING&&(i.default.debug("Smart Transaction: ",e),null!=r&&r.minedHash?(i.default.debug("Smart Transaction - Received tx hash: ",null==r?void 0:r.minedHash),t(r.minedHash)):t(null))}))}))}async function B({getFeesResponse:e}){var t,n;const r=await h(this,O,$).call(this,(null===(t=e.tradeTxFees)||void 0===t?void 0:t.fees)??[],!1),s=await h(this,O,$).call(this,(null===(n=e.tradeTxFees)||void 0===n?void 0:n.cancelFees)||[],!0);return await p(this,C).submitSignedTransactions({signedTransactions:r,signedCanceledTransactions:s,txParams:p(this,E),transactionMeta:p(this,T)})}function K(e,t){const n={...p(this,E),maxFeePerGas:`0x${(0,o.decimalToHex)(e.maxFeePerGas)}`,maxPriorityFeePerGas:`0x${(0,o.decimalToHex)(e.maxPriorityFeePerGas)}`,gas:t?`0x${(0,o.decimalToHex)(a.CANCEL_GAS_LIMIT_DEC)}`:p(this,E).gas};return t&&(n.to=n.from,n.data="0x"),n}async function $(e,t){const n=e.map((e=>h(this,I,K).call(this,e,t))).map((e=>({...e,chainId:e.chainId||p(this,y)})));return await p(this,S).approveTransactionsWithSameNonce(n,{hasNonce:!0})}n.submitSmartTransactionHook=e=>new j(e).submit()}}},{package:"$root$",file:"app/scripts/lib/transaction/smart-transactions.ts"}],[91,{"../../../../shared/constants/security-provider":4155,"../ppom/ppom-middleware":64,"../ppom/ppom-util":65,"@metamask/keyring-api":1318,"@metamask/transaction-controller":1955,"@sentry/browser":2092,"ethereumjs-util":2916,uuid:4087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addDappTransaction=async function(e){const{dappRequest:t}=e,{id:n,method:r,origin:s}=t,{securityAlertResponse:i}=t,o={actionId:n,method:r,origin:s,requireApproval:!0,securityAlertResponse:i},{waitForHash:a}=await h({...e,transactionOptions:o});return await a()},n.addTransaction=async function(e,t){const{transactionParams:n,transactionOptions:r,ppomController:s,securityAlertsEnabled:o,chainId:p}=e,f=r.type&&u.includes(r.type);if(o&&l.SUPPORTED_CHAIN_IDS.includes(p)&&!f)try{const o=(0,d.normalizePPOMRequest)({method:"eth_sendTransaction",id:"actionId"in r?r.actionId:"",origin:"origin"in r?r.origin:"",params:[{from:n.from,to:n.to,value:n.value,data:n.data}]}),l=(0,a.v4)();s.usePPOM((async e=>{try{return await e.validateJsonRpc(o)}catch(e){(0,i.captureException)(e);const t=e;console.error("Error validating JSON RPC using PPOM: ",e);return{securityAlertId:l,result_type:c.BlockaidResultType.Errored,reason:c.BlockaidReason.errored,description:`${t.name}: ${t.message}`}}})).then((n=>{null==t||t(e.transactionOptions,{...n,securityAlertId:l})})),e.transactionOptions.securityAlertResponse={reason:c.BlockaidResultType.Loading,result_type:c.BlockaidReason.inProgress,securityAlertId:l}}catch(e){console.error("Error validating JSON RPC using PPOM: ",e),(0,i.captureException)(e)}const{transactionMeta:g,waitForHash:m}=await h(e);if(!e.waitForSubmit)return m().catch((()=>{})),g;const b=await m();return function(e,t){return t.state.transactions.find((t=>t.hash===e))}(b,e.transactionController)};var r=e("@metamask/keyring-api"),s=e("@metamask/transaction-controller"),i=e("@sentry/browser"),o=e("ethereumjs-util"),a=e("uuid"),l=e("../ppom/ppom-middleware"),c=e("../../../../shared/constants/security-provider"),d=e("../ppom/ppom-util");const u=[s.TransactionType.swap,s.TransactionType.swapApproval];async function h(e){const{selectedAccount:t}=e;return t.type===r.EthAccountType.Erc4337?async function(e){var t;const{networkClientId:n,transactionController:r,transactionOptions:s,transactionParams:i,userOperationController:a}=e,{maxFeePerGas:l,maxPriorityFeePerGas:c}=i,{origin:d,requireApproval:u,type:h}=s,f={...i,maxFeePerGas:(0,o.addHexPrefix)(l),maxPriorityFeePerGas:(0,o.addHexPrefix)(c)},g=null==s||null===(t=s.swaps)||void 0===t?void 0:t.meta;null!=g&&g.type&&delete g.type;const m={networkClientId:n,origin:d,requireApproval:u,swaps:g,type:h},b=await a.addUserOperationFromTransaction(f,m);a.startPollingByNetworkClientId(n);return{transactionMeta:p(b.id,r),waitForHash:b.transactionHash}}(e):async function(e){const{transactionController:t,transactionOptions:n,transactionParams:r,networkClientId:s}=e,{result:i,transactionMeta:o}=await t.addTransaction(r,{...n});return{transactionMeta:o,waitForHash:()=>i}}(e)}function p(e,t){return t.state.transactions.find((t=>t.id===e))}}}},{package:"$root$",file:"app/scripts/lib/transaction/util.ts"}],[93,{"../../shared/constants/app":4138,"../../shared/constants/hardware-wallets":4144,"../../shared/constants/keyring":4145,"../../shared/constants/logs":4147,"../../shared/constants/metametrics":4148,"../../shared/constants/network":4149,"../../shared/constants/permissions":4153,"../../shared/constants/smartTransactions":4156,"../../shared/constants/swaps":4158,"../../shared/constants/time":4160,"../../shared/constants/tokens":4161,"../../shared/constants/transaction":4162,"../../shared/lib/metamask-controller-utils":4166,"../../shared/lib/token-util":4170,"../../shared/modules/mv3.utils":4187,"../../shared/modules/network.utils":4188,"../../shared/modules/selectors":4194,"../../shared/modules/string-utils":4197,"../../shared/modules/transaction.utils":4199,"../../shared/notifications":4201,"./controllers/account-order":6,"./controllers/alert":7,"./controllers/app-metadata":8,"./controllers/app-state":9,"./controllers/authentication/authentication-controller":11,"./controllers/decrypt-message":13,"./controllers/encryption-public-key":14,"./controllers/metametrics":15,"./controllers/network-order":16,"./controllers/onboarding":17,"./controllers/permissions":21,"./controllers/preferences":24,"./controllers/swaps":25,"./detect-multiple-instances":26,"./lib/AccountIdentitiesPetnamesBridge":29,"./lib/AddressBookPetnamesBridge":30,"./lib/ComposableObservableStore":31,"./lib/SnapsNameProvider":32,"./lib/account-tracker":33,"./lib/backup":34,"./lib/createDupeReqFilterMiddleware":35,"./lib/createLoggerMiddleware":36,"./lib/createMetaRPCHandler":37,"./lib/createMetamaskMiddleware":38,"./lib/createOnboardingMiddleware":39,"./lib/createOriginMiddleware":40,"./lib/createRPCMethodTrackingMiddleware":41,"./lib/createTabIdMiddleware":43,"./lib/encryptor-factory":44,"./lib/hardware-keyring-builder-factory":52,"./lib/keyring-snaps-permissions":53,"./lib/offscreen-bridge/lattice-offscreen-keyring":60,"./lib/offscreen-bridge/ledger-offscreen-bridge":61,"./lib/offscreen-bridge/trezor-offscreen-bridge":62,"./lib/ppom/indexed-db-backend":63,"./lib/ppom/ppom":66,"./lib/ppom/ppom-middleware":64,"./lib/rpc-method-middleware":77,"./lib/segment":79,"./lib/snap-keyring":83,"./lib/stream-utils":88,"./lib/transaction/metrics":89,"./lib/transaction/smart-transactions":90,"./lib/transaction/util":91,"./lib/util":92,"./snaps/preinstalled-snaps":217,"./translate":218,"@keystonehq/metamask-airgapped-keyring":554,"@metamask/accounts-controller":1011,"@metamask/address-book-controller":1014,"@metamask/announcement-controller":1022,"@metamask/approval-controller":1025,"@metamask/assets-controllers":1050,"@metamask/base-controller":1072,"@metamask/controller-utils":1081,"@metamask/ens-controller":1086,"@metamask/eth-json-rpc-filters":1099,"@metamask/eth-json-rpc-filters/subscriptionManager":1102,"@metamask/eth-json-rpc-middleware":1114,"@metamask/eth-keyring-controller":1129,"@metamask/eth-ledger-bridge-keyring":1152,"@metamask/eth-query":1156,"@metamask/eth-trezor-keyring":1214,"@metamask/ethjs-query":1231,"@metamask/gas-fee-controller":1245,"@metamask/keyring-controller":1348,"@metamask/logging-controller":1350,"@metamask/name-controller":1385,"@metamask/network-controller":1400,"@metamask/notification-controller":1420,"@metamask/obs-store":1468,"@metamask/obs-store/dist/asStream":1467,"@metamask/permission-controller":1484,"@metamask/permission-log-controller":1503,"@metamask/phishing-controller":1505,"@metamask/ppom-validator":1545,"@metamask/queued-request-controller":1562,"@metamask/rate-limit-controller":1578,"@metamask/scure-bip39/dist/wordlists/english":1590,"@metamask/selected-network-controller":1602,"@metamask/signature-controller":1604,"@metamask/smart-transactions-controller":1614,"@metamask/snaps-controllers":1802,"@metamask/snaps-rpc-methods":1883,"@metamask/snaps-utils":1920,"@metamask/transaction-controller":1955,"@metamask/user-operation-controller":1974,"@sentry/browser":2092,_process:3648,"await-semaphore":2548,buffer:2654,"eth-lattice-keyring":2854,"eth-rpc-errors":2885,events:2956,"json-rpc-engine":3316,"json-rpc-middleware-stream":3321,lodash:3497,loglevel:3503,nanoid:3590,pump:3681},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t,r){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.METAMASK_CONTROLLER_EVENTS=void 0;var s=gt(e("events")),i=gt(e("pump")),o=e("@metamask/assets-controllers"),a=e("@metamask/obs-store"),l=e("@metamask/obs-store/dist/asStream"),c=e("json-rpc-engine"),d=e("json-rpc-middleware-stream"),u=e("@metamask/eth-json-rpc-middleware"),h=e("lodash"),p=e("@metamask/eth-keyring-controller"),f=e("@metamask/keyring-controller"),g=gt(e("@metamask/eth-json-rpc-filters")),m=gt(e("@metamask/eth-json-rpc-filters/subscriptionManager")),b=e("eth-rpc-errors"),y=e("await-semaphore"),w=gt(e("loglevel")),k=e("@metamask/eth-trezor-keyring"),_=e("@metamask/eth-ledger-bridge-keyring"),v=gt(e("eth-lattice-keyring")),C=e("@keystonehq/metamask-airgapped-keyring"),S=gt(e("@metamask/eth-query")),T=gt(e("@metamask/ethjs-query")),E=gt(e("nanoid")),A=e("@sentry/browser"),M=e("@metamask/address-book-controller"),P=e("@metamask/approval-controller"),x=e("@metamask/base-controller"),R=e("@metamask/ens-controller"),N=e("@metamask/phishing-controller"),I=e("@metamask/announcement-controller"),O=e("@metamask/network-controller"),j=e("@metamask/gas-fee-controller"),L=e("@metamask/permission-controller"),D=gt(e("@metamask/smart-transactions-controller")),U=e("@metamask/selected-network-controller"),F=e("@metamask/logging-controller"),q=e("@metamask/permission-log-controller"),B=e("@metamask/rate-limit-controller"),K=e("@metamask/notification-controller"),$=e("@metamask/snaps-controllers"),H=e("@metamask/snaps-rpc-methods"),W=e("@metamask/accounts-controller"),G=e("@metamask/signature-controller"),z=e("@metamask/ppom-validator"),V=e("@metamask/controller-utils"),Y=e("@metamask/scure-bip39/dist/wordlists/english"),Q=e("@metamask/name-controller"),J=e("@metamask/queued-request-controller"),X=e("@metamask/user-operation-controller"),Z=e("@metamask/transaction-controller"),ee=e("@metamask/snaps-utils"),te=e("../../shared/constants/transaction"),ne=e("../../shared/constants/swaps"),re=e("../../shared/constants/network"),se=e("../../shared/constants/smartTransactions"),ie=e("../../shared/constants/hardware-wallets"),oe=e("../../shared/constants/keyring"),ae=e("../../shared/constants/permissions"),le=e("../../shared/notifications"),ce=e("../../shared/constants/time"),de=e("../../shared/constants/app"),ue=e("../../shared/constants/metametrics"),he=e("../../shared/constants/logs"),pe=e("../../shared/lib/token-util"),fe=e("../../shared/modules/string-utils"),ge=e("../../shared/modules/transaction.utils"),me=e("../../shared/constants/tokens"),be=e("../../shared/lib/metamask-controller-utils"),ye=e("../../shared/modules/mv3.utils"),we=e("../../shared/modules/network.utils"),ke=e("../../shared/modules/selectors"),_e=e("./lib/transaction/metrics"),ve=e("./lib/transaction/smart-transactions"),Ce=e("./lib/keyring-snaps-permissions"),Se=e("./lib/SnapsNameProvider"),Te=e("./lib/AddressBookPetnamesBridge"),Ee=e("./lib/AccountIdentitiesPetnamesBridge"),Ae=e("./lib/ppom/ppom-middleware"),Me=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=ft(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("./lib/ppom/ppom")),Pe=e("./detect-multiple-instances"),xe=gt(e("./lib/ComposableObservableStore")),Re=gt(e("./lib/account-tracker")),Ne=gt(e("./lib/createDupeReqFilterMiddleware")),Ie=gt(e("./lib/createLoggerMiddleware")),Oe=e("./lib/rpc-method-middleware"),je=gt(e("./lib/createOriginMiddleware")),Le=gt(e("./lib/createTabIdMiddleware")),De=e("./controllers/network-order"),Ue=e("./controllers/account-order"),Fe=gt(e("./lib/createOnboardingMiddleware")),qe=e("./lib/stream-utils"),Be=gt(e("./controllers/preferences")),Ke=gt(e("./controllers/app-state")),$e=gt(e("./controllers/alert")),He=gt(e("./controllers/onboarding")),We=gt(e("./lib/backup")),Ge=gt(e("./controllers/decrypt-message")),ze=gt(e("./controllers/swaps")),Ve=gt(e("./controllers/metametrics")),Ye=e("./lib/segment"),Qe=gt(e("./lib/createMetaRPCHandler")),Je=e("./lib/util"),Xe=gt(e("./lib/createMetamaskMiddleware")),Ze=e("./lib/hardware-keyring-builder-factory"),et=gt(e("./controllers/encryption-public-key")),tt=gt(e("./controllers/app-metadata")),nt=e("./controllers/permissions"),rt=gt(e("./lib/createRPCMethodTrackingMiddleware")),st=e("./lib/ppom/indexed-db-backend"),it=e("./translate"),ot=e("./lib/offscreen-bridge/trezor-offscreen-bridge"),at=e("./lib/offscreen-bridge/ledger-offscreen-bridge"),lt=e("./lib/snap-keyring"),ct=e("./lib/encryptor-factory"),dt=e("./lib/transaction/util"),ut=e("./lib/offscreen-bridge/lattice-offscreen-keyring"),ht=gt(e("./snaps/preinstalled-snaps")),pt=gt(e("./controllers/authentication/authentication-controller"));function ft(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(ft=function(e){return e?n:t})(e)}function gt(e){return e&&e.__esModule?e:{default:e}}function mt(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function bt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}n.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange",QUEUED_REQUEST_STATE_CHANGE:"QueuedRequestController:stateChange"};var wt=new WeakSet,kt=new WeakSet,_t=new WeakSet;class vt extends s.default{constructor(e){var n,r;super(),mt(this,_t),mt(this,kt),mt(this,wt),bt(this,"_trackSnapExportUsage",(0,h.wrap)((0,h.memoize)((()=>(0,h.throttle)(((e,t,n,r)=>{var s;return this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.SnapExportUsed,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,export:t,snap_category:null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category,success:n,origin:r}})}),60*ce.SECOND)),((e,t,n,r)=>`${e}${t}${r}`)),((e,...t)=>e(...t)(...t)))),bt(this,"handleWatchAssetRequest",(({asset:e,type:t,origin:n,networkClientId:r})=>{switch(t){case V.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:r});case V.ERC721:case V.ERC1155:return this.nftController.watchNft(e,t,n);default:throw new Error(`Asset type ${t} not supported`)}})),bt(this,"removePermissionsFor",(e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof L.PermissionsRequestNotFoundError))throw e}})),bt(this,"updateCaveat",((e,t,n,r)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,n,r)}catch(e){if(!(e instanceof L.PermissionsRequestNotFoundError))throw e}})),bt(this,"updateNetworksList",(e=>{try{this.networkOrderController.updateNetworksList(e)}catch(e){throw w.default.error(e.message),e}})),bt(this,"updateAccountsList",(e=>{try{this.accountOrderController.updateAccountsList(e)}catch(e){throw w.default.error(e.message),e}})),bt(this,"updateHiddenAccountsList",(e=>{try{this.accountOrderController.updateHiddenAccountsList(e)}catch(e){throw w.default.error(e.message),e}})),bt(this,"rejectPermissionsRequest",(e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof L.PermissionsRequestNotFoundError))throw e}})),bt(this,"acceptPermissionsRequest",(e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof L.PermissionsRequestNotFoundError))throw e}})),bt(this,"resolvePendingApproval",(async(e,t,n)=>{try{await this.approvalController.accept(e,t,n)}catch(e){if(!(e instanceof P.ApprovalRequestNotFoundError))throw e}})),bt(this,"rejectPendingApproval",((e,t)=>{try{this.approvalController.reject(e,new b.EthereumRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof P.ApprovalRequestNotFoundError))throw e}}));const{isFirstMetaMaskControllerSetup:s}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,h.debounce)(this.privateSendUpdate.bind(this),200*ce.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const i=e.initState||{},a=this.platform.getVersion();this.recordFirstTimeInfo(i),this.featureFlags=e.featureFlags,this.activeControllerConnections=0,this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.controllerMessenger=new x.ControllerMessenger,this.loggingController=new F.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController"}),state:i.LoggingController}),this.localStoreApiWrapper=e.localStore,this.currentMigrationVersion=e.currentMigrationVersion,this.store=new xe.default({state:i,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new y.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&("8.1.0"===a&&this.platform.openExtensionInBrowser(),this.loggingController.add({type:F.LogType.GenericLog,data:{event:he.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:a}}))})),this.appMetadataController=new tt.default({state:i.AppMetadataController,currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:a}),this.queuedRequestController=new J.QueuedRequestController({messenger:this.controllerMessenger.getRestricted({name:"QueuedRequestController",allowedActions:["NetworkController:getState","NetworkController:setActiveNetwork","SelectedNetworkController:getNetworkClientIdForDomain"]})}),this.approvalController=new P.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[V.ApprovalType.EthSign,V.ApprovalType.PersonalSign,V.ApprovalType.EthSignTypedData,V.ApprovalType.Transaction,V.ApprovalType.WatchAsset,V.ApprovalType.EthGetEncryptionPublicKey,V.ApprovalType.EthDecrypt]});const l=this.controllerMessenger.getRestricted({name:"NetworkController"});let c={};i.NetworkController&&(c=i.NetworkController),this.networkController=new O.NetworkController({messenger:l,state:c,infuraProjectId:e.infuraProjectId,trackMetaMetricsEvent:(...e)=>this.metaMetricsController.trackEvent(...e)}),this.networkController.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.deprecatedNetworkVersions={};const d=this.controllerMessenger.getRestricted({name:"TokenListController",allowedEvents:["NetworkController:stateChange"]}),u=this.controllerMessenger.getRestricted({name:"PreferencesController",allowedActions:[],allowedEvents:[]});this.preferencesController=new Be.default({initState:i.PreferencesController,initLangCode:e.initLangCode,messenger:u,provider:this.provider,networkConfigurations:this.networkController.state.networkConfigurations,onKeyringStateChange:e=>this.controllerMessenger.subscribe("KeyringController:stateChange",e)}),this.tokenListController=new o.TokenListController({chainId:this.networkController.state.providerConfig.chainId,preventPollingOnNetworkRestart:!yt(this,_t,Tt).call(this,this.preferencesController.store.getState()),messenger:d,state:i.TokenListController}),this.assetsContractController=new o.AssetsContractController({chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),onNetworkDidChange:e=>l.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{provider:this.provider},i.AssetsContractController);const g=this.controllerMessenger.getRestricted({name:"TokensController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:networkDidChange","AccountsController:selectedAccountChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokensController=new o.TokensController({messenger:g,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(t=>{e({selectedAddress:t.address})})),onNetworkDidChange:e=>l.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),onTokenListStateChange:e=>this.controllerMessenger.subscribe(`${this.tokenListController.name}:stateChange`,e),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),config:{provider:this.provider,selectedAddress:(null===(n=i.AccountsController)||void 0===n||null===(n=n.internalAccounts)||void 0===n||null===(n=n.accounts[null===(r=i.AccountsController)||void 0===r||null===(r=r.internalAccounts)||void 0===r?void 0:r.selectedAccount])||void 0===n?void 0:n.address)??""},state:i.TokensController}),this.controllerMessenger.registerActionHandler("TokensController:getState",(()=>this.tokensController.state));const m=this.controllerMessenger.getRestricted({name:"NftController",allowedActions:[`${this.approvalController.name}:addRequest`]});this.nftController=new o.NftController({messenger:m,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getERC721AssetName:this.assetsContractController.getERC721AssetName.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),getERC721TokenURI:this.assetsContractController.getERC721TokenURI.bind(this.assetsContractController),getERC721OwnerOf:this.assetsContractController.getERC721OwnerOf.bind(this.assetsContractController),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC1155TokenURI:this.assetsContractController.getERC1155TokenURI.bind(this.assetsContractController),onNftAdded:({address:e,symbol:t,tokenId:n,standard:r,source:s})=>this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.NftAdded,category:ue.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:t,token_id:n,token_standard:r,asset_type:te.AssetType.NFT,source:s}}),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{},i.NftController),this.nftController.setApiKey(null),this.nftDetectionController=new o.NftDetectionController({chainId:this.networkController.state.providerConfig.chainId,onNftsStateChange:e=>this.nftController.subscribe(e),onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getOpenSeaApiKey:()=>this.nftController.openSeaApiKey,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),addNft:this.nftController.addNft.bind(this.nftController),getNftApi:this.nftController.getNftApi.bind(this.nftController),getNftState:()=>this.nftController.state,disabled:this.preferencesController.store.getState().useNftDetection===undefined||!this.preferencesController.store.getState().useNftDetection,selectedAddress:this.preferencesController.store.getState().selectedAddress}),this.metaMetricsController=new Ve.default({segment:Ye.segment,preferencesStore:this.preferencesController.store,onNetworkDidChange:l.subscribe.bind(l,"NetworkController:networkDidChange"),getNetworkIdentifier:()=>{const{type:e,rpcUrl:t}=this.networkController.state.providerConfig;return e===re.NETWORK_TYPES.RPC?t:e},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,version:this.platform.getVersion(),environment:"production",extension:this.extension,initState:i.MetaMetricsController,captureException:A.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const S=this.controllerMessenger.getRestricted({name:"GasFeeController",allowedActions:["NetworkController:getEIP1559Compatibility","NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]}),T=ne.GAS_API_BASE_URL;this.gasFeeController=new j.GasFeeController({state:i.GasFeeController,interval:1e4,messenger:S,clientId:ne.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkDidChange:e=>{l.subscribe("NetworkController:networkDidChange",(()=>e(this.networkController.state)))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${T}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${T}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>{const{chainId:e}=this.networkController.state.providerConfig;return e===re.CHAIN_IDS.BSC},getChainId:()=>this.networkController.state.providerConfig.chainId}),this.appStateController=new Ke.default({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:i.AppStateController,onInactiveTimeout:()=>this.setLocked(),preferencesStore:this.preferencesController.store,messenger:this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`],allowedEvents:["KeyringController:qrKeyringStateChange"]}),extension:this.extension});const E=this.controllerMessenger.getRestricted({name:"CurrencyRateController",allowedActions:[`${this.networkController.name}:getNetworkClientById`]});this.currencyRateController=new o.CurrencyRateController({includeUsdRate:!0,messenger:E,state:i.CurrencyController});const H=this.controllerMessenger.getRestricted({name:"PhishingController"});this.phishingController=new N.PhishingController({messenger:H,state:i.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined}),this.phishingController.maybeUpdateState(),this.ppomController=new z.PPOMController({messenger:this.controllerMessenger.getRestricted({name:"PPOMController",allowedEvents:["NetworkController:stateChange"]}),storageBackend:new st.IndexedDBPPOMStorage("PPOMDB",1),provider:this.provider,ppomProvider:{PPOM:Me.PPOM,ppomInit:Me.default},state:i.PPOMController,chainId:this.networkController.state.providerConfig.chainId,securityAlertsEnabled:this.preferencesController.store.getState().securityAlertsEnabled,onPreferencesChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),cdnBaseUrl:"static.cx.metamask.io/api/v1/confirmations/ppom",blockaidPublicKey:"066ad3e8af5583385e312c156d238055215d5f25247c1e91055afa756cb98a88"});const Y=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new I.AnnouncementController({messenger:Y,allAnnouncements:le.UI_NOTIFICATIONS,state:i.AnnouncementController});const ie=this.controllerMessenger.getRestricted({name:"NetworkOrderController",allowedEvents:["NetworkController:stateChange"]});this.networkOrderController=new De.NetworkOrderController({messenger:ie,state:i.NetworkOrderController});const oe=this.controllerMessenger.getRestricted({name:"AccountOrderController"});this.accountOrderController=new Ue.AccountOrderController({messenger:oe,state:i.AccountOrderController});const pe=this.controllerMessenger.getRestricted({name:"AccountsController",allowedEvents:["SnapController:stateChange","KeyringController:accountRemoved","KeyringController:stateChange","AccountsController:selectedAccountChange"],allowedActions:["AccountsController:setCurrentAccount","AccountsController:setAccountName","AccountsController:listAccounts","AccountsController:getSelectedAccount","AccountsController:getAccountByAddress","AccountsController:updateAccounts","KeyringController:getAccounts","KeyringController:getKeyringsByType","KeyringController:getKeyringForAccount"]});this.accountsController=new W.AccountsController({messenger:pe,state:i.AccountsController}),this.tokenRatesController=new o.TokenRatesController({chainId:this.networkController.state.providerConfig.chainId,ticker:this.networkController.state.providerConfig.ticker,selectedAddress:this.accountsController.getSelectedAccount().address,onTokensStateChange:e=>this.tokensController.subscribe(e),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),onPreferencesStateChange:e=>this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(t=>{e({selectedAddress:t.address})})),tokenPricesService:new o.CodefiTokenPricesServiceV2,getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{allTokens:this.tokensController.state.allTokens,allDetectedTokens:this.tokensController.state.allDetectedTokens},i.TokenRatesController),this.preferencesController.store.getState().useCurrencyRateCheck&&this.tokenRatesController.start(),this.preferencesController.store.subscribe((0,Je.previousValueComparator)(((e,t)=>{const{useCurrencyRateCheck:n}=e,{useCurrencyRateCheck:r}=t;r&&!n?(this.currencyRateController.startPollingByNetworkClientId(this.networkController.state.selectedNetworkClientId),this.tokenRatesController.start()):!r&&n&&(this.currencyRateController.stopAllPolling(),this.tokenRatesController.stop())}),this.preferencesController.store.getState())),this.ensController=new R.EnsController({messenger:this.controllerMessenger.getRestricted({name:"EnsController"}),provider:this.provider,onNetworkDidChange:l.subscribe.bind(l,"NetworkController:networkDidChange")}),this.onboardingController=new He.default({initState:i.OnboardingController});let fe=[(0,p.keyringBuilderFactory)(C.MetaMaskKeyring)];if(!1===ye.isManifestV3){var ge;const e=null===(ge=this.opts.overrides)||void 0===ge?void 0:ge.keyrings,t=[(null==e?void 0:e.lattice)||v.default,C.MetaMaskKeyring],n=[{keyring:(null==e?void 0:e.trezor)||k.TrezorKeyring,bridge:(null==e?void 0:e.trezorBridge)||k.TrezorConnectBridge},{keyring:(null==e?void 0:e.ledger)||_.LedgerKeyring,bridge:(null==e?void 0:e.ledgerBridge)||_.LedgerIframeBridge}];fe=t.map((e=>(0,p.keyringBuilderFactory)(e))),n.forEach((e=>fe.push((0,Ze.hardwareKeyringBuilderFactory)(e.keyring,e.bridge))))}else fe.push((0,Ze.hardwareKeyringBuilderFactory)(k.TrezorKeyring,ot.TrezorOffscreenBridge),(0,Ze.hardwareKeyringBuilderFactory)(_.LedgerKeyring,at.LedgerOffscreenBridge),(0,p.keyringBuilderFactory)(ut.LatticeKeyringOffscreen));const me=this.controllerMessenger.getRestricted({name:"SnapKeyringBuilder",allowedActions:["ApprovalController:addRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","ApprovalController:startFlow","ApprovalController:endFlow","ApprovalController:showSuccess","ApprovalController:showError","PhishingController:test","PhishingController:maybeUpdateState","KeyringController:getAccounts","AccountsController:setSelectedAccount","AccountsController:getAccountByAddress"]});fe.push((0,lt.snapKeyringBuilder)(me,(()=>this.snapController),(async()=>{await this.keyringController.persistAllKeyrings(),await this.accountsController.updateAccounts()}),(e=>this.preferencesController.setSelectedAddress(e)),(e=>this.removeAccount(e)),this.metaMetricsController.trackEvent.bind(this.metaMetricsController),(e=>{if(!e)return null;const t=this.getLocale(),{snaps:n}=this.snapController.state,r=n[e];if(!r)return(0,ee.stripSnapPrefix)(e);if(r.localizationFiles){return(0,ee.getLocalizedSnapManifest)(r.manifest,t,r.localizationFiles).proposedName}return r.manifest.proposedName})));const be=this.controllerMessenger.getRestricted({name:"KeyringController"});this.keyringController=new f.KeyringController({cacheEncryptionKey:!0,keyringBuilders:fe,state:i.KeyringController,encryptor:e.encryptor||(0,ct.encryptorFactory)(6e5),messenger:be,removeIdentity:this.preferencesController.removeAddress.bind(this.preferencesController),setAccountLabel:(e,t)=>{const n=this.accountsController.getAccountByAddress(e);if(n===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(n.id,t),this.preferencesController.setAccountLabel(e,t)},setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(t===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id),this.preferencesController.setSelectedAddress(e)},syncIdentities:e=>{this.preferencesController.syncAddresses(e)},updateIdentities:this.preferencesController.setAddresses.bind(this.preferencesController)}),this.controllerMessenger.subscribe("KeyringController:unlock",(()=>this._onUnlock())),this.controllerMessenger.subscribe("KeyringController:lock",(()=>this._onLock())),this.controllerMessenger.subscribe("KeyringController:stateChange",(e=>{this._onKeyringControllerUpdate(e)})),this.permissionController=new L.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:i.PermissionController,caveatSpecifications:(0,nt.getCaveatSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController)}),permissionSpecifications:{...(0,nt.getPermissionSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController),getAllAccounts:this.keyringController.getAccounts.bind(this.keyringController),captureKeyringTypesWithMissingIdentities:(e=[],t=[])=>{const n=t.filter((t=>!e.some((e=>e.address.toLowerCase()===t.toLowerCase())))).map((e=>this.keyringController.getAccountKeyringType(e))),r=e.length,s=Object.keys(this.accountTracker.store.getState().accounts||{}).length;(0,A.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${r} identities, and the ${n} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}}),...this.getSnapPermissionSpecifications()},unrestrictedMethods:nt.unrestrictedMethods}),this.selectedNetworkController=new U.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]}),state:i.SelectedNetworkController,getUseRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController)}),this.permissionLogController=new q.PermissionLogController({messenger:this.controllerMessenger.getRestricted({name:"PermissionLogController"}),restrictedMethods:new Set(Object.keys(ae.RestrictedMethods)),state:i.PermissionLogController}),this.subjectMetadataController=new L.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:i.SubjectMetadataController,subjectCacheLimit:100});const we=ye.isManifestV3&&"undefined"!=typeof chrome&&void 0!==chrome.offscreen,_e={messenger:this.controllerMessenger.getRestricted({name:"ExecutionService"}),setupSnapProvider:this.setupSnapProvider.bind(this)};this.snapExecutionService=!1===we?new $.IframeExecutionService({..._e,iframeUrl:new URL("https://execution.metamask.io/iframe/5.0.4/index.html")}):new $.OffscreenExecutionService({documentUrl:chrome.runtime.getURL("./offscreen.html"),..._e});const ve=this.controllerMessenger.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse"],allowedActions:[`${this.permissionController.name}:getEndowments`,`${this.permissionController.name}:getPermissions`,`${this.permissionController.name}:hasPermission`,`${this.permissionController.name}:hasPermissions`,`${this.permissionController.name}:requestPermissions`,`${this.permissionController.name}:revokeAllPermissions`,`${this.permissionController.name}:revokePermissions`,`${this.permissionController.name}:revokePermissionForAllSubjects`,`${this.permissionController.name}:getSubjectNames`,`${this.permissionController.name}:updateCaveat`,`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:updateRequestState`,`${this.permissionController.name}:grantPermissions`,`${this.subjectMetadataController.name}:getSubjectMetadata`,`${this.subjectMetadataController.name}:addSubjectMetadata`,"ExecutionService:executeSnap","ExecutionService:getRpcRequestHandler","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update","SnapsRegistry:resolveVersion","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"]}),Ce=!0;this.snapController=new $.SnapController({environmentEndowmentPermissions:Object.values(ae.EndowmentPermissions),excludedPermissions:{...ae.ExcludedSnapPermissions,...ae.ExcludedSnapEndowments},closeAllConnections:this.removeAllConnections.bind(this),state:i.SnapController,messenger:ve,featureFlags:{dappsCanUpdateSnaps:!0,allowLocalSnaps:!1,requireAllowlist:Ce},preinstalledSnaps:ht.default}),this.notificationController=new K.NotificationController({messenger:this.controllerMessenger.getRestricted({name:"NotificationController"}),state:i.NotificationController}),this.rateLimitController=new B.RateLimitController({state:i.RateLimitController,messenger:this.controllerMessenger.getRestricted({name:"RateLimitController"}),implementations:{showNativeNotification:{method:(e,t)=>{const n=this.controllerMessenger.call("SubjectMetadataController:getState").subjectMetadata[e];return this.platform._showNotification((null==n?void 0:n.name)??e,t).catch((e=>{w.default.error("Failed to create notification",e)})),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,t)=>(this.controllerMessenger.call("NotificationController:show",e,t),null),rateLimitCount:5,rateLimitTimeout:6e4}}});const Ae=this.controllerMessenger.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:[`${this.permissionController.name}:getPermissions`,"SnapController:handleRequest","SnapController:getAll"]});this.cronjobController=new $.CronjobController({state:i.CronjobController,messenger:Ae});const Ne=this.controllerMessenger.getRestricted({name:"SnapsRegistry",allowedEvents:[],allowedActions:[]});this.snapsRegistry=new $.JsonSnapsRegistry({state:i.SnapsRegistry,messenger:Ne,refetchOnAllowlistMiss:Ce,failOnUnavailableRegistry:Ce,url:{registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:"0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6"});const Ie=this.controllerMessenger.getRestricted({name:"SnapInterfaceController",allowedActions:[`${this.phishingController.name}:maybeUpdateState`,`${this.phishingController.name}:testOrigin`]});this.snapInterfaceController=new $.SnapInterfaceController({state:i.SnapInterfaceController,messenger:Ie}),this.authenticationController=new pt.default({state:i.AuthenticationController,messenger:this.controllerMessenger.getRestricted({name:"AuthenticationController",allowedActions:[`${this.snapController.name}:handleRequest`]})}),this.accountTracker=new Re.default({provider:this.provider,blockTracker:this.blockTracker,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getNetworkIdentifier:e=>{const{type:t,rpcUrl:n}=e??this.networkController.state.providerConfig;return t===re.NETWORK_TYPES.RPC?n:t},preferencesController:this.preferencesController,onboardingController:this.onboardingController,controllerMessenger:this.controllerMessenger.getRestricted({name:"AccountTracker",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]}),initState:{accounts:{}},onAccountRemoved:this.controllerMessenger.subscribe.bind(this.controllerMessenger,"KeyringController:accountRemoved")}),this.on("controllerConnectionChanged",(e=>{const{completedOnboarding:t}=this.onboardingController.store.getState();e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()})),this.onboardingController.store.subscribe((0,Je.previousValueComparator)((async(e,t)=>{const{completedOnboarding:n}=e,{completedOnboarding:r}=t;!n&&r&&(this.postOnboardingInitialization(),this.triggerNetworkrequests())}),this.onboardingController.store.getState()));const Oe=this.controllerMessenger.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens"],allowedEvents:["AccountsController:selectedAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokenDetectionController=new o.TokenDetectionController({messenger:Oe,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.addressBookController=new M.AddressBookController(undefined,i.AddressBookController),this.alertController=new $e.default({initState:i.AlertController,preferencesStore:this.preferencesController.store,controllerMessenger:this.controllerMessenger.getRestricted({name:"AlertController",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]})}),this.backup=new We.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,accountsController:this.accountsController,networkController:this.networkController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.snapAndHardwareMetricsParams={getSelectedAccount:this.accountsController.getSelectedAccount.bind(this.accountsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]})};const je=this.controllerMessenger.getRestricted({name:"TransactionController",allowedActions:[`${this.approvalController.name}:addRequest`,"NetworkController:findNetworkClientIdByChainId","NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]});this.txController=new Z.TransactionController({blockTracker:this.blockTracker,getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),getExternalPendingTransactions:this.getExternalPendingTransactions.bind(this),getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getNetworkClientRegistry:this.networkController.getNetworkClientRegistry.bind(this.networkController),getNetworkState:()=>this.networkController.state,getPermittedAccounts:this.getPermittedAccounts.bind(this),getSavedGasFees:()=>this.preferencesController.store.getState().advancedGasFee[this.networkController.state.providerConfig.chainId],getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,incomingTransactions:{includeTokenTransfers:!1,isEnabled:()=>{var e;return Boolean((null===(e=this.preferencesController.store.getState().incomingTransactionsPreferences)||void 0===e?void 0:e[this.networkController.state.providerConfig.chainId])&&this.onboardingController.store.getState().completedOnboarding)},queryEntireHistory:!1,updateTransactions:!1},isMultichainEnabled:"",isSimulationEnabled:()=>this.preferencesController.store.getState().useTransactionSimulations,messenger:je,onNetworkStateChange:e=>{l.subscribe("NetworkController:networkDidChange",(()=>e()))},pendingTransactions:{isResubmitEnabled:()=>{const e=this._getMetaMaskState();return!((0,ke.getSmartTransactionsOptInStatus)(e)&&(0,ke.getCurrentChainSupportsSmartTransactions)(e))}},provider:this.provider,hooks:{publish:this._publishSmartTransactionHook.bind(this)},sign:(...e)=>this.keyringController.signTransaction(...e),state:i.TransactionController}),this._addTransactionControllerListeners(),l.subscribe("NetworkController:networkDidChange",(async()=>{try{this.preferencesController.store.getState().useCurrencyRateCheck&&(await this.currencyRateController.stopAllPolling(),this.currencyRateController.startPollingByNetworkClientId(this.networkController.state.selectedNetworkClientId))}catch(e){console.error(e)}})),this.decryptMessageController=new Ge.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`]}),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyController=new et.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.signatureController=new G.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`,`${this.loggingController.name}:add`]}),isEthSignEnabled:()=>{var e;return null===(e=this.preferencesController.store.getState())||void 0===e||null===(e=e.disabledRpcMethodPreferences)||void 0===e?void 0:e.eth_sign},getAllState:this.getState.bind(this),getCurrentChainId:()=>this.networkController.state.providerConfig.chainId}),this.signatureController.hub.on("cancelWithReason",(({message:e,reason:t})=>{this.metaMetricsController.trackEvent({event:t,category:ue.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})})),this.swapsController=new ze.default({getBufferedGasLimit:async(e,t)=>{const{gas:n,simulationFails:r}=await this.txController.estimateGasBuffered(e.txParams,t);return{gasLimit:n,simulationFails:r}},provider:this.provider,getProviderConfig:()=>this.networkController.state.providerConfig,getTokenRatesState:()=>this.tokenRatesController.state,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},i.SwapsController),this.smartTransactionsController=new D.default({getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getNonceLock:this.txController.getNonceLock.bind(this.txController),confirmExternalTransaction:this.txController.confirmExternalTransaction.bind(this.txController),getTransactions:this.txController.getTransactions.bind(this.txController),provider:this.provider,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},{supportedChainIds:(0,se.getAllowedSmartTransactionsChainIds)()},i.SmartTransactionsController);const Le=()=>this.preferencesController.store.getState().useExternalNameSources;this.nameController=new Q.NameController({messenger:this.controllerMessenger.getRestricted({name:"NameController",allowedActions:[]}),providers:[new Q.ENSNameProvider({reverseLookup:this.ensController.reverseResolveAddress.bind(this.ensController)}),new Q.EtherscanNameProvider({isEnabled:Le}),new Q.TokenNameProvider({isEnabled:Le}),new Q.LensNameProvider({isEnabled:Le}),new Se.SnapsNameProvider({messenger:this.controllerMessenger.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"]})})],state:i.NameController});const Fe=this.controllerMessenger.getRestricted({name:"PetnamesBridge",allowedEvents:["NameController:stateChange","AccountsController:stateChange"],allowedActions:["AccountsController:listAccounts"]});new Te.AddressBookPetnamesBridge({addressBookController:this.addressBookController,nameController:this.nameController,messenger:Fe}).init(),new Ee.AccountIdentitiesPetnamesBridge({nameController:this.nameController,messenger:Fe}).init(),this.userOperationController=new X.UserOperationController({entrypoint:t.env.EIP_4337_ENTRYPOINT,getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),messenger:this.controllerMessenger.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"]}),state:i.UserOperationController}),this.userOperationController.hub.on("user-operation-added",this._onUserOperationAdded.bind(this)),this.userOperationController.hub.on("transaction-updated",this._onUserOperationTransactionUpdated.bind(this)),l.subscribe("NetworkController:networkDidChange",(()=>{this.accountTracker.updateAccounts()})),l.subscribe("NetworkController:networkWillChange",(()=>{this.encryptionPublicKeyController.clearUnapproved(),this.decryptMessageController.clearUnapproved(),this.signatureController.clearUnapproved(),this.approvalController.clear(b.ethErrors.provider.userRejectedRequest())})),this.metamaskMiddleware=(0,Xe.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${a}`},version:a,getAccounts:async({origin:e},{suppressUnauthorizedError:t=!0}={})=>{if(e===de.ORIGIN_METAMASK){const e=this.accountsController.getSelectedAccount().address;return e?[e]:[]}return this.isUnlocked()?await this.getPermittedAccounts(e,{suppressUnauthorizedError:t}):[]},processTransaction:(e,t)=>(0,dt.addDappTransaction)(this.getAddTransactionRequest({transactionParams:e,dappRequest:t})),processEthSignMessage:this.signatureController.newUnsignedMessage.bind(this.signatureController),processTypedMessage:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV3:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV4:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processPersonalMessage:this.signatureController.newUnsignedPersonalMessage.bind(this.signatureController),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.state.transactions.find((t=>t.hash===e&&t.status===Z.TransactionStatus.submitted))}),this.on("update",(e=>this._onStateUpdate(e)));const qe={AccountTracker:this.accountTracker.store,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController.store,EnsController:this.ensController,ApprovalController:this.approvalController,PPOMController:this.ppomController};this.store.updateStructure({AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,TransactionController:this.txController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,NetworkController:this.networkController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,PPOMController:this.ppomController,NameController:this.nameController,UserOperationController:this.userOperationController,...qe}),this.memStore=new xe.default({config:{AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,NetworkController:this.networkController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,TxController:this.txController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,NameController:this.nameController,UserOperationController:this.userOperationController,...qe},controllerMessenger:this.controllerMessenger});const Qe=[this.accountTracker.resetState,this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState,this.ensController.resetState.bind(this.ensController),this.approvalController.clear.bind(this.approvalController)];ye.isManifestV3?!0===s&&(this.resetStates(Qe),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(Qe);!this.isUnlocked()&&this.onboardingController.store.getState().completedOnboarding,this._startUISync(),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(Pe.onMessageReceived),(0,Pe.checkForMultipleVersionsRunning)(),this.onboardingController.store.getState().completedOnboarding&&this.postOnboardingInitialization()}postOnboardingInitialization(){this.networkController.lookupNetwork()}triggerNetworkrequests(){this.accountTracker.start(),this.txController.startIncomingTransactionPolling(),this.tokenDetectionController.enable();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t,useNftDetection:n}=e;n&&this.nftDetectionController.start(),t&&this.currencyRateController.startPollingByNetworkClientId(this.networkController.state.selectedNetworkClientId),yt(this,_t,Tt).call(this,e)&&this.tokenListController.start()}stopNetworkRequests(){this.accountTracker.stop(),this.txController.stopIncomingTransactionPolling(),this.tokenDetectionController.disable(),this.nftDetectionController.stop();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t}=e;t&&this.currencyRateController.stopAllPolling(),yt(this,_t,Tt).call(this,e)&&(this.tokenListController.stop(),this.tokenRatesController.stop())}resetStates(e){e.forEach((e=>{try{e()}catch(e){console.error(e)}}))}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(oe.KeyringType.snap);return e||(e=await this.keyringController.addNewKeyring(oe.KeyringType.snap)),e}_getSnapMetadata(e){var t;return null===(t=this.snapsRegistry.state.database)||void 0===t||null===(t=t.verifiedSnaps)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.metadata}async handleSnapRequest(e){try{const t=await this.controllerMessenger.call("SnapController:handleRequest",e);return this._trackSnapExportUsage(e.snapId,e.handler,!0,e.origin),t}catch(t){throw this._trackSnapExportUsage(e.snapId,e.handler,!1,e.origin),t}}getLocale(){const{currentLocale:e}=this.preferencesController.store.getState();return e}getSnapPermissionSpecifications(){const e=(0,ct.encryptorFactory)(6e5);return{...(0,H.buildSnapEndowmentSpecifications)(Object.keys(ae.ExcludedSnapEndowments)),...(0,H.buildSnapRestrictedMethodSpecifications)(Object.keys(ae.ExcludedSnapPermissions),{encrypt:e.encrypt,decrypt:e.decrypt,getLocale:this.getLocale.bind(this),clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),showDialog:(e,t,n,r)=>this.approvalController.addAndShowApprovalRequest({origin:e,type:de.SNAP_DIALOG_TYPES[t],requestData:{id:n,placeholder:r}}),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,t.message),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:e}=this.preferencesController.store.getState();e&&this.controllerMessenger.call("PhishingController:maybeUpdateState")},isOnPhishingList:e=>{const{usePhishDetect:t}=this.preferencesController.store.getState();return!!t&&this.controllerMessenger.call("PhishingController:testOrigin",e).result},createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface"),getInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:getInterface"),getSnapKeyring:this.getSnapKeyring.bind(this)})}}dismissNotifications(e){this.notificationController.dismiss(e)}markNotificationsAsRead(e){this.notificationController.markRead(e)}setupControllerEventSubscriptions(){let e;this.preferencesController.store.subscribe((0,Je.previousValueComparator)(((e,t)=>{yt(this,wt,Ct).call(this,t,e)}),this.preferencesController.store.getState())),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,(async t=>{t.address&&t.address!==e&&(e=t.address,await this._onAccountChange(t.address))})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const n=(0,nt.getChangedAccounts)(e,t);for(const[e,t]of n.entries())this._notifyAccountsChange(e,t)}),nt.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkDidChange",(async()=>{await this.txController.updateIncomingTransactions()})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallStarted`,((e,t,n)=>{var r;const s=null===(r=this._getSnapMetadata(e))||void 0===r?void 0:r.category;this.metaMetricsController.trackEvent({event:n?ue.MetaMetricsEventName.SnapUpdateStarted:ue.MetaMetricsEventName.SnapInstallStarted,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallFailed`,((e,t,n,r)=>{var s;const i=r.includes("User rejected the request."),o=n?ue.MetaMetricsEventName.SnapUpdateFailed:ue.MetaMetricsEventName.SnapInstallFailed,a=n?ue.MetaMetricsEventName.SnapUpdateRejected:ue.MetaMetricsEventName.SnapInstallRejected,l=null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category;this.metaMetricsController.trackEvent({event:i?a:o,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:l}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,((e,t)=>{var n;const r=e.id,s=null===(n=this._getSnapMetadata(r))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.SnapInstalled,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:r,version:e.version,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,((e,t,n)=>{var r;const s=e.id,i=null===(r=this._getSnapMetadata(s))||void 0===r?void 0:r.category;this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.SnapUpdated,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:s,old_version:t,new_version:e.version,origin:n,snap_category:i}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,(e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter((t=>t.origin===e.id&&t.type.startsWith(ae.RestrictedMethods.snap_dialog)));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,(e=>{var t;const n=Object.values(this.notificationController.state.notifications).reduce(((t,n)=>(n.origin===e.id&&t.push(n.id),t)),[]);this.dismissNotifications(n);const r=e.id,s=null===(t=this._getSnapMetadata(r))||void 0===t?void 0:t.category;this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.SnapUninstalled,category:ue.MetaMetricsEventCategory.Snaps,properties:{snap_id:r,version:e.version,snap_category:s}})}))}createPublicConfigStore(){const e=new a.ObservableStore,t=async({isUnlocked:e})=>{const{chainId:t,networkVersion:n}=await this.getProviderNetworkState();return{isUnlocked:e,chainId:t,networkVersion:n??"loading"}},n=async n=>{var r;(null===(r=n.networksMetadata[n.selectedNetworkClientId])||void 0===r?void 0:r.status)===re.NetworkStatus.Available&&e.putState(await t(n))};return this.on("update",n),n(this.getState()),e}async getProviderState(e){const t=await this.getProviderNetworkState(this.preferencesController.getUseRequestQueue()?e:undefined);return{isUnlocked:this.isUnlocked(),accounts:await this.getPermittedAccounts(e),...t}}async getProviderNetworkState(e=U.METAMASK_DOMAIN){const t=this.controllerMessenger.call("SelectedNetworkController:getNetworkClientIdForDomain",e),n=this.controllerMessenger.call("NetworkController:getNetworkClientById",t),{chainId:r}=n.configuration,{completedOnboarding:s}=this.onboardingController.store.getState();let i=this.deprecatedNetworkVersions[t];if(!i&&s){const e=new S.default(n.provider);i=await new Promise((t=>{e.sendAsync({method:"net_version"},((e,n)=>{e?(console.error(e),t(null)):t((0,we.convertNetworkId)(n))}))})),this.deprecatedNetworkVersions[t]=i}return{chainId:r,networkVersion:i??"loading"}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),n=this.memStore.getFlatState();return delete n.vault,{isInitialized:t,...n,snapStates:{},unencryptedSnapStates:{},snaps:Object.values(n.snaps??{}).reduce(((e,t)=>{const{sourceCode:n,auxiliaryFiles:r,...s}=t;return e[t.id]=s,e}),{})}}getApi(){const{accountsController:e,addressBookController:t,alertController:n,appStateController:r,keyringController:s,nftController:i,nftDetectionController:o,currencyRateController:a,tokenDetectionController:l,ensController:c,gasFeeController:d,metaMetricsController:u,networkController:h,announcementController:p,onboardingController:f,permissionController:g,preferencesController:m,swapsController:b,tokensController:y,smartTransactionsController:w,txController:k,assetsContractController:_,backup:v,approvalController:C,phishingController:S}=this;return{getState:this.getState.bind(this),setCurrentCurrency:a.setCurrentCurrency.bind(a),setUseBlockie:m.setUseBlockie.bind(m),setUseNonceField:m.setUseNonceField.bind(m),setUsePhishDetect:m.setUsePhishDetect.bind(m),setUseMultiAccountBalanceChecker:m.setUseMultiAccountBalanceChecker.bind(m),dismissOpenSeaToBlockaidBanner:m.dismissOpenSeaToBlockaidBanner.bind(m),setUseSafeChainsListValidation:m.setUseSafeChainsListValidation.bind(m),setUseTokenDetection:m.setUseTokenDetection.bind(m),setUseNftDetection:m.setUseNftDetection.bind(m),setUse4ByteResolution:m.setUse4ByteResolution.bind(m),setUseCurrencyRateCheck:m.setUseCurrencyRateCheck.bind(m),setOpenSeaEnabled:m.setOpenSeaEnabled.bind(m),getUseRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),getProviderConfig:()=>this.networkController.state.providerConfig,setSecurityAlertsEnabled:m.setSecurityAlertsEnabled.bind(m),setAddSnapAccountEnabled:m.setAddSnapAccountEnabled.bind(m),setUseExternalNameSources:m.setUseExternalNameSources.bind(m),setUseTransactionSimulations:m.setUseTransactionSimulations.bind(m),setUseRequestQueue:this.setUseRequestQueue.bind(this),setIpfsGateway:m.setIpfsGateway.bind(m),setIsIpfsGatewayEnabled:m.setIsIpfsGatewayEnabled.bind(m),setUseAddressBarEnsResolution:m.setUseAddressBarEnsResolution.bind(m),setParticipateInMetaMetrics:u.setParticipateInMetaMetrics.bind(u),setCurrentLocale:m.setCurrentLocale.bind(m),setIncomingTransactionsPreferences:m.setIncomingTransactionsPreferences.bind(m),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),requestUserApproval:C.addAndShowApprovalRequest.bind(C),addNewAccount:this.addNewAccount.bind(this),getSeedPhrase:this.getSeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getAccountsBySnapId:e=>(0,lt.getAccountsBySnapId)(this,e),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),submitQRHardwareCryptoHDKey:s.submitQRCryptoHDKey.bind(s),submitQRHardwareCryptoAccount:s.submitQRCryptoAccount.bind(s),cancelSyncQRHardware:s.cancelQRSynchronization.bind(s),submitQRHardwareSignature:s.submitQRSignature.bind(s),cancelQRHardwareSignRequest:s.cancelQRSignRequest.bind(s),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setProviderType:e=>this.networkController.setProviderType(e),setActiveNetwork:e=>this.networkController.setActiveNetwork(e),setNetworkClientIdForDomain:(e,t)=>this.selectedNetworkController.setNetworkClientIdForDomain(e,t),rollbackToPreviousProvider:h.rollbackToPreviousProvider.bind(h),removeNetworkConfiguration:h.removeNetworkConfiguration.bind(h),upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getNetworkConfigurationByNetworkClientId:this.networkController.getNetworkConfigurationByNetworkClientId.bind(this.networkController),setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(!t)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id),this.preferencesController.setSelectedAddress(e)},addToken:y.addToken.bind(y),updateTokenType:y.updateTokenType.bind(y),setFeatureFlag:m.setFeatureFlag.bind(m),setPreference:m.setPreference.bind(m),addKnownMethodData:m.addKnownMethodData.bind(m),setDismissSeedBackUpReminder:m.setDismissSeedBackUpReminder.bind(m),setDisabledRpcMethodPreference:m.setDisabledRpcMethodPreference.bind(m),getRpcMethodPreferences:m.getRpcMethodPreferences.bind(m),setAdvancedGasFee:m.setAdvancedGasFee.bind(m),setTheme:m.setTheme.bind(m),setSnapsAddSnapAccountModalDismissed:m.setSnapsAddSnapAccountModalDismissed.bind(m),setSelectedInternalAccount:e=>{const t=this.accountsController.getAccount(e);t&&(this.preferencesController.setSelectedAddress(t.address),this.accountsController.setSelectedAccount(e))},setAccountName:e.setAccountName.bind(e),setAccountLabel:(e,t)=>{this.preferencesController.setAccountLabel(e,t);const n=this.accountsController.getAccountByAddress(e);if(n===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(n.id,t)},getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTokenSymbol:this.getTokenSymbol.bind(this),addNft:i.addNft.bind(i),addNftVerifyOwnership:i.addNftVerifyOwnership.bind(i),removeAndIgnoreNft:i.removeAndIgnoreNft.bind(i),removeNft:i.removeNft.bind(i),checkAndUpdateAllNftsOwnershipStatus:i.checkAndUpdateAllNftsOwnershipStatus.bind(i),checkAndUpdateSingleNftOwnershipStatus:i.checkAndUpdateSingleNftOwnershipStatus.bind(i),isNftOwner:i.isNftOwner.bind(i),setAddressBook:t.set.bind(t),removeFromAddressBook:t.delete.bind(t),setLastActiveTime:r.setLastActiveTime.bind(r),setCurrentExtensionPopupId:r.setCurrentExtensionPopupId.bind(r),setDefaultHomeActiveTabName:r.setDefaultHomeActiveTabName.bind(r),setConnectedStatusPopoverHasBeenShown:r.setConnectedStatusPopoverHasBeenShown.bind(r),setRecoveryPhraseReminderHasBeenShown:r.setRecoveryPhraseReminderHasBeenShown.bind(r),setRecoveryPhraseReminderLastShown:r.setRecoveryPhraseReminderLastShown.bind(r),setTermsOfUseLastAgreed:r.setTermsOfUseLastAgreed.bind(r),setSurveyLinkLastClickedOrClosed:r.setSurveyLinkLastClickedOrClosed.bind(r),setSnapsInstallPrivacyWarningShownStatus:r.setSnapsInstallPrivacyWarningShownStatus.bind(r),setOutdatedBrowserWarningLastShown:r.setOutdatedBrowserWarningLastShown.bind(r),setShowTestnetMessageInDropdown:r.setShowTestnetMessageInDropdown.bind(r),setShowBetaHeader:r.setShowBetaHeader.bind(r),setShowPermissionsTour:r.setShowPermissionsTour.bind(r),setShowProductTour:r.setShowProductTour.bind(r),setShowAccountBanner:r.setShowAccountBanner.bind(r),setShowNetworkBanner:r.setShowNetworkBanner.bind(r),updateNftDropDownState:r.updateNftDropDownState.bind(r),setFirstTimeUsedNetwork:r.setFirstTimeUsedNetwork.bind(r),setSwitchedNetworkDetails:r.setSwitchedNetworkDetails.bind(r),clearSwitchedNetworkDetails:r.clearSwitchedNetworkDetails.bind(r),setSwitchedNetworkNeverShowMessage:r.setSwitchedNetworkNeverShowMessage.bind(r),tryReverseResolveAddress:c.reverseResolveAddress.bind(c),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:k.updateTransaction.bind(k),approveTransactionsWithSameNonce:k.approveTransactionsWithSameNonce.bind(k),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),getNextNonce:this.getNextNonce.bind(this),addTransaction:(e,t)=>(0,dt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!1}),this.updateSecurityAlertResponseByTxId.bind(this)),addTransactionAndWaitForPublish:(e,t)=>(0,dt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!0}),this.updateSecurityAlertResponseByTxId.bind(this)),createTransactionEventFragment:_e.createTransactionEventFragmentWithTxId.bind(null,this.getTransactionMetricsRequest()),getTransactions:this.txController.getTransactions.bind(this.txController),updateEditableParams:this.txController.updateEditableParams.bind(this.txController),updateTransactionGasFees:k.updateTransactionGasFees.bind(k),updateTransactionSendFlowHistory:k.updateTransactionSendFlowHistory.bind(k),updatePreviousGasParams:k.updatePreviousGasParams.bind(k),abortTransactionSigning:k.abortTransactionSigning.bind(k),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setSeedPhraseBackedUp:f.setSeedPhraseBackedUp.bind(f),completeOnboarding:f.completeOnboarding.bind(f),setFirstTimeFlowType:f.setFirstTimeFlowType.bind(f),setAlertEnabledness:n.setAlertEnabledness.bind(n),setUnconnectedAccountAlertShown:n.setUnconnectedAccountAlertShown.bind(n),setWeb3ShimUsageAlertDismissed:n.setWeb3ShimUsageAlertDismissed.bind(n),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,nt.getPermissionBackgroundApiMethods)(g),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),updateSnap:(e,t)=>(this.controllerMessenger.call("SnapController:install",e,t),null),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),dismissNotifications:this.dismissNotifications.bind(this),markNotificationsAsRead:this.markNotificationsAsRead.bind(this),disconnectOriginFromSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disconnectOrigin"),updateNetworksList:this.updateNetworksList.bind(this),updateAccountsList:this.updateAccountsList.bind(this),updateHiddenAccountsList:this.updateHiddenAccountsList.bind(this),getPhishingResult:async e=>(await S.maybeUpdateState(),S.test(e)),deleteInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:deleteInterface"),updateInterfaceState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterfaceState"),fetchAndSetQuotes:b.fetchAndSetQuotes.bind(b),setSelectedQuoteAggId:b.setSelectedQuoteAggId.bind(b),resetSwapsState:b.resetSwapsState.bind(b),setSwapsTokens:b.setSwapsTokens.bind(b),clearSwapsQuotes:b.clearSwapsQuotes.bind(b),setApproveTxId:b.setApproveTxId.bind(b),setTradeTxId:b.setTradeTxId.bind(b),setSwapsTxGasPrice:b.setSwapsTxGasPrice.bind(b),setSwapsTxGasLimit:b.setSwapsTxGasLimit.bind(b),setSwapsTxMaxFeePerGas:b.setSwapsTxMaxFeePerGas.bind(b),setSwapsTxMaxFeePriorityPerGas:b.setSwapsTxMaxFeePriorityPerGas.bind(b),safeRefetchQuotes:b.safeRefetchQuotes.bind(b),stopPollingForQuotes:b.stopPollingForQuotes.bind(b),setBackgroundSwapRouteState:b.setBackgroundSwapRouteState.bind(b),resetPostFetchState:b.resetPostFetchState.bind(b),setSwapsErrorKey:b.setSwapsErrorKey.bind(b),setInitialGasEstimate:b.setInitialGasEstimate.bind(b),setCustomApproveTxData:b.setCustomApproveTxData.bind(b),setSwapsLiveness:b.setSwapsLiveness.bind(b),setSwapsFeatureFlags:b.setSwapsFeatureFlags.bind(b),setSwapsUserFeeLevel:b.setSwapsUserFeeLevel.bind(b),setSwapsQuotesPollingLimitEnabled:b.setSwapsQuotesPollingLimitEnabled.bind(b),fetchSmartTransactionFees:w.getFees.bind(w),clearSmartTransactionFees:w.clearFees.bind(w),submitSignedTransactions:w.submitSignedTransactions.bind(w),cancelSmartTransaction:w.cancelSmartTransaction.bind(w),fetchSmartTransactionsLiveness:w.fetchLiveness.bind(w),updateSmartTransaction:w.updateSmartTransaction.bind(w),setStatusRefreshInterval:w.setStatusRefreshInterval.bind(w),trackMetaMetricsEvent:u.trackEvent.bind(u),trackMetaMetricsPage:u.trackPage.bind(u),createEventFragment:u.createEventFragment.bind(u),updateEventFragment:u.updateEventFragment.bind(u),finalizeEventFragment:u.finalizeEventFragment.bind(u),resolvePendingApproval:this.resolvePendingApproval,rejectPendingApproval:this.rejectPendingApproval,updateViewedNotifications:p.updateViewed.bind(p),gasFeeStartPollingByNetworkClientId:d.startPollingByNetworkClientId.bind(d),gasFeeStopPollingByPollingToken:d.stopPollingByPollingToken.bind(d),getGasFeeTimeEstimate:d.getTimeEstimate.bind(d),addPollingTokenToAppState:r.addPollingToken.bind(r),removePollingTokenFromAppState:r.removePollingToken.bind(r),backupUserData:v.backupUserData.bind(v),restoreUserData:v.restoreUserData.bind(v),detectTokens:l.detectTokens.bind(l),detectNfts:o.detectNfts.bind(o),addDetectedTokens:y.addDetectedTokens.bind(y),addImportedTokens:y.addTokens.bind(y),ignoreTokens:y.ignoreTokens.bind(y),getBalancesInSingleCall:_.getBalancesInSingleCall.bind(_),throwTestError:this.throwTestError.bind(this),updateProposedNames:this.nameController.updateProposedNames.bind(this.nameController),setName:this.nameController.setName.bind(this.nameController)}}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,n){var r,s;const{tokenList:i}=this.tokenListController.state,{tokens:o}=this.tokensController.state,a={...me.STATIC_MAINNET_TOKEN_LIST[e.toLowerCase()]||{},...i[e.toLowerCase()]||{},...o.find((({address:t})=>(0,fe.isEqualCaseInsensitive)(t,e)))||{}},l=(0,fe.isEqualCaseInsensitive)(a.standard,te.TokenStandard.ERC20)||!0===a.erc20,c=!(n||(0,fe.isEqualCaseInsensitive)(a.standard,te.TokenStandard.ERC1155)||(0,fe.isEqualCaseInsensitive)(a.standard,te.TokenStandard.ERC721)||a.erc721),d=a.decimals!==undefined&&a.symbol;let u;if(l||c&&d)try{const n=t?await(0,pe.fetchTokenBalance)(e,t,this.provider):undefined;u={address:e,balance:n,standard:te.TokenStandard.ERC20,decimals:a.decimals,symbol:a.symbol}}catch(e){w.default.warn(`Failed to get token balance. Error: ${e}`)}u===undefined&&(u=await this.assetsContractController.getTokenStandardAndDetails(e,t,n));if((0,fe.isEqualCaseInsensitive)(u.standard,te.TokenStandard.ERC1155))try{const r=await(0,pe.fetchERC1155Balance)(e,t,n,this.provider),s=null!=r&&r._hex?parseInt(r._hex,16).toString():null;u={...u,balance:s}}catch(e){w.default.warn("Failed to get token balance. Error:",e)}return{...u,decimals:null===(r=u)||void 0===r||null===(r=r.decimals)||void 0===r?void 0:r.toString(10),balance:null===(s=u)||void 0===s||null===(s=s.balance)||void 0===s?void 0:s.toString(10)}}async getTokenSymbol(e){try{const t=await this.assetsContractController.getTokenStandardAndDetails(e);return null==t?void 0:t.symbol}catch(e){return null}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{const t=await this.keyringController.createNewVaultAndKeychain(e),n=await this.keyringController.getAccounts();return this.preferencesController.setAddresses(n),this.selectFirstAccount(),t}finally{t()}}async createNewVaultAndRestore(e,t){const n=await this.createVaultMutex.acquire();try{const n=r.from(t);this.preferencesController.setAddresses([]),this.permissionController.clearState(),this.snapController.clearState(),this.notificationController.clear(),this.accountTracker.clearAccounts(),this.txController.clearUnapprovedTransactions(),this.tokenDetectionController.enable();const o=await this.keyringController.createNewVaultAndRestore(e,this._convertMnemonicToWordlistIndices(n)),{chainId:a}=this.networkController.state.providerConfig,l=new S.default(this.provider),c=await this.keyringController.getAccounts();let d=c[c.length-1];for(let e=c.length;;e++){if("0x0"===await this.getBalance(d,l)){var s,i;await this.tokenDetectionController.detectTokens({selectedAddress:d});const t=null===(s=this.tokensController.state.allTokens)||void 0===s||null===(s=s[a])||void 0===s?void 0:s[d],n=null===(i=this.tokensController.state.allDetectedTokens)||void 0===i||null===(i=i[a])||void 0===i?void 0:i[d];if(0===((null==t?void 0:t.length)??0)&&0===((null==n?void 0:n.length)??0)){1!==e&&await this.removeAccount(d);break}}({addedAccountAddress:d}=await this.keyringController.addNewAccount(e))}return this.setLedgerTransportPreference(),this.selectFirstAccount(),o}finally{n()}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map((e=>Y.wordlist.indexOf(e)));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return r.from(Array.from(new Uint16Array(e.buffer)).map((e=>Y.wordlist[e])).join(" "))}getBalance(e,t){return new Promise(((n,r)=>{const s=this.accountTracker.store.getState().accounts[e];s&&s.balance?n(s.balance):t.getBalance(e,((e,t)=>{e?(r(e),w.default.error(e)):n(t||"0x0")}))}))}async submitPassword(e){await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){w.default.error("Error while unlocking extension.",e)}await this.accountsController.updateAccounts(),this.setLedgerTransportPreference()}async _loginUser(e){try{await this.submitPassword(e),await this.accountTracker.updateAccountsAllActiveNetworks()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKey(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:n}=this.keyringController.state;if(JSON.parse(n).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}selectFirstAccount(){const{identities:e}=this.preferencesController.store.getState(),[t]=Object.keys(e);this.preferencesController.setSelectedAddress(t);const[n]=this.accountsController.listAccounts();this.accountsController.setSelectedAccount(n.id)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(oe.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async getKeyringForDevice(e,t=null){var n,r,s,i;const o=null===(n=this.opts.overrides)||void 0===n?void 0:n.keyrings;let a=null;switch(e){case ie.HardwareDeviceNames.trezor:a=(null==o||null===(r=o.trezor)||void 0===r?void 0:r.type)||k.TrezorKeyring.type;break;case ie.HardwareDeviceNames.ledger:a=(null==o||null===(s=o.ledger)||void 0===s?void 0:s.type)||_.LedgerKeyring.type;break;case ie.HardwareDeviceNames.qr:a=C.MetaMaskKeyring.type;break;case ie.HardwareDeviceNames.lattice:a=(null==o||null===(i=o.lattice)||void 0===i?void 0:i.type)||v.default.type;break;default:throw new Error("MetamaskController:getKeyringForDevice - Unknown device")}let[l]=await this.keyringController.getKeyringsByType(a);if(l||(l=await this.keyringController.addNewKeyring(a)),t&&l.setHdPath&&l.setHdPath(t),e===ie.HardwareDeviceNames.lattice&&(l.appName="MetaMask"),e===ie.HardwareDeviceNames.trezor){const e=l.getModel();this.appStateController.setTrezorModel(e)}return l.network=this.networkController.state.providerConfig.type,l}async attemptLedgerTransportCreation(){const e=await this.getKeyringForDevice(ie.HardwareDeviceNames.ledger);return await e.attemptMakeApp()}async connectHardware(e,t,n){const r=await this.getKeyringForDevice(e,n);let s=[];switch(t){case-1:s=await r.getPreviousPage();break;case 1:s=await r.getNextPage();break;default:s=await r.getFirstPage()}const i=await this.keyringController.getAccounts(),o=[...new Set(i.concat(s.map((e=>e.address.toLowerCase()))))];return this.accountTracker.syncWithAddresses(o),s}async checkHardwareStatus(e,t){return(await this.getKeyringForDevice(e,t)).isUnlocked()}async forgetDevice(e){const t=await this.getKeyringForDevice(e);for(const e of t.accounts)await this.removeAccount(e);return t.forgetDevice(),!0}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case oe.KeyringType.trezor:case oe.KeyringType.lattice:case oe.KeyringType.qr:case oe.KeyringType.ledger:return"hardware";case oe.KeyringType.imported:return"imported";case oe.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){const t=await this.keyringController.getKeyringForAccount(e);switch(t.type){case oe.KeyringType.trezor:return t.getModel();case oe.KeyringType.qr:return t.getName();case oe.KeyringType.ledger:return ie.HardwareDeviceNames.ledger;case oe.KeyringType.lattice:return ie.HardwareDeviceNames.lattice;default:return undefined}}getAccountLabel(e,t,n){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${n||""}`.trim()}async unlockHardwareWalletAccount(e,t,n,r){const s=await this.getKeyringForDevice(t,n);s.setAccountToUnlock(e);const i=await this.keyringController.getAccounts(),o=await this.keyringController.addNewAccountForKeyring(s),a=await this.keyringController.getAccounts();this.preferencesController.setAddresses(a),a.forEach((n=>{if(!i.includes(n)){const i=this.getAccountLabel(t===ie.HardwareDeviceNames.qr?s.getName():t,e,r);this.preferencesController.setAccountLabel(n,i),this.preferencesController.setSelectedAddress(n);const o=this.accountsController.getAccountByAddress(n);this.accountsController.setAccountName(o.id,i)}}));const l=this.accountsController.listAccounts(),{identities:c}=this.preferencesController.store.getState();return{...o,identities:c,accounts:l}}async addNewAccount(e){const t=await this.keyringController.getAccounts(),{addedAccountAddress:n}=await this.keyringController.addNewAccount(e);return t.includes(n)||this.preferencesController.setSelectedAddress(n),n}async getSeedPhrase(e){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.exportSeedPhrase(e))}async resetAccount(){const e=this.accountsController.getSelectedAccount().address;return this.txController.wipeTransactions(!1,e),this.smartTransactionsController.wipeSmartTransactions({address:e,ignoreNetwork:!1}),this.networkController.resetConnection(),e}async getPermittedAccounts(e,{suppressUnauthorizedError:t=!0}={}){try{return await this.permissionController.executeRestrictedMethod(e,ae.RestrictedMethods.eth_accounts)}catch(e){if(t&&e.code===b.errorCodes.provider.unauthorized)return[];throw e}}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(ae.CaveatTypes.restrictReturnedAccounts,(t=>nt.CaveatMutatorFactories[ae.CaveatTypes.restrictReturnedAccounts].removeAccount(e,t)))}async removeAccount(e){this.removeAllAccountPermissions(e);const t=await this.keyringController.getKeyringForAccount(e);await this.keyringController.removeAccount(e);const n=t?await t.getAccounts():{};var r;0===(null==n?void 0:n.length)&&(null===(r=t.destroy)||void 0===r||r.call(t));return e}async importAccountWithStrategy(e,t){const{importedAccountAddress:n}=await this.keyringController.importAccountWithStrategy(e,t);this.preferencesController.setSelectedAddress(n)}getAddTransactionRequest({transactionParams:e,transactionOptions:t,dappRequest:n}){var r;return{dappRequest:n,networkClientId:(null==n?void 0:n.networkClientId)??this.networkController.state.selectedNetworkClientId,selectedAccount:this.accountsController.getAccountByAddress(e.from),transactionController:this.txController,transactionOptions:t,transactionParams:e,userOperationController:this.userOperationController,ppomController:this.ppomController,securityAlertsEnabled:null===(r=this.preferencesController.store.getState())||void 0===r?void 0:r.securityAlertsEnabled,chainId:this.networkController.state.providerConfig.chainId}}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,n){await this.txController.stopTransaction(e,t,n);return this.getState()}async createSpeedUpTransaction(e,t,n){await this.txController.speedUpTransaction(e,t,n);return this.getState()}async estimateGas(e){return new Promise(((t,n)=>new T.default(this.provider).estimateGas(e,((e,r)=>e?n(e):t(r.toString(16))))))}async updateSecurityAlertResponseByTxId(e,t){let n=!1;for(;!n;)n=te.SIGNING_METHODS.includes(e.method)?Object.values(this.signatureController.messages).find((t=>{var n;return(null===(n=t.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===e.securityAlertResponse.securityAlertId})):this.txController.state.transactions.find((t=>{var n;return(null===(n=t.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===e.securityAlertResponse.securityAlertId})),n||await new Promise((e=>setTimeout(e,100)));te.SIGNING_METHODS.includes(e.method)?this.appStateController.addSignatureSecurityAlertResponse(t):this.txController.updateSecurityAlertResponse(n.id,t)}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setUseRequestQueue(e){this.preferencesController.setUseRequestQueue(e)}setupUntrustedCommunication({connectionStream:e,sender:t,subjectType:n}){const{usePhishDetect:r}=this.preferencesController.store.getState();let s;if(s=n||(t.id&&t.id!==this.extension.runtime.id?L.SubjectType.Extension:L.SubjectType.Website),t.url){const{hostname:n}=new URL(t.url);this.phishingController.maybeUpdateState();const s=this.phishingController.test(n);if(r&&null!=s&&s.result)return this.sendPhishingWarning(e,n),void this.metaMetricsController.trackEvent({event:ue.MetaMetricsEventName.PhishingPageDisplayed,category:ue.MetaMetricsEventCategory.Phishing,properties:{url:n}})}const i=(0,qe.setupMultiplex)(e);this.setupProviderConnection(i.createStream("metamask-provider"),t,s),t.url&&this.setupPublicConfig(i.createStream("publicConfig"))}setupTrustedCommunication(e,t){const n=(0,qe.setupMultiplex)(e);this.setupControllerConnection(n.createStream("controller")),this.setupProviderConnection(n.createStream("provider"),t,L.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.store.getState();if(!t)return;const n=(0,qe.setupMultiplex)(e).createStream("metamask-phishing-safelist");n.on("data",(0,Qe.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},n))}sendPhishingWarning(e,t){(0,qe.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,Qe.default)(t,e,this.store,this.localStoreApiWrapper));const n=t=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"sendUpdate",params:[t]})};this.on("update",n);const r=()=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?r():this.once("startUISync",r),e.on("end",(()=>{this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),this.removeListener("update",n)}))}setupProviderConnection(e,t,n){let r,s;r=n===L.SubjectType.Internal?de.ORIGIN_METAMASK:n===L.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:r,extensionId:t.id,subjectType:L.SubjectType.Extension}),t.tab&&t.tab.id&&(s=t.tab.id);const o=this.setupProviderEngine({origin:r,sender:t,subjectType:n,tabId:s}),a=(0,d.createEngineStream)({engine:o}),l=this.addConnection(r,{engine:o});(0,i.default)(e,a,e,(e=>{o._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),l&&this.removeConnection(r,l),e&&w.default.error(e)}))}setupSnapProvider(e,t){this.setupUntrustedCommunication({connectionStream:t,sender:{snapId:e},subjectType:L.SubjectType.Snap})}setupProviderEngine({origin:e,subjectType:t,sender:n,tabId:r}){const s=new c.JsonRpcEngine;let i;s.push((0,je.default)({origin:e})),s.push((0,U.createSelectedNetworkMiddleware)(this.controllerMessenger)),i=this.preferencesController.getUseRequestQueue()&&this.selectedNetworkController.state.domains[e]?this.selectedNetworkController.getProviderAndBlockTracker(e):this.networkController.getProviderAndBlockTracker();const o=(0,J.createQueuedRequestMiddleware)({enqueueRequest:this.queuedRequestController.enqueueRequest.bind(this.queuedRequestController),useRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController)});s.push(o);const a=(0,g.default)(i),l=(0,m.default)(i);return l.events.on("notification",(e=>s.emit("notification",e))),ye.isManifestV3&&s.push((0,Ne.default)()),r&&s.push((0,Le.default)({tabId:r})),s.push((0,Ie.default)({origin:e})),s.push(this.permissionLogController.createMiddleware()),s.push((0,Ae.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController,this.appStateController,this.updateSecurityAlertResponseByTxId.bind(this))),s.push((0,rt.default)({trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getMetricsState:this.metaMetricsController.store.getState.bind(this.metaMetricsController.store),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController})),t===L.SubjectType.Website&&s.push((0,Fe.default)({location:n.url,registerOnboarding:this.onboardingController.registerOnboarding})),s.push((0,Oe.createMethodMiddleware)({origin:e,subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),metamaskState:this.getState(),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),startApprovalFlow:this.approvalController.startFlow.bind(this.approvalController),endApprovalFlow:this.approvalController.endFlow.bind(this.approvalController),setApprovalFlowLoadingText:this.approvalController.setFlowLoadingText.bind(this.approvalController),showApprovalSuccess:this.approvalController.success.bind(this.approvalController),showApprovalError:this.approvalController.error.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),hasPermissions:this.permissionController.hasPermissions.bind(this.permissionController,e),requestAccountsPermission:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e},{eth_accounts:{}}),requestPermissionsForOrigin:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e}),revokePermissionsForOrigin:t=>{try{this.permissionController.revokePermissions({[e]:t})}catch(e){console.log(e)}},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getCurrentRpcUrl:()=>this.networkController.state.providerConfig.rpcUrl,getNetworkConfigurations:()=>this.networkController.state.networkConfigurations,upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),setActiveNetwork:e=>{this.networkController.setActiveNetwork(e)},findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController),findNetworkConfigurationBy:this.findNetworkConfigurationBy.bind(this),getNetworkClientIdForDomain:this.selectedNetworkController.getNetworkClientIdForDomain.bind(this.selectedNetworkController),setNetworkClientIdForDomain:this.selectedNetworkController.setNetworkClientIdForDomain.bind(this.selectedNetworkController),getUseRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),getProviderConfig:()=>this.networkController.state.providerConfig,setProviderType:e=>this.networkController.setProviderType(e),getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController)})),s.push((0,H.createSnapsMethodMiddleware)(t===L.SubjectType.Snap,{getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getSnapFile:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getFile",e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),getIsLocked:()=>!this.appStateController.isUnlocked(),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),getAllSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getAll"),handleSnapRpcRequest:t=>this.handleSnapRequest({...t,origin:e}),getAllowedKeyringMethods:(0,Ce.keyringSnapPermissionsBuilder)(this.subjectMetadataController,e),createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface",e),getInterfaceState:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).state,updateInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterface",e)})),s.push(a),s.push(l.middleware),t!==L.SubjectType.Internal&&s.push(this.permissionController.createPermissionMiddleware({origin:e})),s.push(this.metamaskMiddleware),s.push((0,u.providerAsMiddleware)(i.provider)),s}setupPublicConfig(e){const t=(0,l.storeAsStream)(this.publicConfigStore);(0,i.default)(t,e,(e=>{t.destroy(),e&&w.default.error(e)}))}addConnection(e,{engine:t}){if(e===de.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const n=(0,E.default)();return this.connections[e][n]={engine:t},n}removeConnection(e,t){const n=this.connections[e];n&&(delete n[t],0===Object.keys(n).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t){const n=this.connections[e];n&&Object.values(n).forEach((e=>{e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e){const t="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async n=>{try{n.engine&&n.engine.emit("notification",await t(e))}catch(e){console.error(e)}}))}))}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,n=t.reduce(((e,{accounts:t})=>e.concat(t)),[]);n.length&&(this.preferencesController.syncAddresses(n),this.accountTracker.syncWithAddresses(n))}_onUnlock(){this.notifyAllConnections((async e=>({method:nt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!0,accounts:await this.getPermittedAccounts(e)}}))),this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.notifyAllConnections({method:nt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!1}}),this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this._notifyChainChange()}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async getPendingNonce(e,t){const{nonceDetails:n,releaseLock:r}=await this.txController.getNonceLock(e,undefined),s=n.params.highestSuggested;return r(),s}async getNextNonce(e,t){const n=await this.txController.getNonceLock(e,undefined);return n.releaseLock(),n.nextNonce}throwTestError(e){setTimeout((()=>{const t=new Error(e);throw t.name="TestError",t}))}_addTransactionControllerListeners(){const e=this.getTransactionMetricsRequest();this.controllerMessenger.subscribe("TransactionController:postTransactionBalanceUpdated",_e.handlePostTransactionBalanceUpdate.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:unapprovedTransactionAdded",(t=>(0,_e.handleTransactionAdded)(e,{transactionMeta:t}))),this.controllerMessenger.subscribe("TransactionController:transactionApproved",_e.handleTransactionApproved.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionDropped",_e.handleTransactionDropped.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionConfirmed",_e.handleTransactionConfirmed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionFailed",_e.handleTransactionFailed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionNewSwap",(({transactionMeta:e})=>this.swapsController.setTradeTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionNewSwapApproval",(({transactionMeta:e})=>this.swapsController.setApproveTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionRejected",_e.handleTransactionRejected.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionSubmitted",_e.handleTransactionSubmitted.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionStatusUpdated",(({transactionMeta:e})=>{this._onFinishedTransaction(e)}))}getTransactionMetricsRequest(){return{...{createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getSelectedAddress:()=>this.preferencesController.store.getState().selectedAddress,getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTransaction:e=>this.txController.state.transactions.find((t=>t.id===e)),getIsSmartTransaction:()=>(0,ke.getIsSmartTransaction)(this._getMetaMaskState()),getSmartTransactionByMinedTxHash:e=>this.smartTransactionsController.getSmartTransactionByMinedTxHash(e)},snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),provider:this.provider}}findNetworkConfigurationBy(e){const{networkConfigurations:t}=this.networkController.state;return Object.values(t).find((t=>Object.keys(e).some((n=>t[n]===e[n]))))||null}async setLedgerTransportPreference(){const e=window.navigator.hid?ie.LedgerTransportTypes.webhid:ie.LedgerTransportTypes.u2f,t=await this.getKeyringForDevice(ie.HardwareDeviceNames.ledger);return null!=t&&t.updateTransportMethod?t.updateTransportMethod(e).catch((e=>{throw e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e}onClientClosed(){try{this.gasFeeController.stopAllPolling(),this.appStateController.clearPollingTokens()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=de.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.store.getState()[t].forEach((e=>{this.gasFeeController.stopPollingByPollingToken(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){const e=this.platform.getExtensionURL();await this.platform.switchToAnotherURL(undefined,e)}setLocked(){return this.keyringController.setLocked()}async _onAccountChange(e){const t=(0,nt.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[n,r]of t.entries())r.includes(e)&&this._notifyAccountsChange(n,r);await this.txController.updateIncomingTransactions()}async _notifyAccountsChange(e,t){this.isUnlocked()&&this.notifyConnections(e,{method:nt.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:await this.getPermittedAccounts(e)}),this.permissionLogController.updateAccountsHistory(e,t)}async _notifyChainChange(){this.preferencesController.getUseRequestQueue()?this.notifyAllConnections((async e=>({method:nt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(e)}))):this.notifyAllConnections({method:nt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState()})}async _onFinishedTransaction(e){[Z.TransactionStatus.confirmed,Z.TransactionStatus.failed].includes(e.status)&&(await this._createTransactionNotifcation(e),this._updateNFTOwnership(e),this._trackTransactionFailure(e))}async _createTransactionNotifcation(e){const{chainId:t}=e;let n={};if(t){const{networkConfigurations:e}=this.networkController.state,r=Object.values(e).find((e=>e.chainId===t));n=(null==r?void 0:r.rpcPrefs)??{}}try{await this.platform.showTransactionNotification(e,n)}catch(e){w.default.error("Failed to create transaction notification",e)}}_updateNFTOwnership(e){var t;const{type:n,txParams:r,chainId:s}=e;if(n!==Z.TransactionType.tokenMethodTransferFrom||r===undefined)return;const{data:i,to:o,from:a}=r,l=(0,ge.parseStandardTokenTransactionData)(i),c=(0,pe.getTokenIdParam)(l)??(0,be.getTokenValueParam)(l),{allNfts:d}=this.nftController.state,u=null==d||null===(t=d[a])||void 0===t||null===(t=t[s])||void 0===t?void 0:t.find((({address:e,tokenId:t})=>(0,fe.isEqualCaseInsensitive)(e,o)&&t===c));u&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(u,!1,{userAddress:a})}_trackTransactionFailure(e){var t;const{txReceipt:n}=e,r=this.getState();n&&"0x0"===n.status&&this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:ue.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(t=e.simulationFails)||void 0===t?void 0:t.reason,numberOfTokens:r.tokens.length,numberOfAccounts:Object.keys(r.accounts).length}},{matomoEvent:!0})}_onUserOperationAdded(e){const t=this.txController.state.transactions.find((t=>t.id===e.id));t&&(t.type===Z.TransactionType.swap?this.controllerMessenger.publish("TransactionController:transactionNewSwap",{transactionMeta:t}):t.type===Z.TransactionType.swapApproval&&this.controllerMessenger.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:t}))}_onUserOperationTransactionUpdated(e){const t={...e,txParams:{...e.txParams,from:this.preferencesController.getSelectedAddress()}};this.txController.state.transactions.some((e=>e.id===t.id))||this.txController.update((e=>{e.transactions.push(t)})),this.txController.updateTransaction(t,"Generated from user operation"),this.controllerMessenger.publish("TransactionController:transactionStatusUpdated",{updatedTransactionMeta:t})}_publishSmartTransactionHook(e){const t=this._getMetaMaskState(),n=(0,ke.getIsSmartTransaction)(t);if(!n)return{transactionHash:undefined};const r=(0,ke.getFeatureFlagsByChainId)(t);return(0,ve.submitSmartTransactionHook)({transactionMeta:e,transactionController:this.txController,smartTransactionsController:this.smartTransactionsController,controllerMessenger:this.controllerMessenger,isSmartTransaction:n,featureFlags:r})}_getMetaMaskState(){return{metamask:this.getState()}}}async function Ct(e,t){var n;const{currentLocale:r}=e,{chainId:s}=this.networkController.state.providerConfig;await(0,it.updateCurrentLocale)(r),null!==(n=e.incomingTransactionsPreferences)&&void 0!==n&&n[s]?this.txController.startIncomingTransactionPolling():this.txController.stopIncomingTransactionPolling(),yt(this,kt,St).call(this,e,t),this.controllerMessenger.publish("PreferencesController:stateChange",e,[])}function St(e,t){const n=yt(this,_t,Tt).call(this,t),r=yt(this,_t,Tt).call(this,e);n!==r&&(this.tokenListController.updatePreventPollingOnNetworkRestart(!r),r?(w.default.debug("Started token list controller polling"),this.tokenListController.start()):(w.default.debug("Stopped token list controller polling"),this.tokenListController.clearingTokenListData(),this.tokenListController.stop()))}function Tt(e){const{useTokenDetection:t,useTransactionSimulations:n,preferences:r}=e??{},{petnamesEnabled:s}=r??{};return t||s||n}n.default=vt}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[94,{lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:2,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[95,{lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:3,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[96,{lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:4,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[97,{lodash:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:5,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,n={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete n.vault,delete n.walletNicknames,delete n.config.selectedAccount,n}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}]],[],{});