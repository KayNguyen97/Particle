import{c as B,l as process,m as M,o as K}from"./chunk-6V2G2Z5W.js";var $=B((b,L)=>{M();K();(function(U,T){typeof b=="object"&&typeof L=="object"?L.exports=T():typeof define=="function"&&define.amd?define([],T):typeof b=="object"?b._prohibitedMonitor=T():U._prohibitedMonitor=T()})(b,function(){return function(){"use strict";var x={"./packages/monitor/src/amp/helper.js":function(h,g,c){c.r(g),c.d(g,{getAmplitudeAPIKey:function(){return t},getAmplitudeProject:function(){return e},isInstanceInitialized:function(){return a},logSignUpComplete:function(){return d},setInstanceIdentity:function(){return s}});var f=c("./packages/monitor/src/common/variables.js"),p=c("./packages/monitor/src/common/constants.js");let a=r=>{var l;let{amplitude:o}=window;if(!o)return!1;let u=o.getInstance(r);return u==null||(l=u.options)===null||l===void 0?void 0:l.apiKey},d=r=>{let{signUpCompleted:l}=sessionStorage;l&&(r.logEvent("signup_completed"),sessionStorage.removeItem("signUpCompleted"))},e=r=>r||(f.default.isOKLink()?p.default.AMPLITUDE_PROJECT.oklink:f.default.isOKEx()||f.default.isInExtension()?p.default.AMPLITUDE_PROJECT.okx:p.default.AMPLITUDE_PROJECT.okcoin),t=r=>{var l;let o=f.default.isProdEnv(),u=(l=p.default.AMPLITUDE_KEY_MAP)===null||l===void 0?void 0:l[r];return u?o?u==null?void 0:u.prod:u==null?void 0:u.dev:""},s=(r,l)=>{let{uid:o}=f.default.getEnv();return r.setDeviceId(o||""),l===p.default.AMPLITUDE_PROJECT.web3?r.setUserId(o||""):f.default.getTk().then(u=>{r.setUserId(u||"")}),r}},"./packages/monitor/src/amplitude.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/monitor.js"),p=c("./packages/monitor/src/common/variables.js"),a=c("./packages/monitor/src/common/event-bus.js"),d=c("./packages/monitor/src/libs-amplitude.js"),e=c("./packages/monitor/src/amp/helper.js");let t,s={RESOLVE:"RESOLVE",REJECT:"REJECT"},r={__initQueue__:Promise.resolve(!0),events:new a.default,getAmplitudeSDKInstance(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise((o,u)=>{this.events.on(s.RESOLVE,n=>{o(n)}),this.events.on(s.REJECT,n=>{u(n)}),this.getInstance(l)})},getInstance(l){let o=(0,e.getAmplitudeProject)(l);return t&&clearTimeout(t),new Promise((u,n)=>{if(!(0,e.isInstanceInitialized)(o)){this.__initQueue__=this.__initQueue__.then(()=>this.__initInstance__(o)).then(m=>{u(m)}).catch(m=>{n(m)});return}let{amplitude:i}=window;if(i){let m=i.getInstance(o);(0,e.logSignUpComplete)(m),m.options&&this.events.emit(s.RESOLVE,m),u(m)}})},__initInstance__(l){let o=(0,e.getAmplitudeProject)(l);return new Promise(u=>{window.amplitude||(0,d.default)();let n=window.amplitude.getInstance(o);if((0,e.isInstanceInitialized)(o))u(n);else{let i={includeUtm:!0,includeReferrer:!0,includeGclid:!0,logAttributionCapturedEvent:!0,language:p.default.getOkGlobal().locale};f.default.apiEndpoint?i.apiEndpoint=f.default.apiEndpoint:(p.default.isOKEx()||p.default.isOKLink())&&(i.apiEndpoint=`${window.location.host}/amplitude`,i.forceHttps=!1);let m=(0,e.getAmplitudeAPIKey)(o);n.init(m,null,i,E=>{this.events.emit(s.RESOLVE,E),(0,e.setInstanceIdentity)(E,o),sessionStorage.channelId&&E.setUserProperties({channel_id:sessionStorage.channelId}),sessionStorage.ampCacheEvents&&(JSON.parse(sessionStorage.ampCacheEvents).forEach(I=>{E.logEvent(...I)}),sessionStorage.ampCacheEvents=""),(0,e.logSignUpComplete)(E),u(E)})}})}};p.default.isInBrowser()&&!p.default.shouldIgnoreAmpEvent()&&(t=setTimeout(()=>{t=0,r.getInstance()},5e3)),g.default=r},"./packages/monitor/src/common/constants.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/variables.js");let p="";if(f.default.isInBrowser()){let{cdnBaseUrl:e="//static.coinall.ltd"}=f.default.getOkGlobal();p=e}let a={okx:"okx",oklink:"oklink",web3:"web3",okcoin:"okcoin"},d={[a.okx]:{prod:"56bf9d43d57f079e506b4f26c70a698f",dev:"1baf4c48da921e60512f74d455f02da8"},[a.oklink]:{prod:"d77757dff7616a060069e378595de0f7",dev:"d77757dff7616a060069e378595de0f7"},[a.web3]:{prod:"669cbf122dec17ceb8e68a78c8240d24",dev:"2f69d358792107218343f78d2488e305"},[a.okcoin]:{prod:"21c676d501be3d648464d7ae0038cd53",dev:"69ec37219ff98b032d9e1a1d3bd81de7"}};g.default={Actions:{CLICK:"clk",EXPOSE:"xps"},Configs:{ATTR_CLICK:"data-clk",ATTR_EXPOSE:"data-xps",ATTR_LISTEN:"data-lsn",EXPOSE_DURATION:500},REQUEST_LONG_WAIT_TIME:1e3,PERF_REPORT_DEFER_TIME:5e3,AMPLITUDE_PROJECT:a,AMPLITUDE_KEY_MAP:d,CDN_BASE_URL:p,MILLISECONDS_OF_30_DAYS:2592e6,YESTERDAY:-864e5,WEB3CATEGORY:["onchain","web3_homepage","wallet","web3_trade","nft","web3_discover","web3_invest","okc","onchain_data"]}},"./packages/monitor/src/common/cookie.js":function(h,g,c){c.r(g);let f=a=>{try{let d=document.cookie.split(";"),e=null;for(let t=0;t<d.length;t++){let s=d[t];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(a)===0){e=s.substring(a.length+1,s.length);break}}return e}catch{return null}},p=function(a,d){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{expirationDays:365},t=d!==null?e.expirationDays:-1;if(t){let r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3),t=r}let s=`${a}=${d}`;t&&(s+=`; expires=${t.toUTCString()}`),s+="; path=/",document.cookie=s};g.default={set:p,get:f}},"./packages/monitor/src/common/event-bus.js":function(h,g,c){c.r(g);class f{constructor(){this.listeners={}}on(a,d,e){let t=[],s=arguments.length;for(let r=0;r<s;r++)t.push(arguments[r]);t=t.length>3?t.splice(3,t.length-1):[],typeof this.listeners[a]<"u"?this.listeners[a].push({scope:e,callback:d,args:t}):this.listeners[a]=[{scope:e,callback:d,args:t}]}remove(a,d,e){if(typeof this.listeners[a]<"u"){let t=this.listeners[a].length,s=this.listeners[a].slice(0);for(let r=0;r<t;r++){let l=s[r];l.scope==e&&l.callback==d&&this.listeners[a].splice(r,1)}}}has(a,d,e){if(typeof this.listeners[a]<"u"){let t=this.listeners[a].length;if(d===void 0&&e===void 0)return t>0;for(let s=0;s<t;s++){let r=this.listeners[a][s];if((e?r.scope==e:!0)&&r.callback==d)return!0}}return!1}emit(a){if(typeof this.listeners[a]<"u"){let s=this.listeners[a].slice(),r=s.length;for(var d=arguments.length,e=new Array(d>1?d-1:0),t=1;t<d;t++)e[t-1]=arguments[t];for(let l=0;l<r;l++){let o=s[l];if(o&&o.callback){let u=e.concat(o.args);o.callback.apply(o.scope,u)}}}}}g.default=f},"./packages/monitor/src/common/seo.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/utils.js");let p=[{keyword:"baidu.com",type:"BaiduSEO"},{keyword:"google",type:"GoogleSEO"},{keyword:"yandex.com",type:"yandexSEO"},{keyword:"yahoo",type:"yahooSEO"},{keyword:"so.com",type:"360SEO"},{keyword:"bing.com",type:"bingSEO"},{keyword:"sogou.com",type:"sogouSEO"},{keyword:"m.sm.cn",type:"smSEO"},{keyword:"naver.com",type:"naverSEO"}];g.default={getSeoType(){let a=f.default.getUrlDomain(document.referrer);for(let d=0;d<p.length;d++){let{keyword:e,type:t}=p[d];if(a.indexOf(e)>-1)return t}return""}}},"./packages/monitor/src/common/statex.js":function(h,g,c){c.r(g),c.d(g,{default:function(){return f}});function f(p){let a,d=new Set,e=(o,u)=>{let n=typeof o=="function"?o(a):o;if(n!==a){let i=a;a=(u!=null?u:typeof n!="object")?n:Object.assign({},a,n),d.forEach(m=>m(a,i))}},t=()=>a,l={setState:e,getState:t,subscribe:o=>(d.add(o),()=>d.delete(o)),destroy:()=>d.clear()};return a=p(e,t,l),l}},"./packages/monitor/src/common/utils.js":function(h,g,c){c.r(g);let f=/([^{]+)({.+})?/,p=/^{|}$/g,a=/^['"]|['"]$/g,d=/\/\/([^/]+)\//;g.default={serializeParams(e){let t=[],s=Object.keys(e);for(let r=0,l=s.length;r<l;r++){let o=s[r];t.push(`${encodeURIComponent(o)}=${encodeURIComponent(e[o])}`)}return t.join("&")},getUrlDomain(e){let t=e.match(d);return t?t[1]:""},getUrlQuery(e){return this.getParsedUrl(window.location.href).searchParams.get(e)||""},getParsedUrl(e){return new URL(e)},getChannelIdByUserAgent(){var e,t;let s=/channelId\/(\w+)/,r=(e=window.navigator.userAgent)===null||e===void 0||(t=e.match)===null||t===void 0?void 0:t.call(e,s);return r==null?void 0:r[1]},getChannelContext(e){let t={channelId:"",referralSrc:""};if(!e)return t;let s="",r="";if(e.searchParams.forEach((m,E)=>{let _=E.toLowerCase();_==="channelid"&&(s=m),_==="channelflag"&&(r=m)}),t.channelId=s||r,t.channelId)return t;let l="/join";if(e.pathname.endsWith(l)||!e.pathname.includes(l))return t;let o=e.pathname.split(`${l}/`)[1];if(!o)return t;let u=o.split("/")[0];if(u.startsWith("-"))return t;let n=u.split("-"),i=n[n.length-2]||"";return s=n[n.length-1],s&&(t.referralSrc=i,t.channelId=s),t},getOriginalUrl(e){return e.replace(/([?&])t=\d+(&)?/,(t,s,r)=>s&&r?s===r?"&":"?":"")},setCookie(e,t,s){let r=new Date;r.setTime(r.getTime()+s),document.cookie=`${e}=${encodeURIComponent(t)};expires=${r.toGMTString()};path=/`},getCookie(e){let t=new RegExp(`(^| )${e}=([^;]*)(;|$)`),s=document.cookie.match(t);return s?decodeURIComponent(s[2]):""},parseTarget(e){let t=e.match(f),s={key:"",data:{}};if(t){let r=t[1],l=t[2],o={};l&&l.replace(p,"").split(",").forEach(n=>{let i=n.split(":");i=i.map(_=>_.trim().replace(a,""));let[m,E]=i;o[m]=E}),s.key=r,s.data=o}return s},matchType(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`},isArray(e){return this.matchType(e,"Array")},isObject(e){return this.matchType(e,"Object")},isInArray(e,t){if(Array.prototype.includes)return e.includes(t);for(let s=0,r=e.length;s<r;s++)if(e[s]===t)return!0;return!1},generateUUID(){let e=Date.now()+window.performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let s=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="x"?s:s&3|8).toString(16)})},valueExists(e){return e!=null&&e!==""},passedNamingCheck(e){return!/[^a-z0-9_]/.test(e)},toFixed(e){return Number(e.toFixed(4))},toUnderLineFormat(e){return e.replace(/([A-Z])/g,(t,s,r)=>r===0?`${s.toLowerCase()}`:`_${s.toLowerCase()}`)},filterXSS(e){let t=/</g,s=/>/g,r=/'/g,l=/"/g;return e.replace(t,"&lt;").replace(s,"&gt;").replace(r,"&#39;").replace(l,"&#34;")},merge(e,t){let s={};return Object.keys({...e,...t}).forEach(r=>{if(t[r]!=null||e[r]!=null){var l;s[r]=(l=t[r])!==null&&l!==void 0?l:e[r]}}),s},base64Id(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",t="";for(let s=0;s<22;++s)t+=e.charAt(Math.floor(Math.random()*64));return t},isTargetingCookiesRejected(){if(typeof window>"u"||typeof window.OnetrustActiveGroups>"u")return!1;try{return!window.OnetrustActiveGroups.includes("C0004")}catch{return!1}}}},"./packages/monitor/src/common/variables.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/utils.js"),p=c("./packages/monitor/src/store.js");let a="oklink",d="okx_tr",e="okex",t=typeof window<"u",s=Boolean(typeof window>"u"||typeof process<"u"&&{NODE_ENV:"production",ASSETS_BUILD_TYPE:void 0,ASSETS_BUILD_VERSION:void 0}.SSR_ENV),r=t?/OKApp\/\(\S+\/\S+\)/i.test(navigator.userAgent):!1,l=!0,o={_expires:{}},u={};if(t){u=window._okGlobal||window.okGlobal||{};let i=u.broker&&u.broker.is,m=localStorage.simulatedTrading==="1",{okjp:E}=u.site&&u.site.is||{};l=i||m||E===!0;let{ok_monitor:I='{ "_expires": {} }'}=localStorage;o=JSON.parse(I)}let n={};g.default={setEnv(i){var m,E;let{screen:_}=window,{_tk:I}=localStorage,v=(m=window.utils.ont)===null||m===void 0||(E=m.getDeviceId)===null||E===void 0?void 0:E.call(m),{deviceId:O}=p.default.getState(),{systemLanguage:A,language:S}=navigator,{referrer:P}=document;n.site=this.getSiteInfo(),n.lcl=f.default.getCookie("locale"),P&&(P.length>256&&(P=P.substr(0,256)),n.rf=P),I&&(n.tk=I),n.uid=O||v,n.lan=(A||S).toLowerCase();let C="0x0";if(_){let{width:k,height:w}=_;C=`${k}x${w}`}n.scr=C;let D=f.default.getCookie("first_ref");D&&(D.length>256&&(D=D.substr(0,256)),n.frf=D)},getEnv(){return n},isInApp(){return r},toLocalStorage(i){let{key:m,value:E,maxAge:_}=i;o[m]=E,o._expires[m]=Date.now()+_,localStorage.ok_monitor=JSON.stringify(o)},removeLocalStorage(i){delete o[i],delete o._expires[i],localStorage.ok_monitor=JSON.stringify(o)},getClientValue(i){let m=sessionStorage.getItem(i);return m||this.getValueFromLocalStorage(i)},getValueFromLocalStorage(i){return Date.now()<o._expires[i]&&o[i]||""},syncUpLocalStorageToSessionStorage(i){if(sessionStorage.getItem(i))return;let m=this.getValueFromLocalStorage(i);m&&sessionStorage.setItem(i,m)},shouldIgnoreAmpEvent(){return l},__getOkGlobalSite(){return u.site||{}},__getOkGlobalSiteIs(){return this.__getOkGlobalSite().is||{}},getSiteInfo(){return this.isOKExTR()?d:this.__getOkGlobalSite().sign||e},isOKExTR(){return this.__getOkGlobalSiteIs().TR===!0},isOKExGlobal(){return this.__getOkGlobalSite().sign===e},isOKEx(){return this.isOKExGlobal()||this.isOKExTR()},isOKLink(){let i=this.__getOkGlobalSite();return i.sign===a||i.sign===e&&i.linkInOKX},isInSSR(){return s},isInBrowser(){return t},isInExtension(){return window.inOKXExtension||window.inUIOKXExtension},isInDesktop(){var i;return(i=window)===null||i===void 0||(i=i.navigator)===null||i===void 0||(i=i.userAgent)===null||i===void 0||(i=i.toLocaleLowerCase())===null||i===void 0?void 0:i.includes("electron/")},isDevTestEnv(){return this.isInExtension()?window.ASSETS_BUILD_TYPE!=="publish":["pre","prod"].indexOf(u.envSign)<0},isProdEnv(){return this.isInExtension()?window.ASSETS_BUILD_TYPE==="publish":u.envSign==="prod"},getOkGlobal(){return u},isEnableAMP(){return this.isProdEnv()||sessionStorage.getItem("monitor_amplitude_enable_for_test")==="true"},getTk(){return r&&window.jsbridge?window.jsbridge.getTK().then(i=>i||localStorage._tk||"").catch(()=>{}):Promise.resolve(localStorage._tk||"")}}},"./packages/monitor/src/error.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/variables.js");let p=f.default.isInBrowser()?JSON.parse(localStorage.__error__||"[]"):[];g.default={getErrorInfo(a){let{message:d,filename:e,lineno:t,colno:s,error:r}=a,l="";r&&r.stack?(l=r.stack,l.indexOf("@")!==-1&&(l=`${d} 
\r ${l}`)):(r||d)&&(l=`ThrowError: ${JSON.stringify(r||d)} 
\r at ${e}: ${t}: ${s}`);let o=encodeURIComponent(window.location.href);return{msg:d,file:e,line:t,col:s,stack:l,url:o}},isReported(a){let{file:d,line:e,col:t}=a,s=`${d}__${e}__${t}`;return p.includes(s)},rememberError(a){let{file:d,line:e,col:t}=a,s=`${d}__${e}__${t}`;p.unshift(s),p.length>50&&p.pop(),setTimeout(()=>{localStorage.__error__=JSON.stringify(p)},0)}}},"./packages/monitor/src/global/attrs.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/global/click.js"),p=c("./packages/monitor/src/global/expose.js"),a=c("./packages/monitor/src/common/constants.js");let{Configs:d}=a.default;g.default={listen(e){let t=s=>{e.logEvent({...s,category:"ok"})};this.preprocess(),f.default.listen(t,this),p.default.listen(t,this)},preprocess(){document.querySelectorAll(`[${d.ATTR_LISTEN}]`).forEach(t=>{let s=t.getAttribute(d.ATTR_LISTEN),r=s.indexOf(":");if(r>-1){let l=s.substring(0,r).trim(),o=s.substring(r+1).trim();l.split("+").forEach(n=>{t.setAttribute(`data-${n.trim()}`,o)}),t.removeAttribute(d.ATTR_LISTEN)}})}}},"./packages/monitor/src/global/click.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/utils.js"),p=c("./packages/monitor/src/common/constants.js");let{Actions:a,Configs:d}=p.default;g.default={listen(e,t){document.addEventListener("click",s=>{let{target:r}=s;r.getAttribute(d.ATTR_LISTEN)&&t.preprocess();let o=r.getAttribute(d.ATTR_CLICK);if(o){let u=f.default.parseTarget(o),{key:n,data:i}=u;n&&e({target:n,action:a.CLICK,params:i,extras:{area:i.area}})}})}}},"./packages/monitor/src/global/expose.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/utils.js"),p=c("./packages/monitor/src/common/constants.js");let a={},{Actions:d,Configs:e}=p.default;g.default={listen(t){this.trackFn=t;let s={threshold:[.5,1]},r=new window.IntersectionObserver(this.onSectionChange.bind(this),s);document.querySelectorAll(`[${e.ATTR_EXPOSE}]`).forEach(o=>{r.observe(o)}),this.observer=r},onSectionChange(t){t.forEach(s=>{let{target:r,isIntersecting:l}=s,o=r.getAttribute(e.ATTR_EXPOSE),u=f.default.parseTarget(o),{key:n,data:i}=u,m=Number(s.time.toFixed(2));if(l){let E=setTimeout(()=>{let _=a[n],I=r.getBoundingClientRect(),{innerHeight:v,innerWidth:O}=window,{top:A,bottom:S,left:P,right:C}=I;if((A>=0&&A<=v||S>=0&&S<=v)&&(P>=0&&P<=O||C>=0&&C<=O)){let{area:k,elementType:w,actionType:y}=i;delete i.area,delete i.elementType,delete i.actionType,this.trackFn({target:n,action:d.EXPOSE,params:{...i,time:m},extras:{area:k},actionType:y||"Show",elementType:w,anchor:w?n:""}),this.observer.unobserve(r),_.forEach(j=>{window.clearTimeout(j)}),delete a[n]}else _.shift()},e.EXPOSE_DURATION);a[n]||(a[n]=[]),a[n].push(E)}})}}},"./packages/monitor/src/libs-amplitude.js":function(h,g,c){c.r(g),c.d(g,{default:function(){return p}});var f=c("./packages/monitor/src/common/variables.js");function p(){let{envSign:a,cdnBaseUrl:d}=f.default.getOkGlobal(),e=window.amplitude||{_q:[],_iq:{}},t=document.createElement("script");t.type="text/javascript",t.crossOrigin="anonymous",t.async=!0;let s="";switch(a){case"dev":s="cdndev";break;case"pre":s="cdnpre";break;case"daily":s="cdn";break;case"prod":s="cdn";break;default:s="cdn";break}f.default.isInExtension()?(t.integrity="sha384-pOU6BcU7Xl8BUN1qGu7OTKvbAUHiErbL8FdKEnAhCwR47UmKCyC5mOM9Nqxe02PR",t.src="./scripts/lib/amplitude-8.2.3-min.gz.js"):d?(t.src=`${d}/${s}/assets/okfe/libs/monitor/amplitude-okx-8.21.8.min.js`,t.integrity="sha384-ATgbJ2zDjulTgephpcvQJOOMESYqq8o5Ep+hws0LXCAm9qr07fUtUfvuYN52bSGI"):(t.src="https://cdn.amplitude.com/libs/amplitude-8.21.8-min.gz.js",t.integrity="sha384-QahB0HKETlcqjneomU3Ohs+UgJTinhUNFIKJitEl2Vo7DjvphO2jei64ZP5J2GA5"),t.onload=function(){window.amplitude.runQueuedFunctions||console.log("[Amplitude] Error: could not load SDK")};let r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r);function l(_,I){_.prototype[I]=function(){return this._q.push([I].concat(Array.prototype.slice.call(arguments,0))),this}}let o=function(){return this._q=[],this},u=["add","append","clearAll","prepend","set","setOnce","unset"];for(let _=0;_<u.length;_++)l(o,u[_]);e.Identify=o;let n=function(){return this._q=[],this},i=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"];for(let _=0;_<i.length;_++)l(n,i[_]);e.Revenue=n;let m=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","enableTracking","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId","groupIdentify","onInit","logEventWithTimestamp","logEventWithGroups","setSessionId","resetSessionId"];function E(_){function I(v){_[v]=function(){_._q.push([v].concat(Array.prototype.slice.call(arguments,0)))}}for(let v=0;v<m.length;v++)I(m[v])}E(e),e.getInstance=function(_){return _=(!_||_.length===0?"$default_instance":_).toLowerCase(),e._iq.hasOwnProperty(_)||(e._iq[_]={_q:[]},E(e._iq[_])),e._iq[_]},window.amplitude=e}},"./packages/monitor/src/logger.js":function(h,g,c){c.r(g),c.d(g,{default:function(){return s}});var f=c("./packages/monitor/src/common/utils.js"),p=c("./packages/monitor/src/common/variables.js"),a=c("./packages/monitor/src/common/cookie.js");let d=null,e=!1;class t{constructor(l){p.default.setEnv(l)}logPV(){if(!e){let l={_act:"_pv",_ct:"_pv",_action_type:"Show",_element_type:"Page",...this._getCommonData()};this.sendLogs(l),e=!0}}logEvent(l){let o={},{category:u,action:n,target:i,params:m,extras:E,_m:_,anchor:I,elementType:v,actionType:O,tk:A}=l;if(Object.assign(o,{_ct:u,_act:n,_lb:encodeURIComponent(i||""),_anchor_en_name:encodeURIComponent(I||""),_element_type:encodeURIComponent(v||""),_action_type:encodeURIComponent(O||""),...this._getCommonData()}),o._tk=A||o._tk,f.default.isArray(m)){let S=0,P=0;m.forEach((C,D)=>{if(f.default.isObject(C)){let{value:k,random:w}=C,y=encodeURIComponent(k);w?o[`_unlist${P++}`]=y:o[`_reser${S++}`]=y}else o[`_reser${D}`]=encodeURIComponent(C)})}else if(f.default.valueExists(m)){let S=m;f.default.isObject(m)&&(S=JSON.stringify(m));let P=encodeURIComponent(S);o._v=P,o._reser0=P}if(E){E.page=encodeURIComponent(window.location.href);let S={};Object.keys(E).forEach(P=>{S[`__${P}`]=E[P]}),Object.assign(o,S)}return _&&(o._m=_),this.sendLogs(o)}_getCommonData(){let l={...p.default.getEnv()};localStorage._tk&&(l.tk=localStorage._tk);let{src:o,sessionId:u=""}=sessionStorage,n=p.default.getClientValue("pageId"),i=p.default.getClientValue("channelId"),{deviceId:m=f.default.base64Id(),eventId:E=1,sequenceNumber:_=1}=JSON.parse(a.default.get("_monitor_extras")||"{}");a.default.set("_monitor_extras",JSON.stringify({deviceId:m,eventId:E+1,sequenceNumber:_+1}));let I=JSON.stringify({_amp_rejected:f.default.isTargetingCookiesRejected(),_device_id:m,_event_id:E,_sequence_number:_,_uuid:f.default.generateUUID()}),v={_cid:i,_pgid:n,_source:o,_session_id:encodeURIComponent(u.slice(0,256)),_page_url:encodeURIComponent(window.location.href.slice(0,256)),_extras:I};return Object.keys(l).forEach(O=>{v[`_${O}`]=encodeURIComponent(l[O])}),v}sendLogs(l){let o=[];if(Object.keys(l).forEach(u=>{let n=l[u];f.default.valueExists(n)?o.push(`${u}=${n}`):delete l[u]}),p.default.isDevTestEnv()){let{console:u}=window;return u.groupCollapsed(`dev monitor: ${l._ct} > ${l._act}`),u.log(decodeURIComponent(JSON.stringify(l,null,2))),u.groupEnd(),Promise.resolve()}return p.default.isInApp()&&window.jsbridge?window.jsbridge.getTK().then(u=>{if(u){let n=`_tk=${encodeURIComponent(u)}`,i=o.findIndex(m=>/^_tk/.test(m));i>-1?o[i]=n:o.push(n)}return this.addClientInfo(o.join("&"))}).catch(()=>this.addClientInfo(o.join("&"))):this.addClientInfo(o.join("&"))}addClientInfo(l){let o=`&_ts=${Date.now()}&_r=${Math.floor(Math.random()*2147483648)}`,u=`?${l}${o}`;return p.default.isInApp()&&window.jsbridge?window.jsbridge.getClientInfo().then(n=>{let i=n?`&_app_info=${encodeURIComponent(n)}`:"";return u=`?${l}${i}${o}`,this.sendRequest(u)}).catch(n=>this.sendRequest(u)):this.sendRequest(u)}sendRequest(l){return new Promise(o=>{if(navigator.sendBeacon&&!p.default.isInExtension())navigator.sendBeacon(`/jsstat/${p.default.isOKLink()?"oklink":"sb"}${l}`),o();else{let u=!1,n=new Image;n.onload=()=>{u||(o(),u=!0)},n.src=p.default.isInExtension()?`https://www.oklink.com/jsstat/s.gif${l}`:`/jsstat${p.default.isOKLink()?"/oklink":""}/s.gif${l}`,setTimeout(()=>{u||(o(),u=!0)},150)}})}}function s(r){return d||(d=new t(r),d)}},"./packages/monitor/src/monitor.js":function(h,g,c){c.r(g),c.d(g,{default:function(){return o}});var f=c("./packages/monitor/src/common/utils.js"),p=c("./packages/monitor/src/common/constants.js"),a=c("./packages/monitor/src/common/variables.js"),d=c("./packages/monitor/src/error.js"),e=c("./packages/monitor/src/logger.js"),t=c("./packages/monitor/src/global/attrs.js"),s=c("./packages/monitor/src/amplitude.js"),r=c("./packages/monitor/src/store.js");let l=!1;class o{constructor(n){a.default.isInSSR()||(this.commonParams=n.commonParams||{},this._logger=(0,e.default)(n),this._category=n.product,n.withPV&&this._logger.logPV(),l||(this._initEventListener(),l=!0))}setApiEndpoint(n){if(/^https?:\/\//.test(n))throw new Error('The content of the URL can not include protocol type as a substring such as "http://" or "https://".');o.apiEndpoint=n}report(n){let{type:i,value:m}=n;if(a.default.isInSSR())return Promise.resolve();let E=m;return(f.default.isObject(E)||f.default.isArray(E))&&(E=JSON.stringify(E)),this._logger.logEvent({category:"performance",action:i,params:E})}logPV(){this._logger.logPV()}logAmplitudeEvent(n,i,m){if(a.default.isInSSR()||a.default.shouldIgnoreAmpEvent())return Promise.resolve();let E="",_=!1;f.default.isObject(m)&&(E=m.ampProject,_=m.ignoreBackUp);let I={};for(let v in i)Object.prototype.hasOwnProperty.call(i,v)&&(I[v]=i[v]);if(I.monitor_after_navigation){delete I.monitor_after_navigation;let v=JSON.parse(sessionStorage.ampCacheEvents||"[]");return v.push([n,I]),sessionStorage.ampCacheEvents=JSON.stringify(v),Promise.resolve()}return s.default.getInstance(E).then(v=>{v.logEvent(n,{...I,site:a.default.getSiteInfo()}),_||this.act(n,i,{isSyncAMP:!1})})}resetAmplitudeUser(){return a.default.isInSSR()?Promise.resolve():s.default.getInstance().then(n=>(n.setUserId(null),n.regenerateDeviceId(),Promise.resolve()))}track(n,i,m,E){if(a.default.isInSSR())return Promise.resolve();let _={category:this._category,action:m,target:i,params:E,extras:{area:n}};if(f.default.isObject(n)){let{area:I,action:v,target:O,params:A}=n;Object.assign(_,{action:v,target:O,params:A,extras:{area:I}})}return this._logger.logEvent(_)}async act(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isSyncAMP:!0};if(a.default.isInSSR())return Promise.resolve();let{user_id:E,..._}=this.commonParams||{},I={web_mode_okx:f.default.isInArray(p.default.WEB3CATEGORY,this._category)?"wallet":"exchange"},O=Object.assign({},a.default.isOKEx()?I:{}),A=(m==null?void 0:m.tk)||E,S={category:this._category,params:i,_m:"1"};f.default.isObject(i)&&(S.params=f.default.merge({..._,...O},i),O=f.default.merge(a.default.isOKLink()?{..._,...O}:O,i));let P;typeof n=="string"?(P=n,S.action=n):(P=n.action||n.anchor,S.action=P,S.anchor=n.anchor,S.actionType=n.actionType,S.elementType=n.elementType,S={...S,params:f.default.merge(S.params,n.params||{})},A=n.tk||A,O=f.default.merge(O,n.params)),S.tk=A;let{needDurationActions:C,needDurationActionParams:D,actionTriggerTimes:k,setActionTriggerTimes:w,setNeedDurationActionParams:y}=r.default.getState();if(a.default.isEnableAMP()&&m!==null&&m!==void 0&&m.isSyncAMP){let j=n==null?void 0:n.ampProject;this.logAmplitudeEvent(P,O,{ampProject:j,ignoreBackUp:!0})}return f.default.isInArray(C,P)?(k[P]=Date.now(),w(k),D[P]=S,y(D),Promise.resolve("The event will be reported when the page is closed")):this._logger.logEvent(S)}_initEventListener(){window.addEventListener("load",()=>{t.default.listen(this._logger)}),window.addEventListener("error",n=>{let i=d.default.getErrorInfo(n);d.default.isReported(i)||(this._logger.logEvent({category:"error",action:"report",extras:i}),d.default.rememberError(i))},!0),window.addEventListener("beforeunload",()=>{let{needDurationActions:n,needDurationActionParams:i,actionTriggerTimes:m,setNeedDurationActions:E,setNeedDurationActionParams:_,setActionTriggerTimes:I}=r.default.getState();n.length&&n.forEach(v=>{i[v].params.duration=Date.now()-m[v],this._logger.logEvent(i[v])}),E([]),_({}),I({})})}initABTest(n){let i="ab_experiment";n!=null&&n.exper_flagKey&&n!==null&&n!==void 0&&n.exper_variant&&(Object.assign(this.commonParams,n),this.act(i))}setCommonParams(n){this.commonParams={...this.commonParams,...n}}triggerReportDuration(n){let{needDurationActions:i,setNeedDurationActions:m}=r.default.getState();f.default.isInArray(i,n)||(i.push(n),m(i))}}},"./packages/monitor/src/store.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/statex.js");let p=(0,f.default)(a=>({deviceId:"",needDurationActions:[],needDurationActionParams:{},actionTriggerTimes:{},setDeviceId:d=>a(()=>({deviceId:d})),setNeedDurationActions:d=>a(()=>({needDurationActions:d})),setNeedDurationActionParams:d=>a(()=>({needDurationActionParams:d})),setActionTriggerTimes:d=>a(()=>({actionTriggerTimes:d}))}));g.default=p},"./packages/monitor/src/web.js":function(h,g,c){c.r(g);var f=c("./packages/monitor/src/common/constants.js"),p=c("./packages/monitor/src/common/seo.js"),a=c("./packages/monitor/src/common/utils.js"),d=c("./packages/monitor/src/monitor.js"),e=c("./packages/monitor/src/common/variables.js"),t=c("./packages/monitor/src/amplitude.js"),s=c("./packages/monitor/src/store.js");let{MILLISECONDS_OF_30_DAYS:r}=f.default,l=(o,u)=>{if(e.default.isInSSR())return;let{pathname:n}=window.location;sessionStorage.channelId=o,e.default.toLocalStorage({key:"channelId",value:o,maxAge:r}),u?(sessionStorage.referralSrc=u,e.default.toLocalStorage({key:"referralSrc",value:u,maxAge:r})):(sessionStorage.removeItem("referralSrc"),e.default.removeLocalStorage("referralSrc")),sessionStorage.pageId=n,e.default.toLocalStorage({key:"pageId",value:n,maxAge:r})};g.default={monitor:{get amplitude(){return e.default.isInSSR()?{getAmplitudeSDKInstance(){return new Promise((u,n)=>{n("Currently not a browser environment!")})}}:t.default},newInstance(o){return e.default.isInSSR()?{setApiEndpoint(){},report(){return Promise.resolve()},logPV(){return Promise.resolve()},logAmplitudeEvent(){return Promise.resolve()},resetAmplitudeUser(){return Promise.resolve()},track(){return Promise.resolve()},act(){return Promise.resolve()},_initEventListener(){},initABTest(){return Promise.resolve()},setCommonParams(){},triggerReportDuration(){}}:new d.default(o)},saveChannelId(o){l(o)},getChannelId(){return sessionStorage.channelId},setDeviceId(o){let{setDeviceId:u}=s.default.getState();u(o)},getChannelContextFromUrl(o){return a.default.getChannelContext(a.default.getParsedUrl(o))}},parseUrl(){let o=a.default.getParsedUrl(window.location.href),u=o.searchParams.get("src");u&&sessionStorage.setItem("src",u),this.parseChannelId(o)},parseChannelId(o){let u=a.default.getChannelIdByUserAgent(),n=p.default.getSeoType(),i=a.default.getChannelContext(o),m=i.channelId,E=i.referralSrc;if(e.default.isInDesktop()&&u&&(m=u,E=""),!m&&n&&(m=n),m=a.default.filterXSS(m),m){l(m,E);return}e.default.syncUpLocalStorageToSessionStorage("channelId"),sessionStorage.getItem("channelId")&&(e.default.syncUpLocalStorageToSessionStorage("referralSrc"),e.default.syncUpLocalStorageToSessionStorage("pageId"))},init(){if(!e.default.isInSSR()){if(this.parseUrl(),!a.default.getCookie("first_ref")&&document.referrer&&a.default.setCookie("first_ref",document.referrer,r),sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",window.location.href),!window.IntersectionObserver){let o=document.createElement("script");o.src=`${f.default.CDN_BASE_URL}/cdn/assets/okfe/libs/polyfills/intersection-observer.js`,document.getElementsByTagName("head")[0].appendChild(o)}window.utils=window.utils||{},window.utils.monitor=this.monitor}},saveChannelId(o){l(o)}}}},U={};function T(h){var g=U[h];if(g!==void 0)return g.exports;var c=U[h]={exports:{}};return x[h](c,c.exports,T),c.exports}(function(){T.d=function(h,g){for(var c in g)T.o(g,c)&&!T.o(h,c)&&Object.defineProperty(h,c,{enumerable:!0,get:g[c]})}})(),function(){T.o=function(h,g){return Object.prototype.hasOwnProperty.call(h,g)}}(),function(){T.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}}();var R={};return function(){T.r(R);var h=T("./packages/monitor/src/web.js");h.default.init(),R.default=h.default.monitor}(),R=R.default,R}()})});export{$ as a};
/*!***************************************!*\
  !*** ./packages/monitor/src/index.js ***!
  \***************************************/

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-DXFO7P35.js.map
