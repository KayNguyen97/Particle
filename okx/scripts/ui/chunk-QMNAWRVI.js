import{f as Ke}from"./chunk-D6ZXZUY6.js";import{a as Ee}from"./chunk-QMF5LKVF.js";import{f as Ue}from"./chunk-VMACN7YR.js";import{c as Oe,d as De}from"./chunk-HQT4AKFZ.js";import{M as ce,P as le,d as te,e as re,ea as ue,f as oe,i as ae,j as se}from"./chunk-R6GCLTW2.js";import{a as ie}from"./chunk-S3ECGMEP.js";import{ha as Re,j as _}from"./chunk-X2LENRE7.js";import{c as N,f as w}from"./chunk-IMRS4RGO.js";import{h as R,p as ee,q as ne}from"./chunk-RMQJRDTF.js";import{Ab as $,Bb as U,C as Fe,Fa as Z,Pa as Pe,Vb as D,ma as O,q as E,sb as S,ub as F,zb as P}from"./chunk-CVJKAN5R.js";import{c as X,f as x,m,o as f}from"./chunk-6V2G2Z5W.js";var ge=X((dn,de)=>{m();f();function Ne(e){var n=e==null?0:e.length;return n?e[n-1]:void 0}de.exports=Ne});var q=X((In,Ie)=>{m();f();var we=Ee(),je=Ke(),qe=Oe(),ve=Ue(),ye=De(),Ve=ge(),Le=qe(function(e){var n=Ve(e);return ye(n)&&(n=void 0),ve(we(e,1,ye,!0),je(n,2))});Ie.exports=Le});m();f();var j=e=>R.MPC===e;m();f();Pe();function T({coin:e,walletId:n,walletIdentityMap:t,options:r={}}){let{needFilterBaseCoin:o=!1,isKeystone:c,isMPC:s,isHardWallet:u}=r,a=t[n],p=c!=null?c:N(a==null?void 0:a.initialType),i=u!=null?u:w(a==null?void 0:a.keyringIdentityType),l=s!=null?s:j(a==null?void 0:a.keyringIdentityType);return!l&&!i?!0:o&&e.coinId===O?!!l:p&&e.baseCoinId===O&&e.coinId===Z?!1:l?!Object.values(ne).includes(e.protocolId):!Object.values(ee).includes(e.protocolId)}function me({coins:e=[],walletId:n,walletIdentityMap:t,options:r={}}){let o=t[n],c=N(o==null?void 0:o.initialType),s=w(o==null?void 0:o.keyringIdentityType),u=j(o==null?void 0:o.keyringIdentityType);return e.filter(a=>T({coin:a,walletId:n,walletIdentityMap:t,options:{...r,isMPC:u,isHardWallet:s,isKeystone:c}}))}m();f();function fe(e){return Object.keys(e).sort().reduce((n,t)=>(n[t]=e[t]instanceof Object?fe(e[t]):e[t],n),{})}function sn(e){let n=fe(e);return JSON.stringify(n)}function cn(e){if(!e||typeof e!="object")return null;let n={...e};for(let t in n)(n[t]===null||n[t]===void 0)&&delete n[t];return n}function pe({coins:e,walletId:n,walletIdentityMap:t,createdMap:r}){let o=r[n]||[],c=new Set(o.map(({coinId:s})=>s));return e.reduce((s,u)=>{let{coinId:a,baseCoinId:p}=u;return(typeof a>"u"&&typeof p>"u"||(c.has(p)||c.has(a))&&T({coin:u,walletId:n,walletIdentityMap:t}))&&s.push(u),s},[])}m();f();D();m();f();var Ce=e=>({...e,currencyAmount:0,coinAmount:0,coinAmountInt:0});Fe();var he=x(q());function Tn({nfts:e,defis:n,selectedCurrency:t,filter:r,ignoreNft:o=!1}){let c="0",s="0";return o||e.reduce((p,i)=>{let l=i.networkValuations||[];return p.concat(r?r(l):l)},[]).forEach(p=>{var l;let i=S(p.valuation,(l=t==null?void 0:t.usdToThisRate)!=null?l:"1");c=E.add(c,i||0)}),(r?r(n):n).forEach(a=>{var i;let p=S(a.balance,(i=t==null?void 0:t.usdToThisRate)!=null?i:"1");s=E.add(s,p||0)}),{nftBalance:c,defiBalance:s}}function v(e,n){let t=null,r=n[e.coinId];return e.coinAmount==="0"||r=="0"?t="0":typeof r<"u"&&(t=S(e.coinAmount,r)),t}function Be(e,n){let t=[];return e.forEach(r=>{let o={...r};if(o.childrenCoin){if(o.childrenCoin.filter(n).length===0)return;t.push(o)}else{if(!n(o))return;t.push(o)}}),t.sort((r,o)=>U(o.currencyAmount,r.currencyAmount)?U(o.coinAmountInt,r.coinAmountInt)?P(r.rank,o.rank)?1:-1:P(o.coinAmountInt,r.coinAmountInt)?1:-1:P(o.currencyAmount,r.currencyAmount)?1:-1)}function Ae(e,n,{walletIdentityMap:t,createdMap:r,walletId:o}){let c=e.coins?[...e.coins]:[],s=c.reduce((i,l)=>(i.set(l.aggregation?l.symbol:l.coinId,l),i),new Map),u=pe({coins:n,walletId:o,walletIdentityMap:t,createdMap:r}),a=new Map,p=[];return u.forEach(i=>{let l=Ce(i);if(i.aggregation){if(!a.get(i.symbol)){let M={...l,childrenCoin:[]};a.set(i.symbol,M),p.push(M)}a.get(i.symbol).childrenCoin.push(l)}else p.push(l)}),p.forEach(i=>{let l=s.get(i.aggregation?i.symbol:i.coinId);l?l.aggregation&&(l.childrenCoin=(0,he.default)(l.childrenCoin,i.childrenCoin,"coinId")):c.push(i)}),c}m();f();function We(e){return e.metamask.coinToCurrencyRate||{}}function Fn(e){return e.metamask.coinToUSDRate||{}}m();f();var y=x(te());var Me=x(Re());var xe=x(q());D();var He=(0,y.createSelectorCreator)(y.defaultMemoize,Me.default),A=(e,n)=>n!=null?n:ce(e),ze=(0,y.createSelector)(e=>e.metamask.keyringIdentities,A,(e,n)=>{let t;for(let r=0;r<e.length;r++){let o=e[r];if(o.walletIdentities.find(c=>c.walletId===n)){t=o.keyringIdentityType;break}}return t===R.PRIVATE_KEY}),V=(0,y.createSelector)(e=>{let{createdMap:n={}}=e.metamask;return n},A,ze,ue,(e,n,t,r)=>{if(!t)return[];let o=e[n]||[],c=new Set(o.map(({coinId:s})=>s));return r.filter(s=>c.has(s.coinId))}),L=He(le,e=>e.metamask.createdMap,A,(e,n,t)=>({walletIdentityMap:e,createdMap:n,walletId:t})),H=(0,y.createSelector)(A,re,(e,n)=>{var t;return(t=n==null?void 0:n[e])!=null?t:[]}),Te=(0,y.createSelector)(A,oe,(e,n)=>{var t;return(t=n==null?void 0:n[e])!=null?t:[]}),be=(0,y.createSelector)(H,V,(e,n)=>(0,xe.default)(n,e,"coinId")),z=(0,y.createSelector)(e=>{var n;return(n=e.metamask.balancesMap)!=null?n:e.balanceSlice.balanceMap},ie,se,ae,L,We,(e,n,t,r,{walletIdentityMap:o},c)=>{if(!t)return{};let s=new Set(n.map(u=>u.chainId));return Object.entries(e).reduce((u,[a,p])=>{let{coins:i,...l}=p,M=(i!=null?i:[]).map(b=>{var Y,G;let Q=((Y=b.childrenCoin)==null?void 0:Y.length)||0,I={...b};if(I.childrenCoin){if(I.childrenCoin=I.childrenCoin.filter(k=>s.has(k.chainId)),I.childrenCoin.length===0)return null;I.childrenCoin.length!==Q&&Object.assign(I,I.childrenCoin[0])}else if(!s.has(I.chainId))return null;let d={...(G=r[I.coinId])!=null?G:{},...I};if(d.childrenCoin){let k=d.childrenCoin.some(C=>{var g;return((g=r[C.coinId])!=null?g:{}).isDefault}),ke=d.childrenCoin.map(C=>{var g;return{...C,...(g=r[C.coinId])!=null?g:{},isDefaultAggregationCoin:k}});d.isDefaultAggregationCoin=k;let B=me({coins:ke,walletId:a,walletIdentityMap:o});if(B.length===0)return null;let Se=B.length!==Q;B.forEach(C=>{C.currencyAmount=v(C,c)}),d.childrenCoin=B,d.currencyAmount=B.reduce((C,g)=>g.currencyAmount?F(C,g.currencyAmount):u,"0"),Se&&(d.coinAmount=B.reduce((C,g)=>F(C,g.coinAmount),"0"),d.coinAmountInt=B.reduce((C,g)=>F(C,g.coinAmountInt),"0"))}else{if(!T({coin:d,walletId:a,walletIdentityMap:o}))return null;d.currencyAmount=v(d,c)}return d},[]).filter(b=>b!==null);return u[a]={...l,coins:M},u},{})}),J=(0,y.createSelector)(z,A,(e,n)=>{var t;return(t=e[n])!=null?t:{}});m();f();var W=x(te());D();var Je=(0,W.createSelector)(z,e=>Object.entries(e).reduce((n,[t,r])=>{var s;let c=((s=r==null?void 0:r.coins)!=null?s:[]).reduce((u,a)=>a.childrenCoin?u.concat(a.childrenCoin):u.concat([a]),[]);return n[t]={...r,coins:c},n},{})),Gn=(0,W.createSelector)(J,e=>!Array.isArray(e==null?void 0:e.coins)),Xn=(0,W.createSelector)(Je,(e,n)=>n,(e,n)=>{var t,r;return(r=(t=e==null?void 0:e[n])==null?void 0:t.coins)!=null?r:[]}),Qe=(0,W.createSelector)(J,be,L,Ae),Zn=(0,W.createSelector)(Qe,H,Te,V,(e,n,t,r)=>{var a,p;let o=new Set((a=t==null?void 0:t.map(i=>i.coinId))!=null?a:[]),c=new Set((p=n==null?void 0:n.map(i=>i.coinId))!=null?p:[]),s=new Set(r.map(i=>i.coinId));return Be(e,i=>{let l=i.coinId,K=i.currencyAmount;return!!(($(K,"1")||i.isDefault||s.has(i.coinId)||c.has(l)||_(i))&&!o.has(l))})});export{j as a,T as b,sn as c,cn as d,pe as e,Tn as f,We as g,Fn as h,V as i,Je as j,Gn as k,Xn as l,Qe as m,Zn as n};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-QMNAWRVI.js.map
