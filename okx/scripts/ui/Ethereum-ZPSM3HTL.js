import{a as Ie,b as Ee,c as M,d as Fe,e as ge}from"./chunk-6SQMYO7V.js";import{h as _e}from"./chunk-G37W3QVU.js";import"./chunk-NNLKCRJB.js";import{a as xe}from"./chunk-WGSAQS5P.js";import{a as Pe}from"./chunk-I4A7V6SN.js";import"./chunk-KQ6VNFYE.js";import"./chunk-KOSLQKT7.js";import{b as ue}from"./chunk-YVK4X6SB.js";import"./chunk-4AOAXYPU.js";import"./chunk-P34A6LS4.js";import{j as Ce}from"./chunk-OCVOVZC6.js";import"./chunk-OYUD7NPL.js";import"./chunk-VEYNKMNX.js";import"./chunk-5RXQBXEZ.js";import"./chunk-6HDV4AIS.js";import"./chunk-HHT2ACSL.js";import{d as nt}from"./chunk-IB4K3FN6.js";import{a as de}from"./chunk-NLMSL6KB.js";import{a as pe}from"./chunk-CAHNM26J.js";import"./chunk-HX3FTBPA.js";import{a as D}from"./chunk-NC54FPSJ.js";import"./chunk-IKPPHICM.js";import{a as se,b as ie,d as me}from"./chunk-HR4SA7Z5.js";import"./chunk-X43FDTPV.js";import"./chunk-ZGEQVSMJ.js";import"./chunk-5OUYE6NE.js";import"./chunk-GQOO5OO7.js";import"./chunk-WIOZQWEG.js";import"./chunk-67PEY2GN.js";import"./chunk-JVE4G6JP.js";import{c as le}from"./chunk-VNHZZRMI.js";import"./chunk-5TSD6WDE.js";import"./chunk-TPBDSGSX.js";import{a as ce}from"./chunk-I2KPNTIF.js";import"./chunk-MEW6SUUR.js";import{b as fe}from"./chunk-D6O2GLPR.js";import{c as B}from"./chunk-2CPFAAZ7.js";import"./chunk-ZG26PGPF.js";import"./chunk-HE77KLJ4.js";import"./chunk-NOZM7AA3.js";import"./chunk-73YQ4YAD.js";import{a as ut}from"./chunk-OEVJ7FDO.js";import"./chunk-ATUBFYS2.js";import{a as Te}from"./chunk-2N2ADYFP.js";import"./chunk-X2HBIQ56.js";import"./chunk-TYILG3ER.js";import"./chunk-YLO74Q7W.js";import{a as rt}from"./chunk-D54UDGZS.js";import"./chunk-2SGW2RXR.js";import"./chunk-ZXEHJOAD.js";import"./chunk-U3YDJ2W7.js";import"./chunk-VCWU5FEX.js";import"./chunk-KZ77CGYD.js";import"./chunk-7CB4COOY.js";import"./chunk-RDZIVMHO.js";import"./chunk-E73QHIZ6.js";import{e as te}from"./chunk-E2KMZQ6K.js";import"./chunk-JXT6JCNO.js";import"./chunk-AHAXQBXQ.js";import"./chunk-DUZ4ULSN.js";import{a as ee}from"./chunk-PGPPXRV7.js";import"./chunk-54GDJWA6.js";import"./chunk-UGYRJNZG.js";import"./chunk-PLVZLQPX.js";import"./chunk-QNVM7T5C.js";import"./chunk-7T7NBYQH.js";import"./chunk-FEET7RP6.js";import"./chunk-MBJ4MFYL.js";import"./chunk-PCY622ND.js";import"./chunk-NS35PZCP.js";import"./chunk-XOD56IFT.js";import"./chunk-BBN3UGKM.js";import"./chunk-5DEIKYJL.js";import"./chunk-QMNAWRVI.js";import"./chunk-D6ZXZUY6.js";import"./chunk-QMF5LKVF.js";import"./chunk-VMACN7YR.js";import"./chunk-IQVVVGEA.js";import"./chunk-PGY6IZUS.js";import"./chunk-AXKCDQTS.js";import"./chunk-JWFSXEUV.js";import"./chunk-PD2BTUUF.js";import"./chunk-YCMOAOGN.js";import{a as Wt}from"./chunk-JQQNTNIX.js";import"./chunk-JLLMIXPD.js";import"./chunk-5OUCZQSW.js";import"./chunk-YIKS2AYL.js";import"./chunk-EXUJ54CX.js";import{b as Kt,l as jt}from"./chunk-D5VZXMFP.js";import"./chunk-XAMN4IIH.js";import"./chunk-BTS2GOAC.js";import{d as Jt,e as ot,g as Xt}from"./chunk-2HWABU7H.js";import"./chunk-APEQZGKB.js";import{m as St}from"./chunk-P2BTSOJO.js";import"./chunk-SI3RW2CS.js";import"./chunk-AX4SXHC6.js";import{b as oe}from"./chunk-UCS37WXR.js";import{e as Dt,g as Vt,m as qt}from"./chunk-DUHXKIBS.js";import"./chunk-QNEJI55N.js";import"./chunk-5W7SRP5N.js";import{a as Ut,b as Yt}from"./chunk-YVRXETFX.js";import{h as re,k as ne,l as ae,q as dt}from"./chunk-GUWGENNL.js";import"./chunk-WYB2CUAN.js";import"./chunk-B2BOSVTW.js";import"./chunk-GUJXW3GJ.js";import"./chunk-VIS7KIVI.js";import"./chunk-F64VYES3.js";import"./chunk-DHX2X277.js";import"./chunk-67YO4IPY.js";import"./chunk-DLUAVD7X.js";import"./chunk-WRWXCAEZ.js";import"./chunk-OZ6XSJY6.js";import"./chunk-DMJQUOJT.js";import{f as $t}from"./chunk-MTMZQEHP.js";import"./chunk-NKTQMEXG.js";import{m as et}from"./chunk-62JDSRZZ.js";import"./chunk-FF7XOOGZ.js";import"./chunk-4OTZHHYZ.js";import"./chunk-HQT4AKFZ.js";import"./chunk-JUIB44FD.js";import{y as Ot}from"./chunk-R6GCLTW2.js";import"./chunk-4KY5XQ5E.js";import"./chunk-S3ECGMEP.js";import"./chunk-PX7HII6H.js";import{A as Mt}from"./chunk-UEO7AURD.js";import"./chunk-DXFO7P35.js";import"./chunk-TPEASXIF.js";import{a as Zt}from"./chunk-JSAFBAMQ.js";import"./chunk-A336VZZF.js";import"./chunk-XEOGXIVD.js";import{a as zt}from"./chunk-PCGRDRHF.js";import"./chunk-IU3TYIWS.js";import{b as tt,o as vt}from"./chunk-VPBQLZCI.js";import"./chunk-ERLETJMZ.js";import"./chunk-FRDOFRM7.js";import"./chunk-X2LENRE7.js";import{a as Qt}from"./chunk-O4EDZSHP.js";import"./chunk-HU3KBV5G.js";import{b as J}from"./chunk-6ZPGW3YM.js";import{k as q,o as Ht}from"./chunk-ZKDHZDUE.js";import"./chunk-4UESFVD2.js";import"./chunk-D7KW4FFX.js";import"./chunk-RAXGEVRQ.js";import{d as Ft,f as so}from"./chunk-S4N75E3H.js";import"./chunk-7MX3OHNE.js";import"./chunk-2BSLA752.js";import"./chunk-FLCN6MAI.js";import{a as y,b as I}from"./chunk-YMZEQGAL.js";import"./chunk-7E3KY4EN.js";import"./chunk-JIRWXBHS.js";import"./chunk-3TVEFIPW.js";import{M as lt,P as Bt,U as pt,W as Rt,d as bt,m as $}from"./chunk-UXFKODVN.js";import"./chunk-IMRS4RGO.js";import"./chunk-52GWQSZH.js";import{a as po}from"./chunk-TPSXCUGD.js";import"./chunk-XKG5DY6K.js";import"./chunk-6PGLMYAE.js";import{i as Gt}from"./chunk-RMQJRDTF.js";import{c as Lt}from"./chunk-2YLR7R2N.js";import{a as At,b as lo}from"./chunk-MVLY6WUP.js";import{f as gt,h as mo}from"./chunk-ZEAKIEIQ.js";import"./chunk-5KSDRGLW.js";import"./chunk-DQTCC3FF.js";import"./chunk-O5LVHMPV.js";import{Ab as wt,Bb as yt,C as v,D as it,Ra as ct,Vb as Nt,bc as O,ec as co,ic as kt,nc as fo,rb as io,ub as ft,v as _,vb as ht,zb as Z}from"./chunk-CVJKAN5R.js";import"./chunk-A5Y2KVNP.js";import{H as R,b as mt}from"./chunk-GXQ645QR.js";import"./chunk-DQ2NYVYI.js";import"./chunk-C2H3SRET.js";import{a as Y}from"./chunk-V4YVDLI4.js";import"./chunk-UXBKFN2U.js";import"./chunk-HCW4K7TR.js";import"./chunk-Z4JATHZR.js";import"./chunk-TW6D7CWA.js";import"./chunk-3T5D6KAV.js";import"./chunk-MAWXDEJZ.js";import"./chunk-Z37GURZ6.js";import"./chunk-IYYFWVWL.js";import"./chunk-CLSYGH6A.js";import"./chunk-DHRSDA7N.js";import"./chunk-RYNAOZ73.js";import"./chunk-PR4SLUV4.js";import"./chunk-Q34CQJXG.js";import"./chunk-GKHVFCKF.js";import{f as P,m as s,o as i}from"./chunk-6V2G2Z5W.js";s();i();var L=P(Y());co();var Ke=P(J());s();i();var Tt=P(Y()),ke=P(J()),Ae=P(po());s();i();var he=P(J()),at=P(it()),uo=t=>{let{metamask:{provider:r={}}}=(0,he.useSelector)(n=>n),o=t==null?void 0:t.image;return(0,at.isArray)(o)?t.image=o[0]:(0,at.isObject)(o)&&(t.image=null),{token:t,provider:r}},we=uo;s();i();v();var ye=P(J());Ht();var To=(t={},r={})=>{let o=(0,ye.useDispatch)(),n=t.address,m=Xt(),d=Ee(),c=D(),f={actionType:B.ACTION_TYPE.CANCEL,async onClick(){c({all_confirmation:"cancel",trade:"add_token"}),await d(n,!1),await q(o)},btnText:_("wallet_dapp_connection_btn_reject")},u={actionType:B.ACTION_TYPE.CONFIRM,async onClick(){var e,a;try{c({all_confirmation:"confirm",trade:"add_token"});let p=await re(r.type,m),x={...t,contractAddress:n,blockChain:p.shortName,localType:r.type};await Kt(x),await d(n,!0),await q(o)}catch(p){R.error(((a=(e=p==null?void 0:p.data)==null?void 0:e.originalError)==null?void 0:a.msg)||_("wallet_extenshion_toast_add_failed"))}}};return[f,u]},Ne=To;var Co=({unapproved:t})=>{let r=(0,ke.useSelector)(Yt),{token:o,provider:n}=we(t),m=Ne(o,n);return!o||r!==Ut.addToken?Tt.default.createElement(Ae.Redirect,{to:Qt}):Tt.default.createElement(xe,{token:o,provider:n,buttonGroup:m})},Se=Co;s();i();var Re=P(Y());var X=P(J());Ht();v();s();i();var W=P(Y());so();s();i();var Me=()=>(0,W.useCallback)(async(r,o)=>{await Ft().updateReportTimestamp(r,o)},[]);var Po=()=>{let t=Me();return(0,W.useCallback)(async o=>{await t(o,"CAN_CONFIRM")},[t])},Le=(t,r)=>{let o=Po(),n=(0,W.useRef)(!1);(0,W.useEffect)(()=>{!r&&!n.current&&(n.current=!0,o(t))},[t,r,o])},Ge=()=>{let t=Me();return(0,W.useCallback)(async o=>{await t(o,"CLICK_CONFIRM")},[t])};s();i();var be=P(it());var Be=({isMev:t,mevInfo:r,unapproved:o,modifiedData:n,customGasInfo:m,updateData:d,gasReturnActivity:c})=>{var g;let{nonce:f,updateGasInfo:u}=d,e=(0,be.cloneDeep)(o),{supportEip1559:a,gasLimitInfo:p={},gasLimit:x,maxFeePerGas:N,gasPrice:F,maxPriorityFeePerGas:E}=m;if(n&&e.txParams&&(e.txParams.data=n),a?(e==null||delete e.txParams.gasPrice,e.txParams.maxFeePerGas=I(N),e.txParams.maxPriorityFeePerGas=I(E),e.txParams.type=$.FEE_MARKET):(e==null||delete e.txParams.maxFeePerGas,e==null||delete e.txParams.maxPriorityFeePerGas,e==null||delete e.txParams.type,e.txParams.gasPrice=I(F)),u){let k=Object.entries(u).reduce((h,[w,T])=>(h[w]=I(T),h),{});e.txParams={...e.txParams,...k}}return e.txParams.gas=I(x),e.txParams.nonce=I(f),e.gasLimitInfo=p||{},e.mev=t?r.name:"",e.activityId=c==null?void 0:c.activityId,e.gasType=m.gasType,(g=o==null?void 0:o.txParams)!=null&&g.data||(e.isBaseCoinTransfer=!0),e};var _o=t=>{let r=(0,X.useSelector)(n=>ae(n,t)),o=(0,X.useSelector)(n=>ne(n,t));return{mevInfo:r,isMev:o}},Io=({unapproved:t})=>{let r=(0,X.useDispatch)(),o=M(),n=nt(t),{id:m,txParams:d={}}=t,{from:c,to:f,value:u}=d,{coinId:e}=o,a=Ie(t.origin,c)||{},{isMev:p,mevInfo:x}=_o(m),N=Ge(),F=tt((w,T)=>{r(dt.setIsMev({isMev:w,id:m})),r(dt.setMevInfo({mevInfo:T,id:m}))});Le();let E=D(a==null?void 0:a.walletId),g=tt(async()=>{E({trade:"contract_interaction",all_confirmation:"cancel",network:e}),Mt(),await r(qt({id:m})),await q(r)}),k=pe(),h=tt(async({modifiedData:w,customGasInfo:T,gasReturnActivity:A,reportGasReturnActivityDataInConfirm:H})=>{let{gasPrice:K}=T;if(N(m),await rt({callback:g,walletId:a==null?void 0:a.walletId})){E({network:e,all_confirmation:"confirm",trade:"contract_interaction"});let Q=await k({to:f,from:c,coinId:e,gasPrice:K,userGasInfo:T,amount:y(u||0),baseCoinAmountUse:y(u||0)});H(),await r(Vt(Be({isMev:p,mevInfo:x,unapproved:t,updateData:Q,modifiedData:w,customGasInfo:T,gasReturnActivity:A}))).then(G=>{let{serverTxId:U}=G||{};St({tx_id:U})}).catch(G=>{var U;try{let b=(U=G==null?void 0:G.data)==null?void 0:U.originalError;Dt(b.code)&&(A==null||A.clear(),R.error({title:(b==null?void 0:b.msg)||_("wallet_home_toast_network_error"),duration:3}))}catch(b){console.log(b)}}),await q(r)}});return Re.default.createElement(ue,{needMev:!0,coinId:e,openMev:p,onConfirmReplace:!0,dappInfo:n,txParams:d,txType:t==null?void 0:t.type,walletId:a==null?void 0:a.walletId,onMevChange:F,onCancel:g,onConfirm:h})},Oe=Io;s();i();v();var C=P(Y());s();i();var Ct=P(it()),De=P(Y());Nt();var xo=({unapproved:t,walletAccount:r,customGasInfo:o={}})=>{var w;let{params:n}=t,{walletId:m}=r,d=M(),{coinId:c}=d,f=(w=te(c,m))==null?void 0:w.coinAmountInt,{gasType:u,isNetworkFeeLoading:e,networkFee:a,getLimit:p}=o,{minGasFee:x}=se(o),N=ie(o),F=(0,De.useMemo)(()=>{if((0,Ct.isNil)(f))return n;let T=f,A=[];return n.forEach(H=>{T=ht(T,a),Z(T,0)&&A.push(H)}),A},[f,n,a]),E=e&&yt(p,0),g={level:u||Bt.STANDARD,loading:e,coinId:d==null?void 0:d.coinId,networkFee:E?void 0:x,maxNetworkFee:E?void 0:a,estimateFailed:N},k=e||F.length&&F.length===n.length,h=(0,Ct.isNil)(f)||wt(f,a);return{isNetworkFeeLoading:e,estimateFailed:N,networkFeeProps:g,canApproveTxs:F,isSufficientGas:h,canApproveAll:k}},We=xo;s();i();v();var Eo=t=>{for(let r=0;r<t.length;r++){let o=t[r],n=o();if(n)return n}return null},Fo=({walletAccount:t,canApproveTxs:r,canApproveAll:o,isSufficientGas:n})=>{let m=et(t.walletId),d=()=>m?{type:mt.TYPE.error,message:_("wallet_extension_function_alert_wallet_unsupported")}:null,c=M(),f=Ce({baseCoin:c,isSufficientGas:n});return Eo([d,f,()=>o?null:{type:mt.TYPE.warn,message:_("wallet_extension_function_alert_available_balance",{gasToken:c.symbol,num:r.length})}])},He=Fo;s();i();var Ye=P(Y());v();Nt();io();lo();fo();mo();var Ue=100,go=({unapproved:t,walletAccount:r,isSufficientGas:o,canApproveTxs:n,customGasInfo:m,isNetworkFeeLoading:d})=>{var U,b;let{id:c}=t,{walletId:f,address:u}=r,e=et(f),a=D(f),{coinId:p}=M(),x=_e(),N=Pe(),F=(0,Ye.useCallback)(async()=>{a({trade:"sendEvmInscriptions",all_confirmation:"cancel"}),await x({id:c})},[x,a,c]),E={onClick:F,actionType:B.ACTION_TYPE.CANCEL,btnText:_("wallet_dapp_connection_btn_reject")},g=e||d,{gasPrice:k,supportEip1559:h,gasLimitInfo:w={},gasLimit:T,maxFeePerGas:A,maxPriorityFeePerGas:H,networkFee:K}=m,j=le({fromAddr:(b=(U=n[0])==null?void 0:U.txParams)==null?void 0:b.from,walletId:f,localType:ct}),Q=async()=>{try{let st=n.length,je=n[0],{from:Qe,to:ve,value:Je}=je.txParams;if(a({trade:"sendEvmInscriptions",all_confirmation:"confirm"}),!await rt({callback:F,walletId:f}))return;let{data:Xe}=await $t({checkTypes:[pt.OVERWRITTEN],coinId:p,from:Qe,to:ve,amount:y(Je||0),gasPrice:k}),ze=Xe.find(({checkType:V})=>V===pt.OVERWRITTEN)||{},{newNonce:Ze,toastType:$e,pendingNum:to}=ze;if($e===Rt.FAILED){R.error(_("wallet_extension_function_toast_failed_single")),await ut(1500),await x({id:c});return}let Pt=ft(to,st);if(Z(Pt,Ue)){R.error(_("wallet_extension_function_toast_pending",{TotalNum:Pt,ExceededNum:Ue}));return}let _t=[],It=[];for(let V=0;V<n.length;V++){let z=n[V],{txParams:l}=z,{from:eo,to:oo}=l;l.nonce=kt(I(ft(Ze,V))),h?(delete z.gasPrice,l.maxFeePerGas=I(A),l.maxPriorityFeePerGas=I(H),l.type=$.FEE_MARKET):(delete l.maxFeePerGas,delete l.maxPriorityFeePerGas,delete l.type,l.gasPrice=I(k)),l.gas=I(T),l.gasLimit=I(T),l.gasLimitInfo=w,l.gasType=m.gasType;let ro=Wt(z.txParams),xt=await j({params:ro}),Et=await ee(ct,xt),no={...l,value:y(l.value),gas:T,gasPrice:y(h?l.maxFeePerGas:l.gasPrice),priorityFee:y(h?l.maxPriorityFeePerGas:0),nonce:y(l.nonce),repeatTxType:bt.CONFIRMING,oldTxHash:"",inscriptionType:1},ao={extJson:JSON.stringify(no),signedTx:xt,coinId:p,coinAmount:y(l.value||0),fromAdr:eo,toAdr:oo,serviceCharge:K,txHash:Et,txSource:Gt.DAPP,inputData:l.data,accountId:f,txType:1,walletType:r==null?void 0:r.serverWalletType};It.push(ao),_t.push({id:z.id,txHash:Et})}await gt(At.postSendEvmInscriptions,{txList:It}),await N({id:c,result:_t})}catch(st){R.error(st.msg||_("wallet_home_toast_network_error")),await ut(1500),await N({id:c,error:"Failed"})}},G={disabled:g,actionType:B.ACTION_TYPE.CONFIRM,onClick:Q};return g?[E,G]:(o||(G={actionType:B.ACTION_TYPE.FILL_UP,txId:c,coinId:p,walletId:f,address:u,receiveOnly:o}),[E,G])},Ve=go;var ho=({unapproved:t})=>{var j;let{coinId:r}=M(),{txParams:o={}}=(j=t==null?void 0:t.params)==null?void 0:j[0],{from:n,to:m,data:d,value:c}=o,{walletId:f}=t,u=Te(t),e=D(f),a=nt(t),[p,x]=(0,C.useState)({}),N=(0,C.useCallback)(Q=>{x(Q)},[]),{networkFeeProps:F,canApproveTxs:E,canApproveAll:g,isSufficientGas:k,isNetworkFeeLoading:h}=We({unapproved:t,walletAccount:u,customGasInfo:p}),w=Ve({unapproved:t,walletAccount:u,canApproveTxs:E,customGasInfo:p,isSufficientGas:k,isNetworkFeeLoading:h}),T=He({walletAccount:u,canApproveTxs:E,canApproveAll:g,isSufficientGas:k}),[A,{setTrue:H,setFalse:K}]=vt(!1);return C.default.createElement(Lt.Container,null,C.default.createElement(Zt,{title:_("wallet_extension_function_title_bulk_signing"),closeable:!1,backable:!1}),C.default.createElement(ot,null,C.default.createElement(de,{...a})),C.default.createElement(ot,null,C.default.createElement(ce,{onClick:H,...F})),C.default.createElement(ot,{bordered:!1},C.default.createElement(Jt,{title:_("wallet_extension_network_address_title_walletused"),address:u.address,walletId:u.walletId,onCopyCallback:()=>{e({trade:"sendEvmInscriptions",all_confirmation:"wallet_used_address"})}})),C.default.createElement(zt,{placeholder:!0,offsetBottom:0,borderTop:!0},C.default.createElement(fe,{...T}),C.default.createElement(B,{buttonGroup:w})),C.default.createElement(me,{visible:A,coinId:r,address:n,inputData:d,tokenAddress:m,value:y(c),onBack:K,onClose:null,onGasChange:N}))},qe=ho;var $n=(0,L.memo)(({unapproved:t})=>{let r=(0,Ke.useDispatch)();switch((0,L.useEffect)(()=>{var o;if((t==null?void 0:t.id)&&(t==null?void 0:t.method)!==lt.SEND_EVM_INSCRIPTIONS){let{type:n,id:m}=t;Ot(n)&&jt((o=t==null?void 0:t.txParams)==null?void 0:o.to),r(oe(m))}},[t,r]),t.method){case lt.SEND_EVM_INSCRIPTIONS:return L.default.createElement(qe,{unapproved:t});default:break}switch(t.type){case O.ETH_SIGN:case O.PERSONAL_SIGN:case O.ETH_SIGN_TYPED_DATA:case O.ETH_GET_ENCRYPTION_PUBLIC_KEY:case O.ETH_DECRYPT:return L.default.createElement(Fe,{unapproved:t});case O.WATCH_ASSET:return L.default.createElement(Se,{unapproved:t});case O.ADD_ETHEREUM_CHAIN:return L.default.createElement(ge,{unapproved:t});default:return L.default.createElement(Oe,{unapproved:t})}});export{$n as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Ethereum-ZPSM3HTL.js.map
