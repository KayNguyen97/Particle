import{a as Zt}from"./chunk-DDRVOIUN.js";import{a as _r,b as yo}from"./chunk-ZCAFVAKN.js";import{a as dr}from"./chunk-YM6UXGIC.js";import{a as pr}from"./chunk-7CB4COOY.js";import"./chunk-RDZIVMHO.js";import{a as cr}from"./chunk-E73QHIZ6.js";import"./chunk-E2KMZQ6K.js";import{a as ir}from"./chunk-JXT6JCNO.js";import{a as Vt,b as Qt}from"./chunk-R4JNZMWB.js";import"./chunk-4ZFO5TFE.js";import"./chunk-ALCVBZDB.js";import"./chunk-I3HSL7JC.js";import"./chunk-DC2INDOF.js";import"./chunk-AHAXQBXQ.js";import{a as O}from"./chunk-PLVZLQPX.js";import"./chunk-FEET7RP6.js";import"./chunk-MBJ4MFYL.js";import"./chunk-PCY622ND.js";import"./chunk-NS35PZCP.js";import"./chunk-XOD56IFT.js";import"./chunk-BBN3UGKM.js";import{a as mr}from"./chunk-5DEIKYJL.js";import"./chunk-QMNAWRVI.js";import"./chunk-D6ZXZUY6.js";import"./chunk-QMF5LKVF.js";import"./chunk-VMACN7YR.js";import{c as Wt}from"./chunk-SOQIEFZQ.js";import"./chunk-H4WTNLNN.js";import{b as rr}from"./chunk-4THBRLBC.js";import{a as Pe}from"./chunk-AXKCDQTS.js";import"./chunk-JWFSXEUV.js";import"./chunk-PD2BTUUF.js";import"./chunk-YCMOAOGN.js";import{b as Ro,c as vt,d as er,e as tr,f as or,g as uo}from"./chunk-FAV4K2KH.js";import"./chunk-A75OUJFC.js";import"./chunk-YG4ZGSDO.js";import"./chunk-OCHHKHZZ.js";import"./chunk-JQQNTNIX.js";import{b as Fe,d as Dt}from"./chunk-JLLMIXPD.js";import"./chunk-UVVG5NXG.js";import"./chunk-4EWRAZMR.js";import"./chunk-NGDV3PTC.js";import{i as Xt}from"./chunk-MFPHQZ6G.js";import"./chunk-AX4SXHC6.js";import{a as sr}from"./chunk-F64VYES3.js";import"./chunk-DHX2X277.js";import"./chunk-OZ6XSJY6.js";import"./chunk-DMJQUOJT.js";import"./chunk-MTMZQEHP.js";import"./chunk-NKTQMEXG.js";import{a as We,b as xo,f as Je,g as Yt}from"./chunk-62JDSRZZ.js";import"./chunk-FF7XOOGZ.js";import{b as Pt,d as Ft}from"./chunk-4OTZHHYZ.js";import"./chunk-HQT4AKFZ.js";import"./chunk-JUIB44FD.js";import{O as bt,P as zo,ga as pt}from"./chunk-R6GCLTW2.js";import{a as $t,b as zt}from"./chunk-4KY5XQ5E.js";import"./chunk-S3ECGMEP.js";import"./chunk-PX7HII6H.js";import{G as Go,m as jo,r as St}from"./chunk-UEO7AURD.js";import"./chunk-DXFO7P35.js";import"./chunk-S3BOQTUM.js";import"./chunk-TPEASXIF.js";import{a as te}from"./chunk-JSAFBAMQ.js";import"./chunk-A336VZZF.js";import{b as ve}from"./chunk-XEOGXIVD.js";import"./chunk-PCGRDRHF.js";import{p as k}from"./chunk-IU3TYIWS.js";import{f as Gt,j as Kt,o as ar,v as lr}from"./chunk-VPBQLZCI.js";import"./chunk-ERLETJMZ.js";import"./chunk-FRDOFRM7.js";import{p as _o}from"./chunk-X2LENRE7.js";import{C as jt,a as me,aa as nr,p as Ut,q as Ze,r as fe,s as Ht,t as qt}from"./chunk-O4EDZSHP.js";import{k as ee}from"./chunk-HU3KBV5G.js";import{b as ue}from"./chunk-6ZPGW3YM.js";import{j as Qe,o as fo}from"./chunk-ZKDHZDUE.js";import"./chunk-4UESFVD2.js";import"./chunk-D7KW4FFX.js";import"./chunk-RAXGEVRQ.js";import{d as Te,f as co}from"./chunk-S4N75E3H.js";import{a as Mt,b as Ot,e as Jo,f as _t}from"./chunk-7MX3OHNE.js";import"./chunk-2BSLA752.js";import{g as dt}from"./chunk-FLCN6MAI.js";import"./chunk-7E3KY4EN.js";import{c as Ko}from"./chunk-JIRWXBHS.js";import"./chunk-3TVEFIPW.js";import"./chunk-UXFKODVN.js";import{d as kt}from"./chunk-IMRS4RGO.js";import"./chunk-52GWQSZH.js";import{a as le}from"./chunk-TPSXCUGD.js";import"./chunk-XKG5DY6K.js";import{c as g,d as ie,e as ae,g as Yo,h as Vo,j as Xo,k as Qo,n as Zo}from"./chunk-6PGLMYAE.js";import{b as $o,f as ct}from"./chunk-RMQJRDTF.js";import{c as o}from"./chunk-2YLR7R2N.js";import"./chunk-MVLY6WUP.js";import"./chunk-ZEAKIEIQ.js";import"./chunk-5KSDRGLW.js";import"./chunk-DQTCC3FF.js";import"./chunk-O5LVHMPV.js";import{C as X,D as $e,F as q,H as Ve,K as Xe,L as It,Pa as Be,Ra as po,Vb as Uo,Wb as Ho,ec as fs,hc as qo,nc as xs,o as vo,q as Ct,rb as us,v as d,zb as Nt}from"./chunk-CVJKAN5R.js";import"./chunk-A5Y2KVNP.js";import{B as Po,E as Fo,H,K as _e,c as mt,e as De,o as Ye,r as Wo,x as At}from"./chunk-GXQ645QR.js";import"./chunk-DQ2NYVYI.js";import{J as de,P as ze,V as I,c as Oe}from"./chunk-C2H3SRET.js";import{a as C}from"./chunk-V4YVDLI4.js";import"./chunk-AUIXWDH4.js";import"./chunk-UXBKFN2U.js";import"./chunk-HCW4K7TR.js";import"./chunk-Z4JATHZR.js";import"./chunk-TW6D7CWA.js";import"./chunk-3T5D6KAV.js";import"./chunk-MAWXDEJZ.js";import"./chunk-Z37GURZ6.js";import"./chunk-IYYFWVWL.js";import"./chunk-O3BDC4SE.js";import"./chunk-K2CHCG7Q.js";import"./chunk-3FBBK33H.js";import"./chunk-GT57MMCB.js";import"./chunk-HIGM7FFU.js";import"./chunk-CLSYGH6A.js";import"./chunk-DHRSDA7N.js";import"./chunk-RYNAOZ73.js";import"./chunk-Q34CQJXG.js";import"./chunk-GKHVFCKF.js";import{f as p,m as n,o as a}from"./chunk-6V2G2Z5W.js";n();a();var ye=p(C());var pe=p(le());n();a();X();var fr=p(ue());var xr=p(le());var h=p(C());n();a();var Ue=p(C()),ho=p(Oe());n();a();var Le={root:"_root_14nif_1",closeWrap:"_closeWrap_14nif_5",closeIcon:"_closeIcon_14nif_13",closeText:"_closeText_14nif_17",stepWrap:"_stepWrap_14nif_23",stepItem:"_stepItem_14nif_30",active:"_active_14nif_37"};var ys=e=>{let r=ee(),{currentStep:t,handleClose:s}=e;return Ue.default.createElement(o.Box,{className:Le.root},Ue.default.createElement(o.Box,{className:Le.closeWrap},Ue.default.createElement(de,{onClick:s,className:(0,ho.default)("okx-wallet-plugin-close",Le.closeIcon)}),t!==3?Ue.default.createElement(o.Box,{onClick:s,className:Le.closeText},r("wallet_extension_top_textbtn_skip")):null),Ue.default.createElement(o.Box,{className:Le.stepWrap},Array(4).fill(" ").map((l,m)=>Ue.default.createElement(o.Box,{key:m,className:(0,ho.default)(Le.stepItem,{[Le.active]:t===m})}))))},ut=ys;n();a();var go=p(C());n();a();var ur={root:"_root_1wb1e_1"};var hs=({handleNext:e})=>go.default.createElement(o.FlexBox,{className:ur.root,align:o.ALIGN.center,justify:o.ALIGN.center,onClick:e},go.default.createElement(de,{className:"okds-arrow-pointer-right-sm"})),Jt=hs;n();a();var G={root:"_root_15mve_1",wrap:"_wrap_15mve_9",title:"_title_15mve_13",titleColorfulGreen:"_titleColorfulGreen_15mve_22",titleColorfulYellow:"_titleColorfulYellow_15mve_25",desc:"_desc_15mve_28",firstScreenImg:"_firstScreenImg_15mve_36",secondAndFourthScreenImg:"_secondAndFourthScreenImg_15mve_42",thirdScreenImg:"_thirdScreenImg_15mve_45",footerWrap:"_footerWrap_15mve_48"};var gs=e=>{let{handleNext:r,handleClose:t}=e,s=dt({light:"/cdn/assets/imgs/245/AB118B1F7E00FCCF.png",dark:"/cdn/assets/imgs/245/46D15BEDF89AD94E.png"});return h.default.createElement(h.default.Fragment,null,h.default.createElement(ut,{currentStep:0,handleClose:t}),h.default.createElement(o.Box,{className:G.wrap},h.default.createElement(o.Box,{className:G.title},h.default.createElement("span",null,d("wallet_extension_top_title_added_seed_phrase1",{seedPhrase:d("wallet_extension_top_title_added_seed_phrase2")}))),h.default.createElement(k.Text,{className:G.desc},d("wallet_extension_top_maintitle_added_seed_phrase")),h.default.createElement(mt,{className:G.firstScreenImg,src:s})),h.default.createElement(Jt,{handleNext:r}))},ws=e=>{let{handleNext:r,handleClose:t}=e,s=dt({light:"/cdn/assets/imgs/245/4A7B68AABB586801.png",dark:"/cdn/assets/imgs/245/46C68B7C7B93F25B.png"});return h.default.createElement(h.default.Fragment,null,h.default.createElement(ut,{currentStep:1,handleClose:t}),h.default.createElement(o.Box,{className:G.wrap},h.default.createElement(o.Box,{className:G.title},d("wallet_extension_top_title_unlock_hardware")),h.default.createElement(k.Text,{className:G.desc},d("wallet_extension_top_subtitle_confirm_unlock")),h.default.createElement(mt,{src:s,className:G.secondAndFourthScreenImg})),h.default.createElement(Jt,{handleNext:r}))},Es=e=>{let{handleNext:r,handleClose:t}=e,s=dt({light:"/cdn/assets/imgs/245/21F0D08062856488.png",dark:"/cdn/assets/imgs/245/D8A2A5141B0A6F22.png"});return h.default.createElement(h.default.Fragment,null,h.default.createElement(ut,{currentStep:2,handleClose:t}),h.default.createElement(o.Box,{className:G.wrap},h.default.createElement(o.Box,{className:G.title},d("wallet_extension_top_title_usb_connected")),h.default.createElement(k.Text,{className:G.desc},d("wallet_extension_top_subtitle_after_connected")),h.default.createElement(mt,{src:s,className:G.thirdScreenImg})),h.default.createElement(Jt,{handleNext:r}))},Ts=e=>{let{handleClose:r}=e,t=dt({light:"/cdn/assets/imgs/245/21F0D08062856488.png",dark:"/cdn/assets/imgs/245/D8A2A5141B0A6F22.png"});return h.default.createElement(h.default.Fragment,null,h.default.createElement(ut,{currentStep:3,handleClose:r}),h.default.createElement(o.Box,{className:G.wrap},h.default.createElement(o.Box,{className:G.title},d("wallet_extension_top_title_asset_allocation1",{app:d("wallet_extension_top_title_asset_allocation2")})),h.default.createElement(k.Text,{className:G.desc},d("wallet_extension_top_subtitle_turnon_ledger")),h.default.createElement(mt,{src:t,className:G.secondAndFourthScreenImg})),h.default.createElement(o.Box,{className:G.footerWrap},h.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,className:"wallet-management__button",onClick:r},d("wallet_extension_footer_btn_connect1"))))},Bs=[gs,ws,Es,Ts],Ls=()=>{let e=(0,fr.useDispatch)(),r=(0,xr.useHistory)(),[t,s]=(0,h.useState)(0),l=Bs[t],m=(0,h.useCallback)(()=>{s(c=>++c)},[]),i=(0,h.useCallback)(()=>{r.replace(Ze)},[r]);return(0,h.useEffect)(()=>{e(Pt("isLedgerImported",!0))},[e]),h.default.createElement(o.Container,{className:G.root},h.default.createElement(l,{handleNext:m,handleClose:i}))},yr=Ls;n();a();var ce=p(C());Be();n();a();var wo=p(xo());var Rt=p(ue()),ft=p(C()),Eo=p(le());X();Be();var hr=(e=!1)=>{let r=O(),t=(0,Eo.useHistory)(),s=r.get("type"),l=r.get("walletId"),m=(0,Rt.useSelector)(zo),i=[];if(s==="addChain")if(m[l]){let{account:c}=m[l];i=Object.keys(c)}else e&&(H.error(d("wallet_extension_top_error_parameters")),t.replace(me));return i},gr=()=>{let e=hr(!0),r=(0,Rt.useSelector)(pt),t=e.includes(q),s=(0,ft.useMemo)(()=>r.filter(l=>l.baseChain===q),[r]);return[t,s]},wr=()=>{let e=hr(),r=(0,Rt.useSelector)(pt);return(0,ft.useMemo)(()=>[Ve,It,Xe].map(s=>{let l=r.find(m=>m.baseChain===s);return{imported:e.includes(s),...l}}),[e,r])},Er=e=>{let r=(0,Eo.useHistory)(),t=O(),s=t.get("type"),l=t.get("walletId");return(0,ft.useCallback)(async()=>{let m=await _t.hasConnectedLedger(),i=!1;if(m||(i=(await _t.requestLedgerDevice()).length===0),i){[ae.addAccount,ae.addChain].includes(s)&&r.goBack();return}let c=`${fe}/${g.ledger}?${wo.default.stringify({baseChain:e})}`;s&&l&&(c+=`&${wo.default.stringify({type:s,walletId:l})}`),r.push(c)},[r,s,l,e])};n();a();var xt={root:"_root_f8vjo_1",chainList:"_chainList_f8vjo_6",footerWrap:"_footerWrap_f8vjo_10"};var Cs=()=>{let e=ee(),r=O(),t=r.get("type"),s=r.get("hideBack"),[l,m]=(0,ce.useState)(""),[i,c]=gr(),f=wr(),x=Er(l);return ce.default.createElement(o.FlexBox,{className:xt.root,align:o.ALIGN.unset,direction:o.DIRECTION.vertical},ce.default.createElement(te,{closeable:!1,backable:!s,className:xt.navigator,title:e("wallet_extension_top_maintitle_select_network")}),ce.default.createElement(o.Box,{className:xt.chainList},ce.default.createElement(yo,{imported:i,selected:q===l,handleClick:()=>{i||m(q)}},ce.default.createElement(_r,{descriptionKey:"wallet_extension_hardware_tooltip_support_range",EVM_CHAINS:c,imported:i,hideRightIcon:!0})),f.map(u=>ce.default.createElement(yo,{imported:u.imported,key:u.chainName,selected:u.baseChain===l,handleClick:()=>{u.imported||m(u.baseChain)},...u}))),ce.default.createElement(o.Box,{className:xt.footerWrap},ce.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,onClick:x,className:"wallet-management__button",disabled:!l},e(t==="addChain"?"wallet_extension_footer_btn_add_network":"wallet_addwallet_btn_conncet_hardware_wallet"))))},Tr=Cs;n();a();var gt=p(le());var $=p(C());X();n();a();var et=p(C()),yt=p(le());xs();fs();Be();var Re=p(ue());fo();X();co();var Br=()=>{let e=O(),{hardware:r}=(0,yt.useParams)(),t=e.get("baseChain"),[s,l]=(0,et.useState)(()=>r===g.ledger?t===Xe?Qo:Vo:Xo);return[s,l]},Lr=()=>{let e=[],r=O(),t=r.get("walletId"),s=r.get("baseChain"),m=(0,Re.useSelector)(bt).find(c=>(c.walletIdentities||[]).some(x=>x.walletId===t));return((m==null?void 0:m.walletIdentities)||[]).forEach(c=>{var x;let f=(x=c==null?void 0:c.account)==null?void 0:x[s];f&&e.push(f)}),e},Cr=()=>{var c;let e=O(),r=e.get("type"),t=e.get("baseChain"),s=(c=Yt())==null?void 0:c.length,[l,m]=(0,et.useState)([]);return[l,f=>{m(x=>r===ae.addChain?[f]:x.some(u=>Pe(u.address,f.address,{localType:t}))?x.filter(u=>!Pe(u.address,f.address,{localType:t})):s+x.length>=500?(H.error({title:d("wallet_extension_hardware_wallet_notif_max_account",{num:500})}),x):[...x,f])}]},Ar=e=>{let[r,t]=(0,et.useState)(!1),{hardware:s}=(0,yt.useParams)(),l=O(),m=l.get("type"),i=l.get("baseChain"),c=l.get("walletId"),f=(0,yt.useHistory)(),x=(0,Re.useDispatch)(),u=ee(),L=(0,Re.useSelector)(T=>{var B;return(B=T==null?void 0:T.metamask)==null?void 0:B.completedOnboarding}),_=(0,Re.useSelector)(T=>{var B;return(B=T==null?void 0:T.metamask)==null?void 0:B.isUnlocked}),E=(0,et.useMemo)(()=>e.map(T=>{let B={};return B.path=T.path,B.address=T.address,i===Ve&&ct.forEach(P=>{let{address:F,path:A,publicKey:U}=T[P];B[P]={address:F,path:A,publicKey:U}}),B}),[e,i]);return[r,async()=>{try{let T={accounts:E,hardware:s,baseChain:i,walletId:c,type:m},B=Yo[g.ledger];if(We()){let A=await Jo()||{};A!=null&&A.productName&&(B=`${ie[g.ledger]} ${A.productName}`)}if(T.ledgerInfo={productName:B},!L){x(Xt(T)),f.push(`${jt}?from=${Qt.HARDWARE}`);return}if(!_){H.error({title:d("wallet_extension_hardware_wallet_notif_please_unlock")});return}St({hardwarewallet_brand:s,device_name:B}),t(!0),await x(Vt(T)),await Qe(x);let P=me;[ae.addAccount,ae.addChain].includes(m)&&(P=`${nr}?from=seedVerify`);let F=qo()===Ho;if(m===ae.addChain&&F){Te().notifyUpdateWalletsAssets(),f.go(-2);return}if(m===ae.addAccount&&F){Te().notifyUpdateWalletsAssets(),We()?f.go(-2):f.go(-1);return}F?f.replace(P):globalThis.platform.openExtensionInPopup(P),t(!1)}catch(T){t(!1),T.message===zt&&H.error(u("extension_wallet_addwallet_toast_wallets_added",{amount:500})),T.message===$t&&H.error(u("wallet_home_toast_network_error"))}}]};n();a();var v=p(C());X();Be();n();a();var To=p(Oe()),Ir=p($e());Uo();var Nr=p(ue());var S=p(C());Be();n();a();var ht=p(C());X();n();a();var eo={root:"_root_v9tdu_1",importedRoot:"_importedRoot_v9tdu_9",tag:"_tag_v9tdu_13"};var J="SELECTED",K="IMPORTED",As=({selectType:e})=>e===K?ht.default.createElement(o.FlexBox,{className:eo.importedRoot,align:o.ALIGN.center},ht.default.createElement(o.Box,{className:eo.tag},d("wallet_extension_card_label_added"))):ht.default.createElement(o.FlexBox,{className:eo.root,align:o.ALIGN.center},ht.default.createElement(Wo,{checked:e===J,circle:!0})),xe=As;n();a();var to=({account:e,selected:r,selectedAddressesInTargetIdentity:t=[],baseChain:s})=>{let l=m=>m.some(i=>(Dt(i)&&(i=i==null?void 0:i.address),Pe(i,e.address,{localType:s})));return l(t)?K:l(r)?J:""};n();a();var Q={root:"_root_ujyxp_1",SELECTED:"_SELECTED_ujyxp_9",selected:"_SELECTED_ujyxp_9",IMPORTED:"_IMPORTED_ujyxp_12",imported:"_IMPORTED_ujyxp_12",main:"_main_ujyxp_15",address:"_address_ujyxp_18",asset:"_asset_ujyxp_24",dontHaveAsset:"_dontHaveAsset_ujyxp_25",assetArrow:"_assetArrow_ujyxp_36",assetModal:"_assetModal_ujyxp_44",assetList:"_assetList_ujyxp_44",chainImage:"_chainImage_ujyxp_58",chainName:"_chainName_ujyxp_63",coinAmountDisplay:"_coinAmountDisplay_ujyxp_68",coinAmountDisplayText:"_coinAmountDisplayText_ujyxp_73",commonFooter:"_commonFooter_ujyxp_79"};var Bo=({account:e,onSelect:r,selectType:t})=>{let[s,l]=(0,S.useState)(!1),m=ee(),i=(0,Nr.useSelector)(pt),c=ir(),f=i.filter(_=>_.baseChain===q),{assetList:x=[]}=e,u=(0,S.useMemo)(()=>f.map(_=>{let{coinId:E}=_,D=(0,Ir.cloneDeep)(_),T=x.find(P=>P.coinId===E);D.coinAmount=(T==null?void 0:T.coinAmount)||"0";let B=c[E];return B&&(D.decimals=B.decimals,D.symbol=B.symbol),D}).sort((_,E)=>E.coinAmount-_.coinAmount),[f,x,c]),{address:L}=e;return S.default.createElement(S.default.Fragment,null,S.default.createElement(o.FlexBox,{align:o.ALIGN.center,className:(0,To.default)(Q.root,{[Q.SELECTED]:t===J,[Q.IMPORTED]:t===K}),key:L,onClick:()=>{t!==K&&r(e)}},S.default.createElement(o.Box,{className:Q.main},S.default.createElement(o.Box,{className:Q.address},e.address),e.hasAsset?S.default.createElement(o.Box,{className:Q.asset,onClick:_=>{_.stopPropagation(),l(!0)}},S.default.createElement("span",null,m("wallet_extension_card_btn_view_assets")),S.default.createElement(de,{className:(0,To.default)("okds-arrow-chevron-right-centered-md",Q.assetArrow)})):S.default.createElement(o.Box,{className:Q.dontHaveAsset},S.default.createElement("span",null,m("wallet_extension_card_btn_noearnings_yet")))),S.default.createElement(xe,{selectType:t})),S.default.createElement(Ye.Action,{onClose:()=>{l(!1)},className:Q.assetModal,visible:s,hideCloseBtn:!0,alignBottom:!0,whiteboard:!0,title:null},S.default.createElement(o.Box,{className:Q.assetList},u.map(_=>S.default.createElement(o.FlexBox,{align:o.ALIGN.center,className:Q.asset},S.default.createElement(Fo,{className:Q.chainImage,src:_.image||Ko}),S.default.createElement(o.Box,{className:Q.chainName},S.default.createElement(pr,{maxWidth:"192px",text:_.chainName})),S.default.createElement(o.Box,{className:Q.coinAmountDisplay},S.default.createElement(k.DisplayAmount,{className:Q.coinAmountDisplayText,mode:k.CRYPTO,symbol:_.symbol,decimals:_.decimals,ellipsis:{tooltip:!0}},_==null?void 0:_.coinAmount))))),S.default.createElement(o.Box,{className:Q.commonFooter},S.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,onClick:()=>l(!1),block:!0},m("wallet_extension_footer_btn_same_device_ok")))))};Bo.pickAssetAccounts=e=>{let r=[];return Fe(e)&&e.forEach(t=>{let{assetList:s=[]}=t||{};Fe(s)&&s.some(l=>Nt(l==null?void 0:l.coinAmount,0))&&(t.hasAsset=!0,r.push(t))}),r};Bo.getSelectType=to;var Sr=Bo;n();a();var Ce=p(C()),br=p(Oe());n();a();var ge={root:"_root_j0ms3_1",SELECTED:"_SELECTED_j0ms3_8",selected:"_SELECTED_j0ms3_8",IMPORTED:"_IMPORTED_j0ms3_11",imported:"_IMPORTED_j0ms3_11",addressBox:"_addressBox_j0ms3_14",block:"_block_j0ms3_18",tag:"_tag_j0ms3_29",assets:"_assets_j0ms3_40",address:"_address_j0ms3_14"};var Lo=({account:e,onSelect:r,selectType:t,baseCoin:s})=>{let l=ee();return Ce.default.createElement(o.FlexBox,{align:o.ALIGN.center,className:(0,br.default)(ge.root,{[ge.SELECTED]:t===J,[ge.IMPORTED]:t===K}),onClick:()=>{t!==K&&r(e)}},Ce.default.createElement(o.Box,{className:ge.addressBox},ct.map(m=>{var i,c;return Ce.default.createElement(o.Box,{className:ge.block},Ce.default.createElement(o.Box,{className:ge.tag},l($o[m])),Ce.default.createElement(k.DisplayAmount,{className:ge.assets,mode:k.CRYPTO,symbol:s.symbol,decimals:s.decimals,ellipsis:{tooltip:!0}},(i=e[m])==null?void 0:i.coinAmount),Ce.default.createElement(o.Box,{className:ge.address},(c=e[m])==null?void 0:c.address))})),Ce.default.createElement(xe,{selectType:t}))};Lo.pickAssetAccounts=e=>{let r=[];return Fe(e)&&e.forEach(t=>{t!=null&&t.hasAsset&&r.push(t)}),r};Lo.getSelectType=({account:e,selected:r,selectedAddressesInTargetIdentity:t,baseChain:s})=>{let l=m=>m.some(i=>{Dt(i)&&(i=i==null?void 0:i.address);let c=!1;return ct.forEach(f=>{var x;Pe((x=e==null?void 0:e[f])==null?void 0:x.address,i,{localType:s})&&(c=!0)}),c});return l(t)?K:l(r)?J:""};var kr=Lo;n();a();var tt=p(C()),Mr=p(Oe());Uo();n();a();var He={root:"_root_h2by8_1",SELECTED:"_SELECTED_h2by8_9",selected:"_SELECTED_h2by8_9",IMPORTED:"_IMPORTED_h2by8_12",imported:"_IMPORTED_h2by8_12",main:"_main_h2by8_15",asset:"_asset_h2by8_19",address:"_address_h2by8_26"};var Co=({account:e,onSelect:r,selectType:t,baseCoin:s})=>{let{symbol:l,decimals:m}=s,{address:i}=e,c=e==null?void 0:e.coinAmount;return tt.default.createElement(o.FlexBox,{align:o.ALIGN.center,className:(0,Mr.default)(He.root,{[He.SELECTED]:t===J,[He.IMPORTED]:t===K}),key:i,onClick:()=>{t!==K&&r(e)}},tt.default.createElement(o.Box,{className:He.main},tt.default.createElement(k.DisplayAmount,{className:He.asset,mode:k.CRYPTO,symbol:l,decimals:m,ellipsis:{tooltip:!0}},c),tt.default.createElement(o.Box,{className:He.address},e.address)),tt.default.createElement(xe,{selectType:t}))};Co.pickAssetAccounts=e=>{let r=[];return Fe(e)&&e.forEach(t=>{Nt(t==null?void 0:t.coinAmount,0)&&r.push(t)}),r};Co.getSelectType=to;var Ao=Co;n();a();var qe=p(C()),Or=p(le());n();a();var Io={title:"_title_1nhzx_1",selector:"_selector_1nhzx_7"};var Is=({basePath:e,setBasePath:r})=>{let{hardware:t}=(0,Or.useParams)(),l=O().get("baseChain"),m=ee(),i=(0,qe.useMemo)(()=>{var c,f;return(f=(c=Zo)==null?void 0:c[t])==null?void 0:f[l]},[l,t]);return i?qe.default.createElement(qe.default.Fragment,null,qe.default.createElement(k.Text,{className:Io.title},m("wallet_addwallet_subtitle_hardware_wallet_select_a_hd_path")),qe.default.createElement(At,{value:e,className:Io.selector,type:At.TYPE.input,options:i,onChange:({value:c})=>{r(c)},align:At.DIRECTION.right})):null},Dr=Is;n();a();var Ae={root:"_root_1uho9_1",title:"_title_1uho9_7",showAll:"_showAll_1uho9_13",showAllText:"_showAllText_1uho9_23",loadMore:"_loadMore_1uho9_26",loadMoreText:"_loadMoreText_1uho9_34",icon:"_icon_1uho9_38"};var vr=8,No={[q]:Sr,[Ve]:kr,[Xe]:Ao,[It]:Ao},Ns=({baseChain:e,basePath:r,setBasePath:t,accounts:s,onLoadMore:l,loadMoreLockRef:m,coinId:i,selected:c,selectedAddressesInTargetIdentity:f,...x})=>{let u=(0,v.useRef)(),L=No[e],_=L.pickAssetAccounts(s),E=_.length,[D,{setFalse:T}]=ar(!!(E&&E!==s.length)),B=(0,v.useRef)(),[P,F]=(0,v.useState)(vr),A=async()=>{clearInterval(B.current),F(vr),B.current=setInterval(()=>{F(R=>Math.max(R-1,0))},1e3),l()};Gt(()=>{clearInterval(B.current)}),Zt(u.current,()=>{if(s.length<500&&!D&&!m.current)try{A()}catch(R){console.log(R)}},10);let{baseCoin:U}=cr(i,!0),ne=R=>R.map(oe=>{let N=L.getSelectType({account:oe,selected:c,selectedAddressesInTargetIdentity:f,baseChain:e});return v.default.createElement(L,{account:oe,baseCoin:U,selectType:N,...x})}),be=R=>v.default.createElement(v.default.Fragment,null,ne(R),v.default.createElement(o.Box,{className:Ae.showAll,onClick:T},v.default.createElement("span",{className:Ae.showAllText},d("wallet_extension_top_dropdown_show_assets")),v.default.createElement(de,{className:"okds-arrow-chevron-down-md"}))),ke=R=>v.default.createElement(v.default.Fragment,null,ne(R),s.length<500&&v.default.createElement(o.Box,{className:Ae.loadMore},v.default.createElement(ze,null),v.default.createElement("span",{className:Ae.loadMoreText},P>0?d("wallet_extension_footer_loading_est_loading",{value:P}):d("wallet_extension_footer_loading_wait_amoment"))));return v.default.createElement(o.FlexBox,{ref:u,className:Ae.root,align:o.ALIGN.unset,direction:o.DIRECTION.vertical},v.default.createElement(Dr,{basePath:r,setBasePath:t}),v.default.createElement(k.Text,{className:Ae.title},d("wallet_extension_top_title_select"),e===q?v.default.createElement(ve,{className:Ae.icon,icon:"okx-wallet-plugin-information-circle",tooltip:{title:d("wallet_extension_toast_tooltip_try_switch"),placement:Po.DIRECTION.bottom},size:ve.SIZE.xs}):null),D?be(_):ke(s))},Wr=Ns;n();a();var se=p(C());n();a();var re={root:"_root_10n9q_1",header:"_header_10n9q_5",back:"_back_10n9q_12",close:"_close_10n9q_13",title:"_title_10n9q_17",content:"_content_10n9q_21",selectorTitle:"_selectorTitle_10n9q_24",selector:"_selector_10n9q_24",item:"_item_10n9q_34",lock:"_lock_10n9q_38",button:"_button_10n9q_43"};var Ss=({handleClick:e})=>se.default.createElement(o.Box,{className:re.root,onClick:e},se.default.createElement(o.FlexBox,{justify:"space-between",className:re.header},se.default.createElement(_e.Input,{active:!0,className:re.back}),se.default.createElement(_e.Input,{active:!0,className:re.title}),se.default.createElement(_e.Input,{active:!0,className:re.close})),se.default.createElement(o.Box,{className:re.content},se.default.createElement(_e.Input,{active:!0,className:re.selectorTitle}),se.default.createElement(_e.Input,{active:!0,className:re.selector}),se.default.createElement(_e.Input,{active:!0,className:re.selectorTitle}),se.default.createElement(_e.Input,{active:!0,className:re.item}),se.default.createElement(_e.Input,{active:!0,className:re.lock})),se.default.createElement(_e.Input,{active:!0,className:re.button})),Ie=Ss;n();a();var So={root:"_root_fhwwp_1",footerWrap:"_footerWrap_fhwwp_5",accountList:"_accountList_fhwwp_10",account:"_account_fhwwp_10",accountLeft:"_accountLeft_fhwwp_23",address:"_address_fhwwp_26",path:"_path_fhwwp_33",assets:"_assets_fhwwp_39",accountRight:"_accountRight_fhwwp_44"};var bs=()=>{let e=ee(),{hardware:r}=(0,gt.useParams)(),t=O(),s=t.get("hideBack"),l=t.get("baseChain"),m=Lr(),[i,c]=Br(),[f,x]=Cr(),u=mr({baseChain:l})||[],{coinId:L}=(u==null?void 0:u[0])||{},_=(0,gt.useHistory)(),[E,D]=(0,$.useState)([]),[T,B]=(0,$.useState)(0),P=async(oe=T)=>{if(!r)return[];try{return await sr({hardware:r,page:oe,basePath:i,baseChain:l,coinId:L})}catch(N){switch(console.log(N),console.log(N.name),console.log(N.message),N.name){case"LockedDeviceError":Ot.openModal(Mt.lockedDevice,{baseChain:l,onButtonClick:()=>{window.location.reload()},onCloseBtnClick:()=>{_.goBack()}});break;case"InvalidStateError":case"TransportStatusError":Ot.openModal(Mt.wrongAppToGetAddress,{baseChain:l,onButtonClick:()=>{window.location.reload()},onCloseBtnClick:()=>{_.goBack()}});break;case"TransportError":break;default:Ot.openModal(Mt.connectError,{onButtonClick:async()=>{if(N.name==="TransportOpenUserCancelled"&&(await _t.requestLedgerDevice()).length){U();return}window.location.reload()},onCloseBtnClick:()=>{_.goBack()}});break}throw N}},[F,A]=(0,$.useState)(!0),U=async()=>{A(!0);let oe=await P(0);D(oe),A(!1)};(0,$.useEffect)(()=>{L&&(B(0),U())},[i,L]);let ne=(0,$.useRef)(!1),be=async()=>{if(ne.current)return;ne.current=!0;let oe=T+1;B(oe);let N=await P(oe);D(w=>[...w,...N]),ne.current=!1},[ke,R]=Ar(f);return $.default.createElement($.default.Fragment,null,F?$.default.createElement(Ie,null):$.default.createElement(o.FlexBox,{className:So.root,align:o.ALIGN.unset,direction:o.DIRECTION.vertical},$.default.createElement(te,{closeable:!1,backable:!s,title:e("wallet_extension_top_maintitle_select_address")}),$.default.createElement(Wr,{basePath:i,setBasePath:c,accounts:E,selected:f,selectedAddressesInTargetIdentity:m,baseChain:l,onLoadMore:be,loadMoreLockRef:ne,onSelect:x,coinId:L}),$.default.createElement(o.Box,{className:So.footerWrap},$.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,className:"wallet-management__button",disabled:!f.length,loading:ke,onClick:R},f.length?e("wallet_extension_footer_btn_connecting",{value:f.length}):e("wallet_extension_footer_btn_connect")))))},Pr=e=>{let r=(0,gt.useHistory)(),s=O().get("baseChain");return Object.keys(No).includes(s)?$.default.createElement(bs,{...e}):(H.error(d("wallet_extension_top_error_parameters")),r.replace(me),null)};n();a();var wt=p(C());X();n();a();var bo=p(xo()),Fr=p(ue()),Ur=p(le()),oo=p(C());Be();var Hr=()=>{let e=(0,Ur.useHistory)(),{isLedgerImported:r}=(0,Fr.useSelector)(Ft),t=(0,oo.useMemo)(()=>({[g.ledger](){We()?r?e.push(Ze):e.push(Ht):e.push(`${fe}/${g.ledger}?${bo.default.stringify({baseChain:q})}`)},[g.trezor](){e.push(`${fe}/${g.trezor}?${bo.default.stringify({baseChain:q})}`)},[g.onekey](){e.push(qt)},[g.keystone](){e.push(`${fe}/${g.keystone}`)}}),[r,e]);return(0,oo.useCallback)(({brand:l})=>{Go({hardwarewallet_brand:l}),jo(),t[l]()},[t])};n();a();var ko=p(Oe());X();var we=p(C());n();a();var je={root:"_root_m678d_1",recommend:"_recommend_m678d_19",brandInfo:"_brandInfo_m678d_22",icon:"_icon_m678d_27",name:"_name_m678d_32",arrow:"_arrow_m678d_37"};var ks=e=>{let{icon:r,wallet:t,onClick:s}=e,l=(0,we.useCallback)(()=>{s(t)},[t,s]);return we.default.createElement(o.Box,{onClick:l,className:je.root},we.default.createElement(o.Box,{className:je.brandInfo},we.default.createElement(ve,{className:(0,ko.default)(r,je.icon)}),we.default.createElement(o.Box,{className:je.name},t.name),t.recommend?we.default.createElement(De,{className:je.recommend,type:De.TYPE.rect,color:De.COLOR.green},d("wallet_onekey_tag_new")):null),we.default.createElement(ve,{size:ve.SIZE.xs,className:(0,ko.default)("okds-arrow-chevron-right-centered-md",je.arrow)}))},ro=ks;n();a();var so={root:"_root_gtfj8_1",navigator:"_navigator_gtfj8_4",wrap:"_wrap_gtfj8_7"};var{isFirefox:Ms,versionNumber:Os}=vo,Ds=[{name:ie[g.keystone],icon:"okx-wallet-plugin-keystone",brand:g.keystone,recommend:!0},!(Ms&&Ct.gte(Os,112))||We()?{name:ie[g.ledger],icon:"okx-wallet-plugin-ledger",brand:g.ledger,recommend:!1}:null,{name:ie[g.onekey],icon:"okx-wallet-plugin-onekey",brand:g.onekey,recommend:!1},{name:ie[g.trezor],icon:"okx-wallet-plugin-trezor",brand:g.trezor,recommend:!1}].filter(Boolean),vs=()=>{let e=Hr();return wt.default.createElement(o.Container,{className:so.root},wt.default.createElement(te,{closeable:!1,backable:!1,bordered:!1,className:so.navigator,title:d("wallet_addwallet_maintitle_connect_hareware_wallet")}),wt.default.createElement(o.Box,{className:so.wrap},Ds.map(r=>wt.default.createElement(ro,{wallet:r,icon:r.icon,onClick:e}))))},qr=vs;n();a();var Jr=p($e());X();var Rr=p(le());var Y=p(C()),ao=p(ue());Be();n();a();var Ne=p(C()),jr=p(Oe());var Gr=p($e());X();n();a();var Ge={root:"_root_gwbd5_1",SELECTED:"_SELECTED_gwbd5_10",selected:"_SELECTED_gwbd5_10",IMPORTED:"_IMPORTED_gwbd5_13",imported:"_IMPORTED_gwbd5_13",selector:"_selector_gwbd5_16",main:"_main_gwbd5_19",name:"_name_gwbd5_23",assets:"_assets_gwbd5_29"};var Ws=e=>{var c;let{account:r,children:t,setSelected:s,selectType:l,badgeSlot:m=null}=e,i=(c=Yt())==null?void 0:c.length;return Ne.default.createElement(o.Box,{className:(0,jr.default)(Ge.root,Ge[l]),onClick:()=>{l!==K&&s(f=>l===J?f.filter(x=>x.index!==r.index):i+f.length>=500?(H.error({title:d("wallet_extension_hardware_wallet_notif_max_account",{num:500})}),f):[...f,r])}},Ne.default.createElement(o.FlexBox,{className:Ge.selector,align:o.ALIGN.center},Ne.default.createElement(o.FlexBox,{justify:o.ALIGN.center,direction:o.DIRECTION.vertical,className:Ge.main},Ne.default.createElement(o.FlexBox,{align:o.ALIGN.center},Ne.default.createElement(o.Box,{className:Ge.name},d("wallet_extension_card_title_account",{value:`${(0,Gr.padStart)(`${r.index+1}`,2,"0")}`})),m),!!r.balance&&Ne.default.createElement(k.DisplayAmount,{ellipsis:!0,symbol:"$",mode:k.LEGAL,useApproximate:!1,className:Ge.assets},r.balance)),Ne.default.createElement(xe,{selectType:l})),t)},ot=Ws;co();fo();n();a();var Kr=p(C());us();var Ps=(e,r)=>{let t=e.index;return t!==void 0&&t===r.index},Fs=(e,r)=>{var s,l;let t=(s=r==null?void 0:r[po])==null?void 0:s.address;return!!t&&((l=e==null?void 0:e.account)==null?void 0:l[po])===t},Us=(e,r)=>(0,Kr.useCallback)(t=>{let s=e.some(m=>m.index===t.index);return r.some(m=>Ps(m,t)||Fs(m,t))?K:s?J:""},[e,r]),rt=Us;n();a();var Mo=p(Oe());X();var M=p(C());Be();n();a();var z={root:"_root_p506l_1",tip:"_tip_p506l_8",icon:"_icon_p506l_13",info:"_info_p506l_19",desc:"_desc_p506l_23",entry:"_entry_p506l_28",dialogRoot:"_dialogRoot_p506l_34",title:"_title_p506l_38",listWrap:"_listWrap_p506l_43",pathItem:"_pathItem_p506l_43",recommendItem:"_recommendItem_p506l_52",SELECTED:"_SELECTED_p506l_55",selected:"_SELECTED_p506l_55",recommend:"_recommend_p506l_52",detail:"_detail_p506l_70",path:"_path_p506l_43",address:"_address_p506l_81",balance:"_balance_p506l_89"};var $r=(0,M.memo)(({account:e,selectType:r,updateAddressType:t})=>{let{mainnet:s,addressType:l,addressTypeUpdated:m}=e,i=l[q],[c,f]=(0,M.useState)(!1),u=Object.values(s).filter(({balance:E})=>Ct.gt(E,0)),L=E=>{f(!1),t(e,E,q)},_=(0,M.useMemo)(()=>r===K||m?d("wallet_extension_hardware_wallet_notif_current_address",{network:"EVM",address:_o(s[i].address)}):d("wallet_extension_card_alert_default_option",{network:"EVM",address:_o(s[i].address)}),[m,r,i,s]);return u.length<=1||u.length===2&&u[0].address===u[1].address?null:M.default.createElement(o.Box,{className:z.root},M.default.createElement(o.FlexBox,{className:z.tip},M.default.createElement(de,{className:(0,Mo.default)("okx-wallet-plugin-information-circle",z.icon)}),M.default.createElement(o.Box,{className:z.info},M.default.createElement(o.Box,{className:z.desc},_),M.default.createElement(o.Box,{className:z.entry,onClick:()=>{f(!0)}},d("wallet_extension_card_textbtn_change_network",{network:"EVM"})))),M.default.createElement(Ye.Action,{noContentPadding:!0,visible:c,alignBottom:!0,onClose:()=>{f(!1)}},M.default.createElement(o.Box,{className:z.dialogRoot},M.default.createElement(o.Box,{className:z.title},d("wallet_extension_top_title_change_evm",{network:"EVM"})),M.default.createElement(o.Box,{className:z.listWrap},vt(e.index).map(E=>{let D=i===E.type;return M.default.createElement(o.FlexBox,{className:(0,Mo.default)(z.pathItem,{[z.recommendItem]:E.recommend,[z.SELECTED]:D}),onClick:()=>{D||L(E.type)},align:o.ALIGN.center},!!E.recommend&&M.default.createElement(o.Box,{className:z.recommend},d("wallet_extension_top_tag_recommended")),M.default.createElement(o.Box,{className:z.detail},M.default.createElement(o.Box,{className:z.path},E.pathName),M.default.createElement(o.Box,{className:z.address},s[E.type].address),M.default.createElement(k.DisplayAmount,{ellipsis:!0,symbol:"$",mode:k.LEGAL,useApproximate:!1,className:z.balance},s[E.type].balance)),M.default.createElement(xe,{selectType:D?J:""}))})))))});n();a();X();var no=p(C()),zr=p(le()),Et=p(ue());co();fo();var Hs=(e,r)=>{let t={[g.onekey](){let{onekeyInfo:s}=r,l=s==null?void 0:s.deviceType;return l?`${e}_${l}`:e},[g.keystone](){let{keystoneInfo:s}=r;return(s==null?void 0:s.device)||e},[g.trezor](){return ie[g.trezor]}};return t[e]?t[e]():"unknown"},qs=({hardware:e,selected:r,walletId:t,walletInfo:s={}})=>{let[l,m]=(0,no.useState)(!1),i=(0,zr.useHistory)(),c=(0,Et.useDispatch)(),f=O(),x=(0,Et.useSelector)(_=>{var E;return(E=_==null?void 0:_.metamask)==null?void 0:E.completedOnboarding}),u=(0,Et.useSelector)(_=>{var E;return(E=_==null?void 0:_.metamask)==null?void 0:E.isUnlocked}),L=(0,no.useCallback)(async()=>{try{let _={hardware:e,walletId:t,accounts:r,...s};if(t&&(_.type=ae.addAccount),!x){c(Xt(_)),i.push(`${jt}?from=${Qt.HARDWARE}`);return}if(!u){H.error({title:d("wallet_extension_hardware_wallet_notif_please_unlock")});return}m(!0),St({hardwarewallet_brand:e,device_name:Hs(e,s)}),await c(Vt(_)),await Qe(c),m(!1),ae.addAccount===f.get("type")?(H.success({title:d("wallet_addacount_toast_account_created")}),Te().notifyUpdateWalletsAssets(),e===g.trezor?globalThis.platform.openExtensionInPopup(me):i.go(-1)):globalThis.platform.openExtensionInPopup(me)}catch(_){m(!1),_.message===zt&&H.error(d("extension_wallet_addwallet_toast_wallets_added",{amount:500})),_.message===$t&&H.error(d("wallet_home_toast_network_error"))}},[f,i,r,e,t,c,s,u,x]);return[l,L]},st=qs;n();a();var Oo=p($e());var Yr=p(ue()),Se=p(C());var js=e=>{let t=O().get("walletId"),s=(0,Yr.useSelector)(bt),[l,m]=(0,Se.useState)(()=>t?s.find(u=>(u.walletIdentities||[]).some(_=>_.walletId===t))||{}:{});(0,Se.useEffect)(()=>{if(e&&(0,Oo.isEmpty)(l)){let u=s.find(L=>L.masterFingerprint===e);u&&!(0,Oo.isEmpty)(u)&&m(u)}},[s,e,l]);let[i,c]=(0,Se.useState)([]);(0,Se.useEffect)(()=>{let u=(l==null?void 0:l.walletIdentities)||[];c(u)},[l]);let[f,x]=(0,Se.useState)(t);return(0,Se.useEffect)(()=>{let u=i==null?void 0:i[0];x((u==null?void 0:u.walletId)||"")},[i]),{targetKeyringIdentity:l,targetWalletIdentities:i,targetWalletId:f}},Vr=js;n();a();X();var Xr=p($e()),Ke=p(C()),Gs=(e,r)=>{let t=(0,Ke.useRef)(),s=(0,Ke.useRef)(),[l,m]=(0,Ke.useState)("");return(0,Ke.useEffect)(()=>{if(!(t.current&&s.current))return Xr.noop;let i=new IntersectionObserver(([c])=>{c.isIntersecting?m(""):m(d("wallet_extension_top_title_select_account"))},{root:t.current});return i.observe(s.current),()=>{i.disconnect()}},[e,r]),{title:l,wrapRef:t,titleRef:s}},Qr=Gs;n();a();var Do=p(C());X();n();a();var Zr={root:"_root_14fge_1"};var Ks=({selected:e,isSubmiting:r,handleSubmit:t})=>Do.default.createElement(o.Box,{className:Zr.root},Do.default.createElement(I,{block:!0,loading:r,category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,disabled:!e.length,onClick:t},e.length?d("wallet_extension_footer_btn_connecting",{value:e.length}):d("wallet_extension_footer_btn_connect"))),nt=Ks;n();a();var at={root:"_root_1bpx3_1",navigator:"_navigator_1bpx3_6",wrap:"_wrap_1bpx3_9",title:"_title_1bpx3_15",desc:"_desc_1bpx3_21"};var es=()=>{let[e,r]=(0,Y.useState)(!0),t=(0,Rr.useHistory)(),[s,l]=(0,Y.useState)(""),m=(0,ao.useSelector)(w=>{var b,j;return((j=(b=w==null?void 0:w.metamask)==null?void 0:b.walletConfig)==null?void 0:j.scanedKeyStoneMap)||{}}),i=m[s]||{},{targetKeyringIdentity:c,targetWalletIdentities:f,targetWalletId:x}=Vr(s),[u,L]=(0,Y.useState)([]),_=(0,ao.useDispatch)(),E=(0,Y.useCallback)(async w=>{await Te().setScanedKeyStone(w),await Qe(_)},[_]),{hasDangerKeystoneScaned:D}=dr(),T=(0,Y.useCallback)(async w=>{l(w.masterFingerprint);let b=await tr(w),j=await Ro(b);await E({...w,accountsWithBalance:j});let{device:Me}=w;Me===er&&(D||(_(Pt("hasDangerKeystoneScaned",!0)),uo.showUpdateModal())),r(!1)},[E]),B=w=>{r(!1);let b=m[w];T(b)},P=async()=>{let w=await uo.openModal(or.getAccounts,{onBackBtnClick(){t.goBack()}}),b=m[w.masterFingerprint];b&&(w.accountsWithBalance=b.accountsWithBalance),T(w)};Kt(()=>{c!=null&&c.masterFingerprint?B(c==null?void 0:c.masterFingerprint):P()});let F=i==null?void 0:i.accountsWithBalance,{title:A,wrapRef:U,titleRef:ne}=Qr(F,e),be=rt(u,f),[ke,R]=st({walletInfo:{keystoneInfo:(0,Jr.pick)(i,["device","deviceId","masterFingerprint"])},selected:u,walletId:x,hardware:g.keystone}),oe=async(w,b,j=q)=>{let Me=f.find(he=>he.index===w.index);Me&&await Te().updateWalletAddress(Me.walletId,{[j]:b});let{accountsWithBalance:Tt}=i,Bt=Tt.map(he=>{if(w.index===he.index){let{addressType:Lt}=he;return{...he,addressType:{...Lt,[j]:b},addressTypeUpdated:!0}}return he});E({...i,accountsWithBalance:Bt})},N=((w={})=>b=>{var Tt,Bt,he,Lt;let j=(Tt=b==null?void 0:b.addressType)==null?void 0:Tt[q];if(w[j])return w[j];let Me=((Bt=vt(0).find(_s=>_s.type===j))==null?void 0:Bt.pathName)||"";return Me?w[j]=(Lt=(he=Me.split("|"))==null?void 0:he[0])==null?void 0:Lt.trim():w[j]="",w[j]})();return e?Y.default.createElement(Ie,null):Y.default.createElement(o.FlexBox,{className:at.root,align:o.ALIGN.unset,direction:o.DIRECTION.vertical},Y.default.createElement(te,{closeable:!1,bordered:!1,title:A,className:at.navigator}),Y.default.createElement(o.FlexBox,{direction:o.DIRECTION.vertical,className:at.wrap,ref:U},Y.default.createElement(o.Box,{className:at.title,ref:ne},d("wallet_extension_top_title_select_account")),Y.default.createElement(o.Box,{className:at.desc},d("extension_wallet_hardware_wallet_text_multi_net")),F.map(w=>{let b=be(w),j=N(w);return Y.default.createElement(ot,{account:w,selectType:b,setSelected:L,badgeSlot:j?Y.default.createElement(De,{type:De.TYPE.rect},j):null},Y.default.createElement($r,{account:w,selectType:b,updateAddressType:oe}))})),Y.default.createElement(nt,{selected:u,isSubmiting:ke,handleSubmit:R}))};n();a();var rs=p($e());X();var ss=p(ue());var ns=p(le());var W=p(C());n();a();var lo=(e,r)=>`${e}${r}`,ts=(e,r)=>!!((e==null?void 0:e.connectId)&&e.connectId===r.connectId&&e.firstEvmAddress===r.firstEvmAddress);n();a();var io=p(C());var os=e=>{let r=Je(),t=(0,io.useMemo)(()=>(r==null?void 0:r.find(m=>{if(kt(m.initialType)){let{firstEvmAddress:i,connectId:c}=(m==null?void 0:m.onekeyInfo)||{};return lo(c,i)===e}return!1}))||{},[r,e]),s=(0,io.useMemo)(()=>t.walletIdentities||[],[t]),l=(0,io.useMemo)(()=>s.length?s[0].walletId:"",[s]);return{targetKeyringIdentity:t,targetWalletIdentities:s,targetWalletId:l}};n();a();var lt={root:"_root_17q34_1",list:"_list_17q34_5",desc:"_desc_17q34_11",loadMore:"_loadMore_17q34_17"};var $s=new Wt,zs=()=>{let e=O(),r=e.get("connectId"),t=e.get("firstEvmAddress"),s=lo(r,t),{connectedOnekey:l}=(0,ss.useSelector)(Ft),[m,i]=(0,W.useState)(),[c,f]=(0,W.useState)(0),[x,u]=(0,W.useState)([]),[L,_]=(0,W.useState)(!1),[E,D]=(0,W.useState)(!1),T=(0,W.useRef)(!1),B=async(N,w=m)=>{T.current=!0;let b=await $s.getAccounts({page:N,onekeyInfo:w});N===0?(u(b),D(!0)):u(j=>[...j,...b]),T.current=!1},P=async()=>{if(T.current)return;let N=c+1;try{await B(N),f(N)}catch(w){console.log(w)}};Zt(L,()=>{x.length<500&&P()},10);let[F,A]=(0,W.useState)([]),{targetWalletIdentities:U,targetWalletId:ne}=os(s),be=rt(F,U),[ke,R]=st({walletInfo:{onekeyInfo:(0,rs.pick)(m,["connectId","deviceId","deviceType","firstEvmAddress"])},selected:F,walletId:ne,hardware:g.onekey}),oe=(0,ns.useHistory)();return(0,W.useEffect)(()=>{let N=l[s];if(!N){H.error(d("wallet_extension_top_error_parameters")),oe.replace(me);return}i(N);let{accountsWithBalance:w}=N;w&&u(w);try{B(c,N)}catch(b){console.log(b)}},[s]),x.length?W.default.createElement(o.FlexBox,{direction:o.DIRECTION.vertical,className:lt.root},W.default.createElement(te,{bordered:!1,closeable:!1,className:lt.navigator,title:d("wallet_extension_onekey_title_import_account")}),W.default.createElement(o.Box,{ref:_,className:lt.list},W.default.createElement(o.Box,{className:lt.desc},d("extension_wallet_hardware_wallet_text_multi_net")),x.map(N=>{let w=be(N);return W.default.createElement(ot,{account:N,selectType:w,setSelected:A})}),x.length<500&&E?W.default.createElement(o.Box,{className:lt.loadMore},W.default.createElement(ze,null)):null),W.default.createElement(nt,{selected:F,isSubmiting:ke,handleSubmit:R})):W.default.createElement(Ie,null)},as=zs;n();a();X();var ls=p(le()),V=p(C());n();a();var it={root:"_root_1scxf_1",list:"_list_1scxf_5",desc:"_desc_1scxf_11",loadMore:"_loadMore_1scxf_17"};var Ys=new rr,Vs=()=>{var F;let r=O().get("walletId"),[t,s]=(0,V.useState)(!1),l=async A=>{let U=(A==null?void 0:A.nextPage)||0;return{list:await Ys.getAccounts({page:U}),nextPage:U+1}},m=(0,V.useRef)(),{data:i,loading:c,noMore:f}=lr(l,{target:m,isNoMore:A=>{var U;return((U=A==null?void 0:A.list)==null?void 0:U.length)>=500},onError:()=>{s(!0)}}),x=Je(),[u,L]=(0,V.useState)([]),_=x==null?void 0:x.find(({walletIdentities:A})=>A.some(U=>U.walletId===r)),{walletIdentities:E=[]}=_||{},D=rt(u,E),[T,B]=st({selected:u,walletId:r,hardware:g.trezor}),P=(0,ls.useHistory)();return V.default.createElement(V.default.Fragment,null,!!(c||t)&&V.default.createElement(Ie,null),V.default.createElement(o.FlexBox,{direction:o.DIRECTION.vertical,className:it.root},V.default.createElement(te,{bordered:!1,closeable:!1,className:it.navigator,title:d("wallet_extension_onekey_title_import_account")}),V.default.createElement(o.Box,{ref:m,className:it.list},V.default.createElement(o.Box,{className:it.desc},d("extensions_hardware_support_text_evm_only",{brand:ie[g.trezor]})),(F=i==null?void 0:i.list)==null?void 0:F.map(A=>{let U=D(A);return V.default.createElement(ot,{account:A,selectType:U,setSelected:L})}),f?null:V.default.createElement(o.Box,{className:it.loadMore},V.default.createElement(ze,null))),V.default.createElement(nt,{selected:u,isSubmiting:T,handleSubmit:B})),V.default.createElement(Ye.Prompt,{btnFull:!0,visible:t,infoType:!1,alignBottom:!1,hideCloseBtn:!!r,title:d("wallet_add_wallet_maintitle_hardware_wallet_conncet_failed"),text:d("wallet_add_wallet_modal_hardware_wallet_conncet_failed_tip"),onConfirm:()=>{window.location.reload()},confirmBtnProps:{type:I.TYPE.highlight,size:I.SIZE.lg},confirmText:d("wallet_manage_wallet_btn_reconncet_hardware_wallet"),onClose:()=>{P.goBack()}}))},is=Vs;n();a();var cs=p(xo());X();var ps=p(ue());var Ee=p(C());n();a();var mo={root:"_root_pxrbs_1",navigator:"_navigator_pxrbs_4",list:"_list_pxrbs_7"};var ms=new Wt,Xs=({history:e})=>{let[r,t]=(0,Ee.useState)([]),s=(0,Ee.useRef)(),l=async()=>{try{let x=await ms.searchDevices();x.length?(t(x),s.current=null):s.current=setTimeout(()=>{l()},3e3)}catch{e.goBack()}};Kt(l),Gt(()=>{s.current&&clearTimeout(s.current)});let m=Je(),i=(x,u)=>m.some(L=>{if(kt(L.initialType)){let{onekeyInfo:_}=L;return ts(_,{connectId:x,firstEvmAddress:u})}return!1}),c=(0,ps.useDispatch)(),f=async({connectId:x,deviceId:u,deviceType:L})=>{try{let _=await ms.getFirstEvmAddress({dispatch:c,connectId:x,deviceId:u,deviceType:L});if(i(x,_)){H.error({title:d("wallet_extension_hardware_wallet_notif_hardware_already")});return}e.push(`${fe}/${g.onekey}?${cs.default.stringify({firstEvmAddress:_,connectId:x})}`)}catch(_){console.log(_)}};return Ee.default.createElement(o.Container,{className:mo.root,loading:r.length?!1:{loadingText:d("wallet_onekey_text_searching_for_equipment")}},Ee.default.createElement(te,{stickyStyle:{zIndex:3},className:mo.navigator,closeable:!1,bordered:!1,title:d("wallet_onekey_title_connect_device")}),Ee.default.createElement(o.Box,{className:mo.list},r.map(x=>Ee.default.createElement(ro,{wallet:x,onClick:f,icon:"okx-wallet-plugin-equipment"}))))},ds=Xs;n();a();var Qs={[g.keystone]:es,[g.ledger]:Pr,[g.onekey]:as,[g.trezor]:is},Zs=()=>ye.default.createElement(pe.Switch,null,ye.default.createElement(pe.Route,{path:Ut,component:qr,exact:!0}),ye.default.createElement(pe.Route,{path:Ht,component:yr,exact:!0}),ye.default.createElement(pe.Route,{path:Ze,component:Tr,exact:!0}),ye.default.createElement(pe.Route,{path:qt,component:ds,exact:!0}),ye.default.createElement(pe.Route,{path:`${fe}/:hardware`,render:e=>{var s,l;let r=(l=(s=e==null?void 0:e.match)==null?void 0:s.params)==null?void 0:l.hardware,t=Qs[r];return t?ye.default.createElement(t,null):ye.default.createElement(pe.Redirect,{to:Ut})},exact:!0}),ye.default.createElement(pe.Redirect,{to:Ut})),du=Zs;export{du as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=ConnectHardware-ON2RSHH5.js.map
