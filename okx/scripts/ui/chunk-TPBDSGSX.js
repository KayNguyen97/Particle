import{U as g,X as h,b as E}from"./chunk-UXFKODVN.js";import{C as K,D as M,q as N}from"./chunk-CVJKAN5R.js";import{f as v,m as L,o as P}from"./chunk-6V2G2Z5W.js";L();P();K();var I=v(M()),d={NATIVE:132,TOKEN:99,NFT:66,OTHERS:33},p={add:"+",sub:"-"},x="306001",w=s=>{let{approveList:t=[],assetChange:A=[]}=s||{};if(t.length){let e=t[0];if([E.AUTHORIZATION,E.CANCEL_AUTHORIZATION,E.INCREASE_ALLOWANCE,E.DECREASE_ALLOWANCE,E.COMMON_APPROVE,E.NFT_AUTHORIZATION,E.NFT_CANCEL_AUTHORIZATION].includes(e==null?void 0:e.approvalType))return e.approvalType}return A.length?E.TRANS_OUT:""},H=(s,t)=>{let A=s.filter(({operator:r})=>r===p.sub),e=s.filter(({operator:r})=>r===p.add),l=(r,o)=>{var S,b;let a=r[t],i=o[t],c=(S=r.asset)==null?void 0:S.decimals,F=(b=o.asset)==null?void 0:b.decimals;return c&&F&&(a=N.div(a,N.pow(10,c)),i=N.div(i,N.pow(10,F))),N.sub(i,a)};return A.sort(l),e.sort(l),[...A,...e]},Z=(s,t)=>{var _,f,V;if(!s||(0,I.isEmpty)(s))return{};let A=((_=s.assetsDiffs)==null?void 0:_[t])||{},e=((f=s.exposures)==null?void 0:f[t])||[],l=((V=s.permissions)==null?void 0:V[t])||[],r=s.permissionMsg||"",o=s.blackAddressWarning||{},a=[];if((0,I.isArray)(e)){let n=e[0]||{},{asset:T={},spenders:u={}}=n;Object.entries(u).forEach(([C,m])=>{a.push({asset:T,address:C,...m})})}let i=[];(0,I.isArray)(A)&&A.forEach(n=>{var u,C,m;let{asset:T}=n||{};if(n!=null&&n.diff){let O=N.gt(n.diff,0);i.push({asset:T,usdValue:n.diffUsdValue,operator:O?p.add:p.sub,rawValue:O?n.diff:(u=n.diff)==null?void 0:u.slice(1)})}else(C=n==null?void 0:n.out)==null||C.forEach(O=>{i.push({asset:T,operator:p.sub,...O})}),(m=n==null?void 0:n.in)==null||m.forEach(O=>{i.push({asset:T,operator:p.add,...O})})});let c={};[d.NATIVE,d.TOKEN,d.OTHERS].forEach(n=>{let T=i.filter(u=>{var C;return((C=u==null?void 0:u.asset)==null?void 0:C.assetType)===n});c[n]=H(T,"rawValue")});let S=i.filter(n=>{var T;return((T=n==null?void 0:n.asset)==null?void 0:T.assetType)===d.NFT}),b=H(S,"tokenNum"),U=[...c[d.NATIVE],...c[d.TOKEN],...b,...c[d.OTHERS]];return{permission:l,permissionMsg:r,assetChange:U,approveList:a,blackAddress:o}},D=s=>s&&(s==null?void 0:s.result)===!1,G=s=>s&&((s==null?void 0:s.resultCode)===x||(s==null?void 0:s.addFundsFlag)),W=s=>D(s)&&!G(s),X=(s,t,A={})=>{let{from:e}=A||{},l={};return t==null||t.forEach(r=>{let o=(s==null?void 0:s.find(a=>(a==null?void 0:a.checkType)===r))||{};if(r===g.SAFE_ADDRESS){let a=Boolean(o==null?void 0:o.blackAddress),i=(o==null?void 0:o.isSimilar)||h.FAILED;l[r]={...o,isDefraud:a,similarType:i,isSimilar:[h.EXACT,h.ROUGH].includes(i)}}else if(r===g.CONTRACT_ADDRESS)l[r]={...o,isContract:typeof(o==null?void 0:o.result)=="boolean"&&!(o!=null&&o.result)};else if(r===g.KYS){let a=Z(o,e);l[r]={...a,txType:w(a)}}else r===g.VERIFY_GAS_LIMIT?l[r]={...o,isPreExecuteFailed:D(o),isPreExecuteGasError:G(o),isPreExecuteNonGasError:W(o)}:l[r]=o}),l};export{d as a,p as b,X as c};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-TPBDSGSX.js.map
