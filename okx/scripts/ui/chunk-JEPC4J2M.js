import{a as N}from"./chunk-IFXL6RBY.js";import{a as k}from"./chunk-H5KDYYS6.js";import{b as C}from"./chunk-E73QHIZ6.js";import{a as D}from"./chunk-PCY622ND.js";import{d as A,e as E}from"./chunk-MTMZQEHP.js";import{ua as I}from"./chunk-O4EDZSHP.js";import{d as y,f as j}from"./chunk-S4N75E3H.js";import{b as T,p as h}from"./chunk-UXFKODVN.js";import{a as M}from"./chunk-TPSXCUGD.js";import{C as F,D as J,Ia as c,Pa as G,V as l,v as s}from"./chunk-CVJKAN5R.js";import{H as S,o as x}from"./chunk-GXQ645QR.js";import{a as b}from"./chunk-V4YVDLI4.js";import{f as _,m as R,o as w}from"./chunk-6V2G2Z5W.js";R();w();var d=_(b()),L=_(M());F();var P=_(J());j();G();var O=({address:r,targetCoinId:i,registerPath:a})=>{let u=(0,L.useHistory)(),g=C();return async({coinId:e})=>{let{coin:t,baseCoin:o}=await g(e,!0);if(![String(e),String(o.coinId)].includes(String(i)))return!0;try{let n=await N({chainId:t.chainId,address:r});if(n===h.NOT_STARTED){let f=x.warn({title:s("wallet_dialog_modal_not_registered"),text:s("wallet_dialog_modal_register_before_using"),confirmText:s("wallet_dialog_modal_registerbtn"),cancelText:s("wallet_dialog_modal_backbtn"),alignBottom:!1,onConfirm:()=>{f.destroy(),u.push(a)},onCancel:()=>{f.destroy()}});return!1}if(n===h.PROCESSING)return S.warn({title:s("wallet_extension_transaction_notif_address_registering",{net:t.chainName})}),!1}catch(n){let f=(n==null?void 0:n.error_message)||s("wallet_extension_transaction_notif_address_register_fail",{net:t.chainName});return S.error(f),!1}return!0}},$=()=>{let r=D(l);return O({address:r,targetCoinId:c,registerPath:I})},tt=r=>{let[i,a]=(0,d.useState)({isLoading:!0,isError:!1,nonce:"0",maxFee:"0"}),u=async()=>{var t;let e=await A({coinId:c,address:r},{fromAddr:r,toAddr:""});return(t=e==null?void 0:e.info)==null?void 0:t.nonce},g=async e=>{let t={type:"deploy_account",nonce:e,maxFee:"0"},o=await y().signTransaction(t,r,l);return o==null?void 0:o.signature},m=async e=>{let{data:t={}}=await E({coinId:c,address:r,inputData:e});return t==null?void 0:t.gasLimit};return(0,d.useEffect)(()=>{(async()=>{try{let t=await u();if((0,P.isNil)(t)){a(n=>({...n,isLoading:!1,isError:!0}));return}let o=await g(t),p=await m(o);a(n=>({...n,isLoading:!1,isError:!1,nonce:t,maxFee:p}))}catch{a(o=>({...o,isLoading:!1,isError:!0}))}})()},[]),i},et=({nonce:r,maxFee:i,address:a})=>{let u=k();return async()=>{let m={type:"deploy_account",nonce:r,maxFee:i},e=await y().signTransaction(m,a,l),t={type:"AccountActive",serviceChargeCoinId:c,nonce:r},o={signedTx:e==null?void 0:e.signature,fromAdr:a,serviceCharge:i,toAdr:a,coinAmount:"0",coinId:c,txHash:e==null?void 0:e.txId,txType:T.REGISTRATION,extJson:JSON.stringify(t)};return await u(o)}};export{$ as a,tt as b,et as c};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-JEPC4J2M.js.map
