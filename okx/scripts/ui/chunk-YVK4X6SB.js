import{a as eo}from"./chunk-OYUD7NPL.js";import{a as Te,c as ve,d as zt,f as Me,g as Rt,h as qe}from"./chunk-VEYNKMNX.js";import{a as jt}from"./chunk-5RXQBXEZ.js";import{a as qt}from"./chunk-CAHNM26J.js";import{a as Jt,b as Xt}from"./chunk-HX3FTBPA.js";import{a as $t}from"./chunk-NC54FPSJ.js";import{d as Vt}from"./chunk-IKPPHICM.js";import{a as Bt,b as ke,d as Gt}from"./chunk-HR4SA7Z5.js";import{d as Kt}from"./chunk-VNHZZRMI.js";import{b as Zt,c as Pt}from"./chunk-5TSD6WDE.js";import{a as Yt}from"./chunk-I2KPNTIF.js";import{b as Ot}from"./chunk-MEW6SUUR.js";import{a as Ht,b as Wt}from"./chunk-D6O2GLPR.js";import{c as oe}from"./chunk-2CPFAAZ7.js";import{a as Qt}from"./chunk-TYILG3ER.js";import{c as $,e as Nt}from"./chunk-E2KMZQ6K.js";import{a as Ut}from"./chunk-AHAXQBXQ.js";import{a as St}from"./chunk-PGPPXRV7.js";import{c as Lt}from"./chunk-MBJ4MFYL.js";import{b as Mt}from"./chunk-5DEIKYJL.js";import{a as Ct}from"./chunk-AXKCDQTS.js";import{a as Ie}from"./chunk-EXUJ54CX.js";import{a as Et,b as At}from"./chunk-D5VZXMFP.js";import{d as Ve,e as ye}from"./chunk-2HWABU7H.js";import{d as Ke}from"./chunk-DUHXKIBS.js";import{d as Dt}from"./chunk-GUWGENNL.js";import{a as kt,b as It}from"./chunk-67YO4IPY.js";import{w as we,x as xt}from"./chunk-R6GCLTW2.js";import{O as dt,b as ct}from"./chunk-UEO7AURD.js";import{a as Ft}from"./chunk-JSAFBAMQ.js";import{b as fe}from"./chunk-XEOGXIVD.js";import{a as Fe}from"./chunk-PCGRDRHF.js";import{n as yt,p as W}from"./chunk-IU3TYIWS.js";import{A as ht,B as wt,b as ee,o as te}from"./chunk-VPBQLZCI.js";import{g as bt}from"./chunk-FLCN6MAI.js";import{a as N}from"./chunk-YMZEQGAL.js";import{d as _t,h as Pe}from"./chunk-JIRWXBHS.js";import{P as Z,U as _e,X as gt,b as J,d as vt}from"./chunk-UXFKODVN.js";import{a as ft}from"./chunk-XKG5DY6K.js";import{i as Tt}from"./chunk-RMQJRDTF.js";import{c as A}from"./chunk-2YLR7R2N.js";import{a as ut,b as Do}from"./chunk-MVLY6WUP.js";import{c as it,h as Lo}from"./chunk-ZEAKIEIQ.js";import{C as ce,D as Ae,F as st,Ib as lt,Pa as No,Vb as pt,kc as mt,nc as So,q as H,u as He,v as y,vb as at,zb as de}from"./chunk-CVJKAN5R.js";import{B as Ze,H as rt,b as q,c as We,f as he,o as nt}from"./chunk-GXQ645QR.js";import{V as j}from"./chunk-C2H3SRET.js";import{a as U}from"./chunk-V4YVDLI4.js";import{f as L,m as c,o as d}from"./chunk-6V2G2Z5W.js";c();d();var io=L(U());c();d();c();d();var Ne=L(U());Lo();Do();var Oo=()=>{let[t,{setFalse:r}]=te(!0),[o,e]=(0,Ne.useState)([]),s=async()=>{try{let l=await it(ut.getMevList,{},{});return e(l.data),l.data}catch{return[]}finally{r()}};return(0,Ne.useEffect)(()=>{s()},[]),[t,o]},to=Oo;var ne=L(U()),Bo=t=>{let[r,o]=to(),[e,s]=(0,ne.useState)(""),[l,T]=(0,ne.useState)([]);(0,ne.useEffect)(()=>{let f=o.find(_=>window.localStorage.getItem("mevCheckedName")===_.name&&_.chainIds.includes(Number(t))),i=o.find(_=>_.chainIds.includes(Number(t))),a=o.filter(_=>_.chainIds.includes(Number(t)));T(a),s(f||i)},[o,t]);let p=(0,ne.useMemo)(()=>e&&o.length>0&&!r,[e,o,r]);return[e,l,p,s]},oo=Bo;c();d();var m=L(U());ce();c();d();var w={"mev-control-enter":"_mev-control-enter_1l6py_1",mevControlEnter:"_mev-control-enter_1l6py_1","mev-control-content":"_mev-control-content_1l6py_6",mevControlContent:"_mev-control-content_1l6py_6","mev-control-content-title":"_mev-control-content-title_1l6py_9",mevControlContentTitle:"_mev-control-content-title_1l6py_9","mev-control-content-desc":"_mev-control-content-desc_1l6py_14",mevControlContentDesc:"_mev-control-content-desc_1l6py_14","list-content":"_list-content_1l6py_18",listContent:"_list-content_1l6py_18","list-item":"_list-item_1l6py_21",listItem:"_list-item_1l6py_21","item-icon":"_item-icon_1l6py_24",itemIcon:"_item-icon_1l6py_24","list-item-text":"_list-item-text_1l6py_28",listItemText:"_list-item-text_1l6py_28","mev-control-title":"_mev-control-title_1l6py_32",mevControlTitle:"_mev-control-title_1l6py_32","mev-control-sub-title":"_mev-control-sub-title_1l6py_37",mevControlSubTitle:"_mev-control-sub-title_1l6py_37","mev-control-picture":"_mev-control-picture_1l6py_42",mevControlPicture:"_mev-control-picture_1l6py_42","mev-control-divider":"_mev-control-divider_1l6py_46",mevControlDivider:"_mev-control-divider_1l6py_46","mev-control-text-content":"_mev-control-text-content_1l6py_50",mevControlTextContent:"_mev-control-text-content_1l6py_50"};c();d();var P=L(U());var Go=({mevList:t,mevChecked:r,setMevChecked:o,...e})=>{var f;let s=(0,P.useRef)(null);if(!t.length)return null;let l=wt(s),T=i=>{o(i)},p=i=>P.default.createElement(kt,{icon:{size:fe.SIZE.lg,src:i.vendorIcon||_t,type:fe.TYPE.image},className:w["list-item"],onClick:()=>{T(i)},...e},P.default.createElement(A.FlexBox,{direction:A.DIRECTION.vertical},P.default.createElement(A.FlexBox,{align:A.ALIGN.center},P.default.createElement(W.Text,{className:w["list-item-text"]},i.name))),i.name===r.name&&P.default.createElement(A.FlexBox,{className:w["item-icon"],justify:"flex-end"},P.default.createElement(fe,{icon:"okds-success-circle-fill",size:fe.SIZE.sm})));return P.default.createElement("div",{ref:s,className:w["list-content"]},P.default.createElement(It,{itemKey:"id",height:(f=l==null?void 0:l.height)!=null?f:408,searchable:!1,dataSource:t,renderItem:p}))},no=Go;var ro="mevOperated",Yo=2e3,Uo=({isMev:t,isShowBlockSwapMevTooltip:r,onMevChange:o,mevChecked:e,mevList:s,setMevChecked:l})=>{let[T,{setFalse:p,setTrue:f}]=te(!1),[i,{toggle:a}]=te(!1),_=ft(),[v,x]=(0,m.useState)(""),[u]=(0,m.useState)(t);(0,m.useEffect)(()=>{let I=!t&&r,C=!t&&He.get(ro)===void 0,E=()=>{p()},X=()=>{He.set(ro,1)};return I?(x("wallet_extension_trade_tooltip_enable_mev"),f(),document.addEventListener("click",E,!1)):C&&(x("wallet_extension_mev_pop_turnon_mev"),f(),document.addEventListener("click",E,!1),document.addEventListener("click",X,!1)),()=>{document.removeEventListener("click",E,!1),document.removeEventListener("click",X,!1)}},[]);let h=()=>{window.localStorage.setItem("mevCheckedName",e.name)};(0,m.useEffect)(()=>{u&&e&&(h(),o(u,e))},[u,e]);let O=ee(I=>{I.stopPropagation(),typeof o=="function"&&(h(),o(!t,e)),dt({mev:!t}),x(t?"wallet_extension_mev_pop_mev_off":"wallet_extension_mev_pop_mev_on"),a(),f(),setTimeout(()=>{p()},Yo)}),F=bt({dark:"/cdn/assets/imgs/245/127CAD27DF691613.png",light:"/cdn/assets/imgs/2311/700F36AE20EC394E.png"});return e?m.default.createElement(m.default.Fragment,null,m.default.createElement(Ze,{show:T,title:y(v),placement:Ze.DIRECTION.bottomRight},m.default.createElement(We,{onClick:a,className:w["mev-control-enter"],src:`${_}${t?"/cdn/assets/imgs/2311/18FBF293424BC832.png":"/cdn/assets/imgs/2311/06B1F3EF7FDBD381.png"}`})),m.default.createElement(nt,{visible:i,onClose:a,onCancel:a,alignBottom:!0,isFull:!1,noContentPadding:!0,noMargin:!0},m.default.createElement(A.Box,{className:w["mev-control-content"]},m.default.createElement(A.FlexBox,{justify:"space-between",align:A.ALIGN.center},m.default.createElement(A.Space,{direction:A.DIRECTION.vertical,space:12},m.default.createElement(W.Text,{className:w["mev-control-title"]},y("wallet_extension_mev_grouptitle_mev_protection")),m.default.createElement(W.Text,{style:{color:t?"var(--okd-color-semantic-positive)":"var(--okd-color-content-primary)"},className:w["mev-control-sub-title"]},y(t?"wallet_extension_mev_label_enabled":"wallet_extension_mev_label_disabled"))),m.default.createElement(We,{className:w["mev-control-picture"],src:F})),m.default.createElement(yt,{className:w["mev-control-divider"]}),m.default.createElement(A.Space,{className:w["mev-control-text-content"],direction:A.DIRECTION.vertical,space:24},m.default.createElement(A.Box,null,m.default.createElement(W.Text,{className:w["mev-control-content-title"]},y("wallet_extension_mev_title_mev_attack")),m.default.createElement(W.Text,{className:w["mev-control-content-desc"]},y("wallet_extension_mev_subtitle_mev_attack"))),m.default.createElement(A.Box,null,m.default.createElement(W.Text,{className:w["mev-control-content-title"]},y("wallet_extension_mev_title_prevent_attacks")),m.default.createElement(W.Text,{className:w["mev-control-content-desc"]},y("wallet_extension_mev_subtitle_prevent_attacks"))),m.default.createElement(A.Box,null,m.default.createElement(W.Text,{className:w["mev-control-content-desc"]},y("wallet_extension_mev_subtitle_mev_reset"))),m.default.createElement(A.Box,null,m.default.createElement(W.Text,{className:w["mev-control-content-title"]},y("wallet_extension_mev_title_provider")),m.default.createElement(no,{mevList:s,mevChecked:e,setMevChecked:l})))),m.default.createElement(Fe.FooterActions,{affixStyle:{position:"absolute",bottom:0,left:0}},m.default.createElement(j,{onClick:O,category:t?j.CATEGORY.outline:j.CATEGORY.fill,type:t?j.TYPE.primary:j.TYPE.highlight,size:j.SIZE.lg},y(t?"wallet_extension_mev_btn_disable_mev":"wallet_extension_mev_btn_activate_protection"))))):null},so=Uo;var Ho=({isMev:t,chainId:r,isShowBlockSwapMevTooltip:o,onMevChange:e})=>{let[s,l,T,p]=oo(r);return T&&io.default.createElement(so,{isMev:t,isShowBlockSwapMevTooltip:o,onMevChange:e,mevChecked:s,mevList:l,setMevChecked:p})},ao=Ho;c();d();var g=L(U());c();d();var lo=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];ce();var Je=L(Ae());c();d();var Wo=t=>{let r="wallet_extension_popup_title_contract_interaction";return{[we.DEPLOY_CONTRACT]:"wallet_transfer_dapp_conncetion_subtitle_contracrt_deployment",[J.NFT_AUTHORIZATION]:"wallet_extension_title_approve",[J.NFT_CANCEL_AUTHORIZATION]:"wallet_extension_title_revoke_approve",[J.AUTHORIZATION]:"wallet_extension_title_approve",[J.CANCEL_AUTHORIZATION]:"wallet_extension_title_revoke_approve",[J.INCREASE_ALLOWANCE]:"wallet_extension_approve_text_increase_approval_amount",[J.DECREASE_ALLOWANCE]:"wallet_extension_approve_text_reduce_approval_amount"}[t]||r},po=Wo;c();d();pt();var Zo=t=>{let{txParams:r={},type:o}=t,{gasPrice:e,maxFeePerGas:s,maxPriorityFeePerGas:l}=r,T=r.gas||r.gasLimit,p=Z.STANDARD,f,i,a,_=N(T),v=N(e),x=N(s),u=N(l);return de(v,0)&&(p=Z.CUSTOM,f=v),de(x,0)&&de(u,0)&&de(x,u)&&(p=Z.CUSTOM,i=x,a=u),o===we.DEPLOY_CONTRACT&&(p=Z.CUSTOM),{initialGasType:p,initialCustomMaxPriorityFee:a,initialCustomGasLimit:_,initialCustomGasPrice:f,initialCustomMaxBaseFee:at(i,a)}},mo=Zo;c();d();var Le=L(U());ce();var Po=t=>{let[r,o]=(0,Le.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:Z.STANDARD}),{gasLimitInfo:e={},gasLimit:s,gasPrice:l,maxFeePerGas:T,gasType:p,supportEip1559:f,customConfirmed:i,isGasLimitLoading:a,isNetworkFeeLoading:_,networkFee:v,maxPriorityFeePerGas:x,gasPriceInfo:u,extFee:h}=r,{minGasFee:O}=Bt({gasLimit:s,gasPrice:l,maxPriorityFeePerGas:x,maxFeePerGas:T,supportEip1559:f,extFee:h,gasPriceInfo:u,gasLimitInfo:e,gasType:p}),F=(0,Le.useMemo)(()=>p===Z.CUSTOM&&!i?y("extension_send_mid_text_dapps_suggested_fee"):p||Z.STANDARD,[i,p]),I=ke(r,t),C=_&&a&&!(e!=null&&e.gasLimit);return{level:F,estimateFailed:I,customGasInfo:r,loading:_,networkFee:C?void 0:O,maxNetworkFee:C?void 0:v,onCustomGasInfoChange:o}},uo=Po;c();d();var Se=L(U()),De=L(Ae());No();var Ko=({txId:t,coinId:r,txType:o,txParams:e,isMev:s,mevInfo:l,localType:T,analyzeRet:p,preExecuteError:f,verifyGasLimitRet:i,modifiedData:a,walletAccount:_,customGasInfo:v,isSufficientGas:x,isSufficientBalance:u,gasReturnActivity:h,modifiedDataError:O,baseCoinBalanceInt:F,reportGasReturnActivityDataInConfirm:I,onCancel:C,onConfirm:E,onConfirmReplace:X})=>{let{blackAddress:B={}}=p||{},{walletId:re,address:Q}=_||{},z=Pt(),{isPreExecuteNonGasError:le}=i||{},k=qt(),{networkFee:G,gasType:b,gasPrice:se}=v||{},Be=Vt({coinId:r,walletId:re,localType:T,fromAddr:e==null?void 0:e.from}),Ge=Kt({coinId:r,toAddr:e==null?void 0:e.to,fromAddr:e==null?void 0:e.from,txSource:Tt.DAPP,coinAmount:(Ie(e==null?void 0:e.value)?N(e==null?void 0:e.value):e==null?void 0:e.value)||0,serviceCharge:G,inputData:a,mev:s?l==null?void 0:l.name:"",activityId:h==null?void 0:h.activityId}),Y=(0,Se.useMemo)(()=>(v==null?void 0:v.isNetworkFeeLoading)||ke(v,o)||le||!!f||(0,De.isNil)(F)||O,[f,v,o,le,F,O]),R=ee(async()=>{if(X&&typeof E=="function")return E({isMev:s,coinId:r,mevInfo:l,txParams:e,customGasInfo:v,modifiedData:a,gasReturnActivity:h,reportGasReturnActivityDataInConfirm:I});let{nonce:M,updateGasInfo:K}=await k({to:e==null?void 0:e.to,from:e==null?void 0:e.from,coinId:r,gasPrice:se,userGasInfo:v,amount:N(e==null?void 0:e.value)||0,baseCoinAmountUse:N((e==null?void 0:e.value)||0)});I();let n={...e,...v,...K||{},nonce:M,data:a};try{let D=await Be(n),ge=await St(st,D);return await Ge(D,{txHash:ge,extJson:JSON.stringify({to:n==null?void 0:n.to,gasType:b,from:n==null?void 0:n.from,value:Ie(n==null?void 0:n.value)?N(n==null?void 0:n.value):n==null?void 0:n.value,nonce:Ie(n==null?void 0:n.nonce)?N(n==null?void 0:n.nonce):n==null?void 0:n.nonce,data:n==null?void 0:n.data,gas:n==null?void 0:n.gasLimit,oldTxHash:"",gasPrice:n!=null&&n.supportEip1559?n==null?void 0:n.maxFeePerGas:n==null?void 0:n.gasPrice,repeatTxType:vt.CONFIRMING,priorityFee:n!=null&&n.supportEip1559?n.maxPriorityFeePerGas:0})}),E==null?void 0:E({txHash:ge})}catch(D){return E==null?void 0:E({error:D})}}),pe=(0,Se.useMemo)(()=>!u||!x?{txId:t,coinId:r,address:Q,walletId:re,receiveOnly:x,actionType:oe.ACTION_TYPE.FILL_UP}:!(0,De.isEmpty)(B)&&!Y?{type:j.TYPE.red,actionType:oe.ACTION_TYPE.CONFIRM,onClick:async()=>{try{await z({isDefraud:!0,address:B.address,similarType:gt.EXACT,msg:B.msg}),await R()}catch{await(C==null?void 0:C())}}}:{disabled:Y,actionType:oe.ACTION_TYPE.CONFIRM,onClick:R},[Q,B,z,r,Y,R,u,x,C,t,re]);return(0,Se.useMemo)(()=>[{onClick:C,actionType:oe.ACTION_TYPE.CANCEL},pe],[pe,C])},co=Ko;c();d();var V=L(U());ce();var fo=L(Ae());var Vo=3,_o=({address:t,coins:r,baseCoinId:o})=>{if(Array.isArray(r))return r.find(e=>(e==null?void 0:e.baseCoinId)===o&&Ct(e==null?void 0:e.address,t,{baseCoinId:o})||_o({address:t,baseCoinId:o,coins:e==null?void 0:e.childrenCoin}))},qo=({to:t,chainInfo:r,baseCoinId:o})=>{let e=Qt(),s=(0,V.useCallback)(async(l=0)=>{if(!_o({address:t,coins:e,baseCoinId:o}))try{let p=await Et({contractAddress:t,chainInfo:r});await At(p)}catch(p){++l<Vo?s(l):rt.error({title:(p==null?void 0:p.msg)||y("wallet_home_toast_network_error")})}},[o,r,e,t]);return s},jo=({txType:t,walletId:r,txParams:o,analyzeRet:e,coinId:s})=>{var h,O;let[l,T]=(0,V.useState)({}),[p,f]=(0,V.useState)("0"),i=$(s),{to:a}=o||{},_=Mt({},r),v=(0,V.useMemo)(()=>_==null?void 0:_.find(F=>F.localType===(i==null?void 0:i.localType)),[i==null?void 0:i.localType,_==null?void 0:_.length]),x=qo({to:a,chainInfo:v,baseCoinId:s}),u=(0,fo.get)(e,"approveList.0",{});return(0,V.useEffect)(()=>{var F;if(((F=u==null?void 0:u.asset)==null?void 0:F.address)&&Te(t)){x();let{approvalRaw:I}=u,{decimals:C=0}=u.asset;f(H.div(N(I),H.pow(10,C)))}},[(h=u==null?void 0:u.asset)==null?void 0:h.address,t]),(0,V.useEffect)(()=>{var F;if(((F=u==null?void 0:u.asset)==null?void 0:F.address)&&Te(t)){x();let{decimals:I=0,symbol:C,imageUrl:E}=u.asset;T({symbol:C,decimals:I,address:a,image:E,chainId:i==null?void 0:i.chainId})}},[(O=u==null?void 0:u.asset)==null?void 0:O.address,t]),[{...l,authAmount:p},f]},yo=jo;c();d();var ie=L(U());So();pt();var Jo=({txType:t,walletId:r,coinId:o,txParams:e,customGasInfo:s,preExecuteLoading:l})=>{let[T,p]=(0,ie.useState)(""),f=$(o),{from:i,to:a}=e||{},[_,v]=(0,ie.useState)("");(0,ie.useEffect)(()=>{l||(ve(t)||Me(t)?(p(Ke.approval),v(ve(t)?"approve":"revoke_approve")):(p(Ke.dapp),v("Contract interaction")))},[l,t]);let x=Ot({walletId:r,coinId:o,fromAddress:i,toAddress:a,txType:T,fee:lt(s==null?void 0:s.networkFee),disabled:!a,unavailable:s.gasType===Z.CUSTOM&&s.customConfirmed}),{status:u,activity:h,activityId:O,tip:F,clear:I}=x,C=()=>{mt({activityId:O,activity:h,status:u,tip:F,walletId:r,address:i})},E=h==null?void 0:h.errorCode;return(0,ie.useEffect)(()=>{!_||E===0&&ct({wallet_address:i,interactive_address:a,chain_id:f==null?void 0:f.chainId,transaction_type:_})},[E,_,i,a,f==null?void 0:f.chainId]),{gasReturnActivity:x,clearGasReturnInfo:I,reportGasReturnActivityDataInConfirm:C}},To=Jo;c();d();var ae=L(U());ce();var Oe=L(Ae());var $o=(t,r)=>(t==null?void 0:t.isPreExecuteNonGasError)||r?{type:q.TYPE.error,message:(t==null?void 0:t.msg)||y("wallet_extension_toast_text_unknown_error")}:null,Xo=(t,r)=>{var T;let o=((T=t==null?void 0:t.approveList)==null?void 0:T[0])||{},e=(o==null?void 0:o.asset)||{},s=qe((o==null?void 0:o.name)||Pe),l=qe((e==null?void 0:e.symbol)||(e==null?void 0:e.name)||Pe);return ve(r)||zt(r)?Te(r)&&Dt(H.div(o==null?void 0:o.approvalRaw,H.pow(10,(e==null?void 0:e.decimals)||0)))?{type:q.TYPE.warn,message:y("wallet_extension_popup_unlimited_transfer",{contract:s,asset:l})}:{type:q.TYPE.warn,message:y("extension_approve_alert_authorized_tips",{contract:s,asset:l})}:Me(r)?{type:q.TYPE.info,message:y("extension_revoke_approval_alert_evoke_authorization",{contract:s,asset:l})}:null},Qo=({coinId:t,txType:r,analyzeRet:o,estimateFailed:e,preExecuteError:s,isDappCustomIllegal:l,isSufficientBalance:T,isSufficientGas:p,verifyGasLimitRet:f})=>{let i=Ut(),a=$(t);return(0,ae.useMemo)(()=>{if((0,Oe.isNil)(a==null?void 0:a.coinId))return null;let _=$o(f,s);if(_)return _;if(!p)return{type:q.TYPE.warn,message:y("wallet_extension_popup_insufficient_for_net",{Symbol:a==null?void 0:a.symbol})};if(!T)return{type:q.TYPE.warn,message:y("wallet_extension_popup_dapp_insufficient_balance")};if(e)return{type:Ht.FEE_ERROR};if(!(0,Oe.isEmpty)(o==null?void 0:o.blackAddress))return{type:q.TYPE.error,message:ae.default.createElement(ae.default.Fragment,null,o.blackAddress.msg,ae.default.createElement(he,{underline:!0,type:he.TYPE.secondary,size:he.SIZE.sm,onClick:()=>{globalThis.platform.openTab({url:i==null?void 0:i.scamsUrl})}},y("wallet_extension_scam_toast_link_view_scams")))};let v=Xo(o,r);return v||(l?{type:q.TYPE.normal,message:y("wallet_extension_popup_text_dapp_fee_low")}:null)},[a==null?void 0:a.coinId,a==null?void 0:a.symbol,f,s,p,T,e,o,r,l,i==null?void 0:i.scamsUrl])},vo=Qo;c();d();var je={"data-input":"_data-input_1k4cq_1",dataInput:"_data-input_1k4cq_1","data-input-error-tip":"_data-input-error-tip_1k4cq_5",dataInputErrorTip:"_data-input-error-tip_1k4cq_5"};var zo=t=>Number(t)===J.INCREASE_ALLOWANCE?lo:[],Ro=t=>{var tt;let{txId:r,chainId:o,walletId:e,txParams:s,dappInfo:l={},needMev:T=!1,openMev:p=!1,coinId:f,txType:i,onMevChange:a,onConfirm:_,onConfirmReplace:v,onCancel:x}=t||{},{host:u}=l,[h,O]=(0,g.useState)(!1),[F,I]=ht({mevInfo:{},isMev:p}),[C,{toggle:E}]=te(!1),{from:X,to:B,value:re="0x0",data:Q}=s||{},[z,le]=(0,g.useState)(""),k=$(f,void 0,{chainId:o}),G=k==null?void 0:k.coinId,b=Lt(k==null?void 0:k.localType,e),se=N(re),Be={to:B,from:X,coinId:G,chainId:k==null?void 0:k.chainId,amount:se,checkTypes:[_e.KYS,_e.VERIFY_GAS_LIMIT],domain:u,tokenAddress:B,inputData:Q||"0x"},[Ge,Y,R]=Zt(Be,{ready:!!B}),pe=Ge||!Y&&!R&&!!B,M=(Y==null?void 0:Y[_e.KYS])||{},K=(Y==null?void 0:Y[_e.VERIFY_GAS_LIMIT])||{},n=(tt=Nt(G,b==null?void 0:b.walletId))==null?void 0:tt.coinAmountInt,D=(0,g.useMemo)(()=>M!=null&&M.txType?M==null?void 0:M.txType:i,[M==null?void 0:M.txType,i]),ge=mo({txParams:s,type:D}),go=po(D),Ye=$t(b.walletId),xe=(0,g.useMemo)(()=>Xt(z),[z]),{isMev:be,mevInfo:Ue}=F,$e=z||Q||"",xo=ee((ue,Ee)=>{I({isMev:ue,mevInfo:Ee}),a==null||a(ue,Ee)}),{level:bo,networkFee:Co,maxNetworkFee:me,customGasInfo:Xe,estimateFailed:Qe,loading:Eo,onCustomGasInfoChange:Ao}=uo(D),{gasReturnActivity:ze,reportGasReturnActivityDataInConfirm:ho}=To({txType:D,coinId:G,txParams:s,customGasInfo:Xe,preExecuteLoading:pe,walletId:b.walletId}),Re=(0,g.useMemo)(()=>(0,Je.isNil)(n)||H.gte(n,me)&&!(K!=null&&K.isPreExecuteGasError),[n,me,K==null?void 0:K.isPreExecuteGasError]),et=(0,g.useMemo)(()=>!H.eq(se,0)&&!(0,Je.isNil)(n)?H.lte(se,H.sub(n,me)):!0,[n,me,se]),wo=vo({txType:D,coinId:G,analyzeRet:M,preExecuteError:R,estimateFailed:Qe,isSufficientGas:Re,verifyGasLimitRet:K,isDappCustomIllegal:h,isSufficientBalance:et}),Fo=co({txId:r,coinId:G,txType:D,txParams:s,isMev:be,mevInfo:Ue,analyzeRet:M,verifyGasLimitRet:K,walletAccount:b,customGasInfo:Xe,isSufficientGas:Re,isSufficientBalance:et,gasReturnActivity:ze,modifiedDataError:xe,preExecuteError:R,localType:k==null?void 0:k.localType,modifiedData:$e,walletId:b==null?void 0:b.walletId,baseCoinBalanceInt:n,reportGasReturnActivityDataInConfirm:ho,onCancel:x,onConfirm:_,onConfirmReplace:v}),[Ce,ko]=yo({coinId:G,txType:D,txParams:s,analyzeRet:M,walletId:b==null?void 0:b.walletId}),Io=ee(ue=>{let Ee=zo(D),ot=xt(s==null?void 0:s.data,Ee);if(ot){let Mo=Rt(s==null?void 0:s.data,{customPermissionAmount:ue,decimals:Ce==null?void 0:Ce.decimals},ot);ko(ue),le(Mo)}});return g.default.createElement(A.Container,null,g.default.createElement(Ft,{closeable:!1,backable:!1,title:y(go)},!!T&&g.default.createElement(ao,{isMev:be,chainId:k==null?void 0:k.chainId,onMevChange:xo})),g.default.createElement(eo,{coinId:G,txType:D,dappInfo:l,loading:pe,analyzeRet:M,approveToken:Ce,walletId:b==null?void 0:b.walletId,onAuthTokenAmountChange:Io}),g.default.createElement(ye,null,g.default.createElement(Yt,{level:bo,coinId:G,networkFee:Co,loading:Eo,maxNetworkFee:me,estimateFailed:Qe,onClick:()=>{E(),Ye({trade:"contract_interaction",all_confirmation:"network_fee"})}})),g.default.createElement(ye,null,g.default.createElement(Ve,{address:b.address,walletId:b==null?void 0:b.walletId,title:y("wallet_extension_network_address_title_walletused"),onCopyCallback:()=>{Ye({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}}),!!B&&g.default.createElement(Ve,{title:y("wallet_extension_popup_text_interact_with"),address:B,onCopyCallback:()=>{Ye({trade:"contract_interaction",all_confirmation:"contract_address"})}})),Q?g.default.createElement(ye,{bordered:!1},g.default.createElement(jt,{data:Q,copyable:{hideDesc:!0},tooltipZIndex:101})):g.default.createElement(ye,{bordered:!1},g.default.createElement(Jt,{value:z,error:xe,onChange:le,className:je["data-input"],errorTipClass:je["data-input-error-tip"]})),g.default.createElement(Fe,{placeholder:!0,offsetBottom:0,style:{zIndex:205},borderTop:!0},!xe&&g.default.createElement(Wt,{...wo}),g.default.createElement(oe,{buttonGroup:Fo})),g.default.createElement(Gt,{visible:C,coinId:G,address:X,inputData:$e,tokenAddress:B,value:N(re),onBack:E,onClose:null,initialGasData:ge,onGasChange:Ao,minimumGasLimit:be?Ue.gas:0,isMev:be,mevInfo:Ue,gasReturn:ze,onDappGasIllegal:O,gasLimitOptions:{disabled:xe}}))},Qs=Ro;export{ao as a,Qs as b};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-YVK4X6SB.js.map
