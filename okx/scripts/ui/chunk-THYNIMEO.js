import{i as N,p as ge,r as Ie}from"./chunk-DYEVUST3.js";import{$a as L,K,R as $t,X as pe,ab as nt,bb as at,cb as mt,db as dt,ea as Et,g as ee,i as Q,k as _t,ma as F,na as k,oa as fe,r as Ht,ra as Yt,sa as Se,x as Wt}from"./chunk-LFVM5TW4.js";import{$a as ne,$b as ce,Ac as st,Bc as vt,Cb as A,Cc as P,Db as Nt,Dc as D,Eb as xt,Fb as Gt,Hb as ae,Ib as me,Jb as de,Kb as Ut,L as ie,Lb as ue,Pa as Rt,Qa as Dt,Ra as Bt,Z as oe,_b as Mt,da as re,ga as se,ia as j,ib as yt,ja as Z,ka as v,la as b,oa as Ft,ra as B,uc as le,wb as Ct,xc as he,yc as Te,zb as p}from"./chunk-IQVVVGEA.js";import{G as rt}from"./chunk-GXQ645QR.js";import{a as xe}from"./chunk-V4YVDLI4.js";import{f as Ne,h as s,m as C,o as E}from"./chunk-6V2G2Z5W.js";C();E();C();E();var ei={Failed:"-1",Waiting:"1",Pending:"2",Succeed:"3"},ut={ESTIMATE:1,EXCEED_ESTIMATE:2,UNTIMED:3,TIMEOUT:4},ii={FromIsBtcChain:1,FromIsNotBtcChain:2,FromIsEthChainFacetCoin:3},G={SINGLE_TIPS:1,GAS:2,BRIDGE:3},tt={SINGLE:1,CROSS_FROM_SWAP:2,CROSS_BRIDGE_SWAP:3,CROSS_TO_SWAP:4};C();E();var wt={SUCCESS:"success",FAIL:"fail",REJECT:"reject",TXHASH:"txhash",APPROVE:"approve",CONNECT:"connect",APP_STATUS:"appStatus",CLOSE:"close"},Ge=Object.values(wt),Vt=class{constructor(){s(this,"toast",!0);s(this,"setToast",t=>{this.toast=t});s(this,"chainList",[]);s(this,"setChainList",t=>{this.chainList=t});s(this,"quote",{});s(this,"updateQuote",t=>{this.quote={...this.quote,...t}});s(this,"portal","");s(this,"setPortal",t=>{this.portal=t||""});s(this,"swapParams",{});s(this,"setSwapParams",({fromAmount:t,...e})=>{this.swapParams={...e,fromAmount:Et(t)?t:"1"}});s(this,"status","");s(this,"reset",()=>{this.to={},this.from={},this.events={},this.swapParams={}});s(this,"on",(t,e)=>{if(!Ge.includes(t))return new Error("Not support event!!");if(typeof e!="function")return{};this.events[t]||(this.events[t]=[]);let i=`${t}${this.events[t].length}`;return this.events[t].push({cb:e,eventId:i}),{eventId:i,remove:()=>{this.remove(t,i)}}});s(this,"emit",(t,...e)=>{let i=this.events[t];i&&i.length&&i.forEach(o=>{let{cb:r}=o;r&&r.apply(this,e)})});s(this,"remove",(t,e)=>{let i=this.events[t];i&&e&&i.forEach((o,r)=>{o.eventId===e&&i.splice(r,1)})});s(this,"removeAll",()=>{this.events={}});this.events={}}static init(t){return this.instance||(this.instance=new Vt(t)),this.instance}},At=Vt;s(At,"instance",null);var Ue=new At,qt=Ue;C();E();var ct=Ne(xe());function bt({type:T,title:t,exploreUrl:e,onURLClick:i,showClose:o}){let r=e?ct.default.createElement(Ie,{className:"color-959dad",href:e,onClick:i},ct.default.createElement("div",{className:"inline-flex align-items-center"},ct.default.createElement("div",{className:"font-12 color-0569ff font-bold"},b("swaptrade_toast_anchor_view_in_explorer")),ct.default.createElement(ge,{className:"okx-defi-dex-link color-0569ff",size:20}))):void 0,n=5;T==="success"?rt.success({title:t,desc:r,duration:n}):T==="failed"?rt.error({title:t,desc:r,duration:n}):T==="info"?rt.info({title:t,desc:r,duration:n,showClose:o}):T==="expired"&&rt.info({title:t,desc:r,duration:n,icon:"okds-clock"})}function lt({title:T,exploreUrl:t,onURLClick:e=()=>{}}){bt({type:"success",title:T,exploreUrl:t,onURLClick:e})}function Lt({title:T,exploreUrl:t,onURLClick:e=()=>{}}){bt({type:"failed",title:T,exploreUrl:t,onURLClick:e})}function zt({title:T,exploreUrl:t,onURLClick:e=()=>{},showClose:i=!0}){bt({type:"info",title:T,exploreUrl:t,onURLClick:e,showClose:i})}function _e({title:T,exploreUrl:t,onURLClick:e=()=>{}}){bt({type:"expired",title:T,exploreUrl:t,onURLClick:e})}C();E();var et=class{constructor(t){s(this,"orderId","--");s(this,"chainId","--");s(this,"defiPlatformInfo","--");s(this,"fromAmount","--");s(this,"fromTokenSymbol","--");s(this,"price","--");s(this,"status","--");s(this,"time","--");s(this,"toAmount","--");s(this,"toTokenSymbol","--");s(this,"userWalletAddress","--");s(this,"exploreUrl","--");s(this,"isExchanged",!1);s(this,"swapType","--");s(this,"toChainId","--");_t(this),Object.assign(this,t)}get computedFromAmount(){return`${D(this.fromAmount,{needPlaceholder:!0,needBillionMillionUnit:!0})}`}get computedToAmount(){return P(this.toAmount)}get computedToNetWorkPath(){let{fromChainName:t,toChainName:e}=this;return t===e?e:`${t} ${b("swaptrade_order_info_label_network_to")} ${e}`}updateFromJson(t){Object.assign(this,t)}toJSON(){return Q(this)}};var{BigNumber:jt}=Z,ye=20,W=[],d={Pending:"0",Failed:"-1",Succeed:"1",Waiting:"100",SpeedingUp:"-4",Canceling:"-3",Canceled:"-2",PendingWithdrawn:"10",PendingCanRedeem:"11",PendingRedeeming:"12"},{Pending:ve,SpeedingUp:He,Canceling:We,PendingWithdrawn:$e,PendingCanRedeem:Ye,PendingRedeeming:qe}=d,Ve=[ve,He,We,$e,Ye,qe],c={SingleChain:"1",CrossBridge:"2",CrossChain:"3",FromBridge:"3-1",BridgeTo:"3-2",FromBridgeTo:"3-3",GasStation:"4",GasStationCross:"5",LimitOrder:"6"};var U={from:1,bridge:2,fromSwapTimeout:3},ze={FAIL:"-1",NO_SELECTED:"0",WAITING_FOR_FINAL:"1",WAITING_FOR_TRANSFER:"2",TRANSFER_SUCCEED:"3"},{NO_SELECTED:je,TRANSFER_SUCCEED:Ke}=ze,Xe=10,Ce={curPageNum:1,pageSize:Xe,total:0},Je={[c.SingleChain]:"swaptrade_order_swap_trade_type_swap",[c.CrossBridge]:"swaptrade_order_swap_trade_type_bridge",[c.CrossChain]:"swaptrade_order_swap_trade_type_cross_chain",[c.GasStation]:"swaptrade_dialog_tab_gasstation",[c.GasStationCross]:"swaptrade_dialog_tab_gasstation",[c.LimitOrder]:"swaptrade_dialog_tab_gasstation"};function $({childOrderId:T,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:o,fromTokenIcon:r,fromChainLogoUrl:n,fromAmountIn:a,fromTokenSymbol:m,fromChainName:u,toTokenIcon:g,toChainLogoUrl:h,toAmountOut:I,toTokenSymbol:l,toChainName:_,originalTokenSymbol:S,refundAmount:f,refundSymbol:R,refundChain:O,errorCode:y},w,M={}){let x=w==="from",q=x?a:I,ot=f?P(f):"",X=x?D(a):P(I,{needBillionMillionUnit:!1});return M!=null&&M.useCurrencyInputFormat&&(X=D(q)),{key:`${T}${w}`,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:o,originalTokenSymbol:S,fromChainName:u,fromTokenSymbol:m,toChainName:_,chainName:x?u:_,chainLogo:x?n:h,symbol:x?m:l,symbolLogo:x?r:g,amount:q==="-1"?"":X,errorCode:y,refund:{amount:ot,symbol:R,chain:O},...M}}var Kt=class{constructor(t){s(this,"detail",{data:null,loading:!1,error:!1});s(this,"history",{list:[],loading:!1,loadMore:!1,hasMore:!1,error:null,pageInfo:{...Ce},chainId:-1});s(this,"limitHistory",{...this.history});s(this,"limitDetail",{...this.detail});s(this,"pendingOrders",[]);s(this,"modal",{orderId:"",visible:!1});s(this,"expireTime",0);s(this,"fromStepCountDownTimeGroup",{estimatedTime:0,estimatedTimeTotal:0});s(this,"bridgeStepCountDownTimeGroup",{estimatedTime:0,originEstimatedTime:0});s(this,"timeoutTimestamp",0);s(this,"timer",null);s(this,"timeOutTimer",null);s(this,"detailShowSource","");s(this,"showModal",t=>{var i,o;let e=typeof t=="string"?t:"";this.modal={visible:!0,orderId:e,defaultOrderId:e},this.setHistoryTab(((i=this.commonStore)==null?void 0:i.currentTab)===p.BRIDGE?p.SWAP:(o=this.commonStore)==null?void 0:o.currentTab)});s(this,"updateModal",t=>{this.modal.orderId=typeof t=="string"?t:""});s(this,"closeModal",()=>{this.modal.visible=!1,this.setDetailShowSource()});s(this,"setDetailShowSource",(t="")=>{this.detailShowSource=t});s(this,"setDetail",t=>{this.detail={...this.detail,...t}});s(this,"setLimitDetail",t=>{this.limitDetail={...this.limitDetail,...t}});s(this,"getStepCountDownTimeGroup",({estimatedTime:t,originEstimatedTime:e,expireTime:i,extraEstimatedTime:o,extraOriginEstimatedTime:r})=>{let n=Math.min(t,i),a=e||t;return this.computedMainOrderType===c.BridgeTo&&(n=t+Math.min(o,i),a+=r),{estimatedTime:n,estimatedTimeTotal:a}});s(this,"setSwapExpireTime",t=>{let e=!this.computedCurrentHistoryTabIsLimit&&Number(t.estimatedTime),i=Number(t.fromEstimatedTime)||0,o=Number(t.bridgeEstimatedTime)||0,r=Number(t.originFromEstimatedTime)||0,n=Number(t.originBridgeEstimatedTime)||0;this.fromStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:i,originEstimatedTime:r}),this.bridgeStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:o,originEstimatedTime:n,extraEstimatedTime:i,extraOriginEstimatedTime:r}),this.expireTime=e,this.expireTime>0&&(this.timer=setInterval(()=>{var h,I;let a=this.computedStepStatus.bridgeStatus,m=this.computedStepStatus.fromSwapStatus,u=((I=(h=this.detail)==null?void 0:h.data)==null?void 0:I.status)===d.Canceling,g=l=>l===d.SpeedingUp||l===d.Pending;this.expireTime<1?(clearInterval(this.timer),this.bridgeStepCountDownTimeGroup.estimatedTime=0,this.fromStepCountDownTimeGroup.estimatedTime=0):(this.expireTime-=1,this.fromStepCountDownTimeGroup.estimatedTime>0&&g(m)&&!u&&(this.fromStepCountDownTimeGroup.estimatedTime-=1),this.bridgeStepCountDownTimeGroup.estimatedTime>0&&g(a)&&!u&&(this.bridgeStepCountDownTimeGroup.estimatedTime-=1))},1e3))});s(this,"setSwapTimeout",t=>{this.timeOutTimer&&clearInterval(this.timeOutTimer),this.timeoutTimestamp=Date.now()>t?0:t||0,this.timeoutTimestamp>0&&(this.timeOutTimer=setInterval(()=>{Date.now()>this.timeoutTimestamp&&(this.timeoutTimestamp=0,clearInterval(this.timeOutTimer))},1e3))});s(this,"removePendingOrder",t=>{let e=this.pendingOrders,i=e.findIndex(({orderId:r})=>r===t);i>-1&&e.splice(i,1),this.setPendingOrders([...e])});s(this,"updateDetailByData",t=>{let e=this.detail.data,i=o=>o&&{...o,fromAmountIn:o==null?void 0:o.fromAmount,toAmountOut:o==null?void 0:o.toAmount};if(e&&t&&t.orderId===e.orderId){let{fromChildOrder:o,bridgeChildOrder:r,toChildOrder:n}=t;this.setDetail({data:$t(e,{...t,fromChildOrderDetailVo:i(o),bridgeChildOrderDetailVo:i(r),toChildOrderDetailVo:i(n)})})}});s(this,"fetchHistory",ee(function*(e={},i=!1){let o=this.accountStore.computedAccountWalletAddressesArray;if(this.computedIsLimitOrSwapLabel.chainId!==-1&&Object.assign(e,{chainId:this.computedIsLimitOrSwapLabel.chainId}),this.computedIsLimitOrSwapLabel.loading||this.computedIsLimitOrSwapLabel.loadMore||K(o))return;this.setSwapOrLimitHistory(i?{loadMore:!0}:{loading:!0});let r={...e,pageSize:this.history.pageInfo.pageSize,accountId:this.accountStore.computedAccountId},n={...e,pageSize:this.limitHistory.pageInfo.pageSize,accountId:this.accountStore.computedAccountId,statusType:Nt.ALL},a=this.computedCurrentHistoryTabIsLimit?n:r,m=this.computedCurrentHistoryTabIsLimit?Ut:ae,[u,g]=yield B(N.get(m,{params:a}));if(this.setSwapOrLimitHistory(i?{loadMore:!1}:{loading:!1}),u){this.setSwapOrLimitHistory({error:u});return}this.setSucResult(g,i)}).bind(this));s(this,"setSucResult",(t,e)=>{let{data:{dataList:i,pageSize:o,totalCount:r,curPageNum:n}}=t,a=e?this.computedIsLimitOrSwapLabel.list.concat(i):i;this.setSwapOrLimitHistory({list:a,pageInfo:{...this.computedIsLimitOrSwapLabel.pageInfo,total:r,pageSize:o,curPageNum:n},hasMore:Number(r)>a.length})});s(this,"updateSwapAndLimitDataList",t=>{this.computedIsLimitOrSwapLabel.list.forEach((e,i)=>{String(e==null?void 0:e.orderId)===String(t==null?void 0:t.orderId)&&(this.computedIsLimitOrSwapLabel.list[i]={...e,...t})})});s(this,"setChainId",async t=>{this.resetHistoryList(),this.setSwapOrLimitHistory({chainId:t}),await this.fetchHistory()});s(this,"resetHistoryList",()=>{this.setSwapOrLimitHistory({pageInfo:{...Ce},list:[],error:null,loading:!1,loadMore:!1,hasMore:!1,chainId:-1})});s(this,"getLocalPriceFee",(t,e)=>{let{symbol:i,usdToThisRate:o}=this.commonStore.nowCurrencyUnit||{};if(t&&e&&o){let r=Z.mul(Z.mul(t,e),o);return`(${vt(r,i)})`}return""});s(this,"emitOrder",t=>{if(t){let{status:e,orderId:i}=t;e===d.Succeed||e===A.SUCCEED?qt.emit(wt.SUCCESS,{status:0,data:Q(t),message:Ft("transaction success")}):(e===d.Failed||e===A.FAILED)&&qt.emit(wt.FAIL,{data:{orderId:i},status:-1,message:Ft("transaction fail")})}});s(this,"onSocket",(t,e=!0)=>{((t==null?void 0:t.type)==="1"||(t==null?void 0:t.type)==="3")&&(t==null?void 0:t.dexData)&&t.dexData.type!=="approve"&&t.dexData.type!=="register"&&(this.updateSwapAndLimitDataList(t.dexData),this.updateSwapAndLimitDetail(t.dexData),this.updateLimitOuterOrderList(t.dexData),this.updatePendingOrdersByData(t.dexData),this.emitOrder(t.dexData),this.toastSwapAndLimitOrder(e,t.dexData))});s(this,"updateSwapAndLimitDetail",t=>{t.swapTradeType!==c.LimitOrder?this.updateDetailByData(t):this.updateLimitDetailByData(t)});s(this,"updateLimitOuterOrderList",t=>{var e;(e=this.commonStore)!=null&&e.computedCurrentTabIsLimit&&this.rootStore.limitOrderListStore.updateLimitOuterListData(t)});s(this,"toastSwapAndLimitOrder",(t,e)=>{var i,o;t&&!((i=this.commonStore)!=null&&i.computedCurrentTabIsLimit)?this.toastOrder(e):t&&((o=this.commonStore)==null?void 0:o.computedCurrentTabIsLimit)&&this.toastLimitOrder(e)});s(this,"onSocketError",async()=>{let{computedAccountId:t}=this.accountStore,{visible:e,orderId:i}=this.modal;if(!e){let[o]=await B(this.updatePendingOrders(t));o&&se.error("history detail onSocketError",{error:o})}e&&i&&await B(this.updateDetail(i,!0))});s(this,"historyTab","");s(this,"setHistoryTab",t=>{this.historyTab=t});_t(this,{},{autoBind:!0}),this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore}get computedHistoryList(){return this.history.list.map(t=>new et(Q(t)))}get computedLimitHistoryList(){return this.limitHistory.list.map(t=>new et(Q(t)))}get computedTimeGroup(){let t=this.computedCurrentHistoryTabIsLimit?this.computedLimitHistoryList:this.computedHistoryList,e=this.computedCurrentHistoryTabIsLimit?"createTime":"time";return t.reduce((i,o)=>{let r=i.find(n=>n.time===j(o==null?void 0:o[e],{format:"yyyyMMdd"}));return r?r.list.push(o):i.push({time:j(o==null?void 0:o[e],{format:"yyyyMMdd"}),list:[o]}),i},[])}get noData(){return this.computedCurrentHistoryTabIsLimit?!this.computedLimitHistoryList.length:!this.computedHistoryList.length}setHistory(t){this.history={...this.history,...t}}setLimitHistory(t){this.limitHistory={...this.limitHistory,...t}}setPendingOrders(t){this.pendingOrders=t}fetchDetail(t){return this.computedCurrentHistoryTabIsLimit?N.get(ue,{params:{orderId:t}}).then(({data:e})=>e):N.get(me,{params:{orderId:t}}).then(({data:e})=>e)}fetchPendingOrders(t){return N.post(de,{accountId:t}).then(({data:e})=>e)}async updatePendingOrders(t){var i,o;if(re())return;let e;if((i=this.commonStore)!=null&&i.computedCurrentTabIsLimit){let[,r]=await B(N.get(Ut,{params:{accountId:this.accountStore.computedAccountId,chainId:"",pageNum:1,pageSize:10,statusType:Nt.PENDING}}));e=(o=r==null?void 0:r.data)==null?void 0:o.dataList}else{let[,r]=await B(this.fetchPendingOrders(t));e=r}Array.isArray(e)?this.setPendingOrders(e):this.setPendingOrders([])}updatePendingOrdersByData(t){if(!t)return;let e=this.pendingOrders,i=e.findIndex(({orderId:n})=>n===t.orderId),o=i>-1,r=t.swapTradeType===c.LimitOrder?t.status===A.PENDING:Ve.includes(t.status);r?(o&&e.splice(i,1),e.push(t)):!r&&o&&e.splice(i,1),this.setPendingOrders([...e])}async updateDetail(t,e){e||this.setLimitOrSwapDetail({data:null,loading:!0,error:!1});let[i,o]=await B(this.fetchDetail(t));clearInterval(this.timer),i||!o?this.setLimitOrSwapDetail({data:null,error:!0}):(this.setLimitOrSwapDetail({data:o,error:!1}),this.setSwapExpireTime(o),this.setSwapTimeout(Number(o.timeoutTimestamp))),this.setLimitOrSwapDetail({loading:!1})}setLimitOrSwapDetail(t){this.computedCurrentHistoryTabIsLimit?this.setLimitDetail(t):this.setDetail(t)}updateLimitDetailByData(t){let e=this.limitDetail.data,i={data:$t({},e,{...t})};this.setLimitDetail(i)}get computedIsLimitOrSwapLabel(){return this.computedCurrentHistoryTabIsLimit?this.limitHistory:this.history}setSwapOrLimitHistory(t){this.computedCurrentHistoryTabIsLimit?this.setLimitHistory(t):this.setHistory(t)}get computedIsSingleChain(){return[c.SingleChain,c.GasStation].includes(Wt(this,"detail.data.swapTradeType",""))}get computedIsGasStation(){return[c.GasStation,c.GasStationCross].includes(Wt(this,"detail.data.swapTradeType",""))}get computedMainOrderType(){let t=this.detail.data,e="";if(!t)return e;let{swapTradeType:i,hiddenFromOrder:o,toChildOrderDetailVo:r}=t;return i!==c.CrossChain?e=i:o==="1"?e=c.BridgeTo:r?e=c.FromBridgeTo:e=c.FromBridge,e}get computedStepStatus(){var o,r,n,a;let t=this.detail.data,e=m=>m?[d.Waiting,d.Pending].includes(m)?d.Pending:m:"",i=this.computedMainOrderType===c.BridgeTo?e(((o=t==null?void 0:t.bridgeChildOrderDetailVo)==null?void 0:o.status)||""):((r=t==null?void 0:t.bridgeChildOrderDetailVo)==null?void 0:r.status)||"";return[c.BridgeTo,c.CrossBridge].includes(this.computedMainOrderType)&&[d.Failed,d.Canceled].includes(t==null?void 0:t.status)&&(i=t==null?void 0:t.status),{fromSwapStatus:e(((n=t==null?void 0:t.fromChildOrderDetailVo)==null?void 0:n.status)||""),bridgeStatus:i,toSwapStatus:((a=t==null?void 0:t.toChildOrderDetailVo)==null?void 0:a.status)||""}}get computedRatio(){var m;let t=(m=this.detail)==null?void 0:m.data;if(!t)return{fromRatio:0,bridgeRatio:0};let{status:e}=t,i=this.computedStepStatus.bridgeStatus,o=this.computedStepStatus.fromSwapStatus;if(e===d.Succeed||e===d.Canceled||e===d.Failed&&this.computedMainOrderType===c.BridgeTo)return{fromRatio:1,bridgeRatio:1};let n=(this.fromStepCountDownTimeGroup.estimatedTimeTotal-this.fromStepCountDownTimeGroup.estimatedTime)/this.fromStepCountDownTimeGroup.estimatedTimeTotal;n=n>.8||this.fromStepCountDownTimeGroup.estimatedTimeTotal===0?.8:n;let a=(this.bridgeStepCountDownTimeGroup.estimatedTimeTotal-this.bridgeStepCountDownTimeGroup.estimatedTime)/this.bridgeStepCountDownTimeGroup.estimatedTimeTotal;return a=a>.8||this.bridgeStepCountDownTimeGroup.estimatedTimeTotal===0?.8:a,o!==d.Pending&&o!==d.SpeedingUp&&o!==d.Canceling&&(n=1),this.computedMainOrderType===c.FromBridgeTo&&i!==d.Pending&&i!==d.SpeedingUp&&i!==d.Canceling&&(a=0),i===d.Succeed&&(a=1),{fromRatio:n,bridgeRatio:a}}get computedFoldTipToast(){var _,S;let t=(_=this.detail)==null?void 0:_.data;if(!t)return{foldTipType:""};let{bridgeChildOrderDetailVo:e}=t,i=[],o=[],r=!1,n=!1,a=0,m=this.fromStepCountDownTimeGroup.estimatedTime,u=this.bridgeStepCountDownTimeGroup.estimatedTime,g=this.computedMainOrderType===c.FromBridge;this.computedSubOrders.forEach((f,R)=>{(f.tipType===U.from||f.tipType===U.bridge)&&i.push(f),f.errorCode!=="0"&&R<this.computedSubOrders.length-1&&o.push(f)});let h=-1;i.length>0&&(h=(S=i[0])==null?void 0:S.tipType),h===U.bridge&&(a=u),h===U.from&&(a=m),g&&h===U.bridge&&(a=0),h===U.from?n=m===0:h===U.bridge&&(n=u===0);let I={...e,refund:{amount:e!=null&&e.refundAmount?P(e.refundAmount):"",symbol:e==null?void 0:e.refundSymbol,chain:e==null?void 0:e.refundChain}},l=h===U.bridge?I:i==null?void 0:i[0];return o.length>0&&(l=o[o.length-1],r=!0),{foldTipType:h,currentProcessIsTimeOut:n,tipCountDownTime:a,filterProcessItem:l,needShowErrorTip:r}}get computedSubOrders(){var S;let t=this.detail.data;if(!t)return[];let{fromChildOrderDetailVo:e,bridgeChildOrderDetailVo:i}=t,{toChildOrderDetailVo:o,status:r}=t,n=this.computedStepStatus.bridgeStatus,a=this.computedStepStatus.fromSwapStatus,m=this.computedMainOrderType===c.BridgeTo,u=this.computedMainOrderType===c.FromBridgeTo,g=this.computedMainOrderType===c.FromBridge,h=n===d.Pending||n===d.SpeedingUp||this.computedMainOrderType===c.CrossBridge&&r!==d.Failed&&r!==d.Canceled&&r!==d.Succeed||m&&n===d.Waiting?U.bridge:0,I=a===d.Pending||a===d.SpeedingUp?U.from:0,l={bridgeInfo:i==null?void 0:i.bridgeOrderInfoVo,dexBridgeShadowTokenPair:i==null?void 0:i.dexBridgeShadowTokenPairInfoVo,dexBridgeShadowTokenPairChainId:i==null?void 0:i.toChainId,tipInfo:{toTokenSymbol:e==null?void 0:e.toTokenSymbol},bridgeTipInfo:{bridgeName:((S=i==null?void 0:i.bridgeOrderInfoVo)==null?void 0:S.bridgeName)||"",toChainName:(i==null?void 0:i.toChainName)||""}};e={...e,status:this.computedStepStatus.fromSwapStatus};let _=i==null?void 0:i.status;if(i={...i,status:this.computedStepStatus.bridgeStatus},this.computedIsSingleChain||this.computedMainOrderType===c.GasStationCross){let f=!1;return this.timeoutTimestamp?f=!this.expireTime&&e.status===d.Pending:f=e.status===d.Pending,[$(e,"from",{isFromStart:!0,hasTimeoutTips:f,timeoutType:G.SINGLE_TIPS}),$(e,"to",{...l,hiddenExploreUrl:!0,subOrderType:tt.SINGLE})]}else if(this.computedMainOrderType===c.CrossBridge){let f=this.expireTime<1&&(i.status===d.Waiting||i.status===d.Pending);return[$(e,"to",{...l,tipType:h,useCurrencyInputFormat:!0,hasTimeoutTips:f,timeoutType:G[i.status===d.Pending?"BRIDGE":"GAS"]}),$(i,"to",{...l,officialBridgeTime:i==null?void 0:i.officialBridgeTime,subOrderType:tt.CROSS_BRIDGE_SWAP})]}else if([c.BridgeTo,c.FromBridge,c.FromBridgeTo].includes(this.computedMainOrderType)){let f=this.expireTime<1&&(o==null?void 0:o.status)===d.Pending,R=!this.fromStepCountDownTimeGroup.estimatedTime&&(e.status===d.Pending||_===d.Waiting),O=!1,y;m&&!this.bridgeStepCountDownTimeGroup.estimatedTime?_===d.Waiting?(O=!0,y=G.GAS):_===d.Pending&&(O=!0,y=G.BRIDGE):u&&(e==null?void 0:e.status)===d.Succeed&&!this.bridgeStepCountDownTimeGroup.estimatedTime&&(i.status===d.Waiting?(O=!0,y=G.GAS):i.status===d.Pending&&(O=!0,y=G.BRIDGE));let w=[$(e,"from",{isFromStart:!0,ratio:this.computedRatio.fromRatio,showProgressBar:!0,tipType:I,hasTimeoutTips:R,timeoutType:G.SINGLE_TIPS,...l}),$(e,"to",{ratio:this.computedRatio.bridgeRatio,tipType:g&&R?0:h,showProgressBar:u||m,countDownTime:!m&&this.fromStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:O,timeoutType:g?G.SINGLE_TIPS:y,...l,subOrderType:tt.CROSS_FROM_SWAP}),$(i,"to",{...l,countDownTime:this.bridgeStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:g?!1:f,timeoutType:G.SINGLE_TIPS,subOrderType:tt.CROSS_BRIDGE_SWAP})];return m&&w.shift(),(m||u)&&w.push($(o,"to",{subOrderType:tt.CROSS_TO_SWAP})),w}return[]}get computedDataDetail(){return this.computedCurrentHistoryTabIsLimit?this.limitDetail:this.detail}get computedLimitOrderInfo(){var J,It;if(!((J=this.limitDetail)!=null&&J.data))return null;let{swapTradeType:t,createTime:e,fromChildOrderDetailVO:i,price:o,transactionPrice:r,surplus:n,surplusUsdValue:a,totalGasFee:m,totalGasFeeUsdValue:u,transactionTime:g,exploreUrl:h,expireTime:I,userWalletAddress:l,failureReason:_,status:S,dealWarnTag:f,remainTime:R,timeoutToast:O}=(It=this.limitDetail)==null?void 0:It.data,{fromTokenSymbol:y,toTokenSymbol:w,fromAmount:M,toAmount:x,fromChainLogoUrl:q,toChainLogoUrl:ot,fromTokenIcon:X,toTokenIcon:ht,fromChainName:kt,failureReason:Ot}=i,Pt=[A.CANCELLED,A.EXPIRED,A.SUCCEED,A.FAILED].includes(S),V=_||Ot,z=D(M),Tt=F(x),pt={fromAmount:1,fromSymbol:y,toAmount:F(r),toSymbol:w},ft={fromAmount:1,fromSymbol:w,toAmount:F(jt(1).div(r).toString()),toSymbol:y},St={fromAmount:1,fromSymbol:y,toAmount:F(o),toSymbol:w},gt={fromAmount:1,fromSymbol:w,toAmount:F(jt(1).div(o).toString()),toSymbol:y};return{type:t,typeKey:"swaptrade_orders_text_limit_order",status:S,isSuccess:S===A.SUCCEED,isFailed:S===A.FAILED,isSupplyFailed:S===A.FAILED&&V===Gt.NO_SUPPLY,isOtherFailed:S===A.FAILED&&V!==Gt.NO_SUPPLY&&!!V,fromTokenGroupLabel:`${dt("-",z)} ${y}`,fromTokenGroupLabelEquation:`${dt("-",z)} ${L(y)}`,toTokenGroupLabel:`${dt("+",Tt)} ${w}`,toTokenGroupLabelEquation:`${dt("+",Tt)} ${L(w)}`,fromChainLogoUrl:q,fromTokenIcon:X,toChainLogoUrl:ot,toTokenIcon:ht,createTime:e?j(e,{format:"yyyyMMddHHmmss"}):"",expireTime:I?j(I,{format:"yyyyMMddHHmmss"}):"",txTime:g?j(g,{format:"yyyyMMddHHmmss"}):"",networksName:kt,networksLogo:q,price:nt(St),reversePrice:nt(gt),priceEquation:at(St),reversePriceEquation:at(gt),execPrice:r?nt(pt):Ct,reverseExecPrice:nt(ft),execPriceEquation:r?at(pt):Ct,reverseExecPriceEquation:at(ft),fee:m?mt({amount:F(m),symbol:y,extra:this.getLocalPriceFee(1,u,!0)}):Ct,surplus:n?mt({amount:F(n),symbol:w,extra:this.getLocalPriceFee(1,a,!0)}):"",originAddress:l,formatAddress:`${l.substr(0,6)}...${l.substr(l.length-4)}`,exploreUrl:h,fromTokenSymbol:y,failureReason:V,dealWarnTag:f,remainTime:R,timeoutToast:O,showSwapAgainBtn:Pt}}get computedLimitFromToInfo(){var u;let t=(u=this.limitDetail)==null?void 0:u.data;if(!t)return null;let{fromChildOrderDetailVO:e,userWalletAddress:i,swapTradeType:o}=t,{fromChainId:r,fromTokenContractAddress:n,toChainId:a,toTokenContractAddress:m}=e;return{apiRequestParams:{fromChainId:r,toChainId:a,userWalletAddress:i,swapTradeType:o},locationParams:{from:{chainId:r,tokenContractAddress:n},to:{chainId:a,tokenContractAddress:m}}}}get computedSwapFromToInfo(){var m;let t=(m=this.detail)==null?void 0:m.data;if(!t)return null;let{fromChainId:e,fromTokenAddress:i,toChainId:o,toTokenAddress:r,swapTradeType:n,from:a}=t;return{apiRequestParams:{fromChainId:e,toChainId:o,userWalletAddress:a,swapTradeType:n},locationParams:{from:{chainId:e,tokenContractAddress:i},to:{chainId:o,tokenContractAddress:r},inputAmount:this.computedIfSwapFailedAmount||ie}}}get computedFromToInfo(){return this.computedCurrentHistoryTabIsLimit?this.computedLimitFromToInfo:this.computedSwapFromToInfo}getForRefuelFromPrice(t){return t&&!st(t)?P(t):"--"}getReceiveTokenPrice(t){return t&&!st(t)?P(t):"--"}getExplorerUrl(t){return this.computedIsSingleChain?t==null?void 0:t.exploreUrl:""}getOrderFinnishedTime(t,e,i){return[d.Succeed].includes(i)?fe(t,e):"--"}getIsIntentOrder(t){return t!==oe&&t}getFormattedNetworkFee(t){return t?P(t):""}getFormattedOtherFees(t){return t?P(t):""}getOtherFees(t,e){return t&&(e==null?void 0:e.fromTokenSymbol)?`${t} ${e.fromTokenSymbol}`:""}getBridgeFee(t,e){return t?`${t} ${e==null?void 0:e.toTokenSymbol}`:""}getBridgeFeeUsd(t,e,i){return Se(t(e).toString(),i)}getEstimateBridgeFeeAmount(t,e){return t?`${P(t)} ${e}`:""}getEstimateBridgeFeeAmountUsd(t,e,i){return t?vt(i(t).toString(),e):""}getToSwapFee(t,e,i,o){return t?mt({amount:t,symbol:e,extra:this.getLocalPriceFee(i,o)}):""}getFromToPrice(t){return t&&!st(t)&&t!=="-1"?P(jt("1").div(t).toString(10)):"--"}getToFromPrice(t){return t&&!st(t)&&t!=="-1"?P(t):"--"}getGasToken(t,e,i,o,r){return!t||t===je?null:{amount:e,symbol:i,status:t,exploreUrl:o,logoUrl:r}}get computedOrderInfo(){var te;if(!this.detail.data)return null;let{swapTradeType:t,time:e,fromChainName:i,fromChainLogoUrl:o,fromChildOrderDetailVo:r,toChainName:n,toChainLogoUrl:a,networkFee:m,nativeTokenSymbol:u,otherFees:g,from:h,forRefuelFromAmount:I,fromTokenSymbol:l,toTokenSymbol:_,bridgeChildOrderDetailVo:S,receiveTokenStatus:f,receiveTokenExploreUrl:R,receiveTokenAmount:O,receiveTokenSymbol:y,abnormalStatus:w,hiddenFromOrder:M,bridgeFee:x,bridgeFeeUsd:q,estimateBridgeFeeAmount:ot,estimateBridgeFeeAmountUsd:X,toSwapFee:ht,toChainNativeTokenSymbol:kt,hiddenOtherFee:Ot,toChildOrderDetailVo:Pt,price:V,receiveWalletAddress:z,gasStationActivityReward:Tt,fromGasTokenPriceUsd:pt,toGasTokenPriceUsd:ft,receiveTokenLogoUrl:St,errorCode:gt,status:J,orderCompletionTime:It,orderId:we,specialOrderType:be,mevInfo:Le,intentCode:ke}=this.detail.data,{currencyConversion:Xt,computedNowCurrencySymbol:Jt}=this.commonStore,Qt=[{chainName:i,chainLogo:o}];this.computedIsSingleChain||Qt.push({chainName:n,chainLogo:a});let Zt=this.getFormattedNetworkFee(m),Oe=this.getFormattedOtherFees(g),Pe=Yt(x),Fe=Yt(ht),Re=[d.Succeed,d.Failed,d.Canceled].includes(J),De=![c.GasStation,c.GasStationCross].includes(t),Be=Re&&De;return{isSingleChain:this.computedIsSingleChain,type:t,typeKey:Je[t],time:j(e,{format:"yyyyMMddHHmmss"}),networks:Qt,networkFee:Zt?mt({amount:Zt,symbol:this.computedIsGasStation?l:u,extra:this.getLocalPriceFee(m,this.computedIsGasStation?"":pt)}):"--",otherFees:this.getOtherFees(Oe,S),bridgeFee:this.getBridgeFee(Pe,S),bridgeName:(te=S==null?void 0:S.bridgeOrderInfoVo)==null?void 0:te.bridgeName,bridgeFeeUsd:this.getBridgeFeeUsd(Xt,q,Jt),estimateBridgeFeeAmount:this.getEstimateBridgeFeeAmount(ot,u),estimateBridgeFeeAmountUsd:this.getEstimateBridgeFeeAmountUsd(X,Jt,Xt),toSwapFee:this.getToSwapFee(Fe,kt,ht,ft),fromToPrice:this.getFromToPrice(V),toFromPrice:this.getToFromPrice(V),from:h,receiveWalletAddress:z,fromSymbol:l,toSymbol:_,omittedFrom:`${h.substr(0,6)}...${h.substr(h.length-4)}`,omittedTo:`${z.substr(0,6)}...${z.substr(z.length-4)}`,gasToken:this.getGasToken(f,O,y,R,St),abnormalStatus:w,hiddenFromOrder:M,hiddenOtherFee:Ot,hasToChildOrderDetailVo:!!Pt,forRefuelFromPrice:this.getForRefuelFromPrice(I),receiveTokenPrice:this.getReceiveTokenPrice(O),receiveTokenStatus:f,gasStationActivityReward:Tt,exploreUrl:this.getExplorerUrl(r),errorCode:gt,orderFinishedTime:this.getOrderFinnishedTime(e,It,J),status:J,showSwapAgainBtn:Be,orderId:we,fromChainName:i,specialOrderType:be,mevInfo:Le,isIntentOrder:this.getIsIntentOrder(ke)}}get computedPendingOrdersCount(){return this.pendingOrders.filter(e=>e.status!==d.PendingCanRedeem).length}get computedOrdersHasFacetSwap(){let t=this.pendingOrders.find(e=>e.status==d.PendingCanRedeem);return{showTip:!!t,data:t||{}}}get computedPendingTimingStatus(){return this.timeoutTimestamp?this.expireTime!==0&&this.timeoutTimestamp?ut.ESTIMATE:!this.expireTime&&this.timeoutTimestamp?ut.EXCEED_ESTIMATE:!this.expireTime&&!this.timeoutTimestamp?ut.TIMEOUT:1:ut.TIMEOUT}toastOrder(t){var e,i;if(t){let{status:o,orderId:r,fromAmount:n,fromTokenSymbol:a,toAmount:m,toTokenSymbol:u,fromChildOrder:g,receiveTokenStatus:h,type:I}=t,l=`${r}_${o}`;if(ne()||W.includes(l))return;let _=()=>{W.unshift(l),W=W.slice(0,ye)},S=h!==Ke;if(o===d.Pending&&(g==null?void 0:g.status)===d.Pending)_(),lt({title:b("wallet_swap_toast_swap_submitted")});else if(o===d.Succeed&&S){let f=this.computedSubOrders;_(),lt({title:b("swaptrade_toast_swap_success",{fromCount:D(n,{needBillionMillionUnit:!0}),fromToken:L(a),toCount:P(m),toToken:L(u)}),exploreUrl:(e=f[f.length-1])==null?void 0:e.exploreUrl})}else if(o===d.Failed&&S){let R=this.computedSubOrders.filter(O=>O.status===d.Failed);_(),Lt({title:I==="gasStation"?b("swaptrade_gasstation_toast_refill_failed",{nativeToken:L(u)}):b("wallet_swap_toast_swap_failed"),exploreUrl:(i=R[R.length-1])==null?void 0:i.exploreUrl})}else o===d.Canceled&&S&&(lt({title:b("swaptrade_placeorder_toast_transaction_canceled")}),_())}}toastLimitOrder(t){if(t){let{status:e,orderId:i,fromChildOrderDetailVO:o,failureReason:r}=t,{fromAmount:n,fromTokenSymbol:a,toAmount:m,toTokenSymbol:u,failureReason:g,exploreUrl:h}=o,I=`${i}_${e}`;if(W.includes(I))return;let l=()=>{W.unshift(I),W=W.slice(0,ye)};e===A.OPEN?(l(),zt({title:b("swaptrade_orders_notif_limitorder_submitted",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})})):e===A.SUCCEED?(l(),lt({title:b("swaptrade_orders_notif_limitorder_success",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:a,receiveValue:F(m),receiveToken:u}),exploreUrl:h})):e===A.FAILED&&r?(l(),Lt({title:b("swaptrade_orders_notif_limitorder_failed",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})})):e===A.FAILED&&g?(l(),Lt({title:b("swaptrade_orders_notif_limitorder_failed",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)}),exploreUrl:h})):e===A.CANCELLED?(zt({title:b("swaptrade_orders_notif_limitorder_canceled",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})}),l()):e===A.EXPIRED&&(_e({title:b("swaptrade_orders_notif_limitorder_expired",{sellValue:D(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)}),exploreUrl:h}),l())}}get computedCurrentHistoryTabIsLimit(){return this.historyTab===p.LIMIT_ORDER}get computedOrigin(){return this.historyTab===p.LIMIT_ORDER?p.LIMIT_ORDER:[c.SingleChain,c.GasStation].includes(this.computedMainOrderType)?p.SWAP:p.BRIDGE}get computedIfSwapFailedAmount(){var e;let t=(e=this.detail)==null?void 0:e.data;return(t==null?void 0:t.status)===d.Failed&&!this.computedCurrentHistoryTabIsLimit&&Et(t==null?void 0:t.fromAmount)?t.fromAmount:""}},xi=Kt;C();E();var Hi="",Wi="hide_detail_alert";C();E();C();E();function Ee(T){return![...Object.values((T==null?void 0:T.from)||{}),...Object.values((T==null?void 0:T.to)||{})].some(t=>t)}C();E();var io=(T,t)=>!!T.find(i=>Number(t)===Number(i.chainId)),Ae=T=>{if(!T)return!1;let{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o}=T,r=[k(t)&&i,k(e)&&o];return!!pe(r,Boolean)};var{BigNumber:Ze}=Z,ti=()=>({from:{chainId:null,tokenContractAddress:null},to:{chainId:null,tokenContractAddress:null}}),To={BRIDGE:"bridge",SWAP:"swap"},it=class{constructor(t,e,i={}){s(this,"setTab",t=>{this.tab=t});s(this,"hasFromToToken",t=>{var e,i,o,r;return this.tab===p.LIMIT_ORDER?!K((e=t==null?void 0:t.data)==null?void 0:e.fromToken)&&!K((i=t==null?void 0:t.data)==null?void 0:i.toToken):!K((o=t==null?void 0:t.data)==null?void 0:o.fromTokenInfo)&&!K((r=t==null?void 0:t.data)==null?void 0:r.toTokenInfo)});s(this,"fetchSingleChainTokens",async({fromTokenAddress:t,toTokenAddress:e,chainId:i})=>{let[o,r]=await B(N.get(le,{params:{fromTokenAddress:t,toTokenAddress:e,chainId:i}}));return[o,r]});s(this,"generateSingleChainTokenPair",async({walletChainId:t,...e})=>{let o={chainId:k(e.fromChainId)?e.fromChainId:e.toChainId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress};if(k(o.chainId)){let[a,m]=await this.fetchSingleChainTokens(o);if(!a&&this.hasFromToToken(m))return[a,m]}if(k(t)){let[a,m]=await this.fetchSingleChainTokens({chainId:t});if(!a&&this.hasFromToToken(m))return[a,m]}let[r,n]=await this.fetchSingleChainTokens({chainId:yt});return[r,n]});s(this,"getInterfaceParams",({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o})=>this.config.useCrossTokenCheck?{url:ce,params:{chainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o}}:{url:Mt,params:{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o}});s(this,"fetchCrossChainTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o})=>{let{url:r,params:n}=this.getInterfaceParams({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o}),[a,m]=await B(N.get(r,{params:n}));return[a,m]});s(this,"generateCrossChainTokenPair",async({walletChainId:t,...e})=>{if(k(e.fromChainId)||k(e.toChainId)){let[r,n]=await this.fetchCrossChainTokens(e);if(!r&&this.hasFromToToken(n))return[r,n]}if(k(t)){let[r,n]=await this.fetchCrossChainTokens({fromChainId:t});if(!r&&this.hasFromToToken(n))return[r,n]}let[i,o]=await this.fetchCrossChainTokens({fromChainId:yt});return[i,o]});s(this,"fetchLimitOrderRecommendTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o})=>{let[r,n]=await B(N.get(he,{params:{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:o}}));return[r,n]});s(this,"generateLimitOrderTokenPair",async({walletChainId:t,...e})=>{let i=k(e.fromChainId),r=k(e.toChainId)?e.fromChainId===e.toChainId:!0;if(i&&r){let[m,u]=await this.fetchLimitOrderRecommendTokens(e);if(!m&&this.hasFromToToken(u))return[m,u]}if(k(t)){let[m,u]=await this.fetchLimitOrderRecommendTokens({fromChainId:t});if(!m&&this.hasFromToToken(u))return[m,u]}let[n,a]=await this.fetchLimitOrderRecommendTokens({fromChainId:yt,fromTokenAddress:""});return[n,a]});s(this,"getTokenPairByResponseData",t=>this.tab===p.LIMIT_ORDER?{from:t==null?void 0:t.fromToken,to:t==null?void 0:t.toToken}:{from:t==null?void 0:t.fromTokenInfo,to:t==null?void 0:t.toTokenInfo});s(this,"generateTokenAndTabConfig",({error:t,data:e})=>{if(t)return{error:t,from:null,to:null,tab:this.tab};let{from:i,to:o}=this.getTokenPairByResponseData(e);return{error:null,from:i,to:o,tab:this.tab}});s(this,"checkInputAmount",t=>{let e=new Ze(t);return!e.isNaN()&&e.isFinite()&&e.gt(0)?e.toString():""});s(this,"generateInitConfigByParams",async({from:t,to:e,inputAmount:i,walletChainId:o})=>{let r=this.checkInputAmount(i),n={fromChainId:t.chainId,toChainId:e.chainId,fromTokenAddress:t.tokenContractAddress,toTokenAddress:e.tokenContractAddress,walletChainId:o};if(this.tab===p.BRIDGE){let[a,m]=await this.generateCrossChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:r}}if(this.tab===p.SWAP){let[a,m]=await this.generateSingleChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:r}}if(this.tab===p.LIMIT_ORDER){let[a,m]=await this.generateLimitOrderTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:r}}return{error:new Error("tab is not valid"),from:null,to:null,tab:this.tab,inputAmount:r}});this.setTab(t),this.dexParams=e,this.config=i}makeDexParams(){let{dexParams:t}=this;return Ee(t)?this.readInfoFromLocalStorage():t}async initTokenPair(t){let e=this.makeDexParams(),{from:i,to:o,tab:r,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,walletChainId:t});return{from:i,to:o,tab:r,inputAmount:n,error:a}}async switchTabAndInitToken(t){let e=this.makeDexParams(),{from:i,to:o,tab:r,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,tab:t});return{from:i,to:o,tab:r,inputAmount:n,error:a}}readInfoFromLocalStorage(){var o,r;let t=ti(),e;switch(this.tab){case p.SWAP:e=v.get(Rt);break;case p.BRIDGE:e=v.get(Dt);break;case p.LIMIT_ORDER:e=v.get(Bt)||((o=v.get(xt))==null?void 0:o.LIMIT_ORDER);break;default:break}let i={from:{...t.from,...e==null?void 0:e.from},to:{...t.to,...e==null?void 0:e.to}};return(r=e==null?void 0:e.from)!=null&&r.tokenContractAddress?i:t}writeTabInfoToLocalStorage(t){switch(this.tab){case p.SWAP:v.set(Rt,t);break;case p.BRIDGE:v.set(Dt,t);break;case p.LIMIT_ORDER:v.set(Bt,t);break;default:break}}},Y=it;s(Y,"checkTokenParams",(t,e)=>{let i=Ae({fromChainId:t==null?void 0:t.chainId,toChainId:e==null?void 0:e.chainId,fromTokenAddress:t==null?void 0:t.tokenContractAddress,toTokenAddress:e==null?void 0:e.tokenContractAddress}),o=k(t==null?void 0:t.chainId)&&!!(t!=null&&t.tokenContractAddress),r=k(e==null?void 0:e.chainId)&&!!(e!=null&&e.tokenContractAddress);return{isValid:i,hasFrom:o,hasTo:r}}),s(Y,"judgeTabTypeByChainId",async t=>{let[e,i]=await B(N.get(Te));if(e)return p.SWAP;let{swap:o=[],bridge:r=[]}=i.data;return o.includes(Ht(t))?p.SWAP:r.includes(Ht(t))?p.BRIDGE:p.SWAP}),s(Y,"judgeTabTypeByParams",async(t,e)=>{let{isValid:i,hasFrom:o,hasTo:r}=it.checkTokenParams(t,e);if(!i)return p.SWAP;let n=t==null?void 0:t.chainId,a=e==null?void 0:e.chainId;if(o&&r)return n===a?p.SWAP:p.BRIDGE;let m;return o&&!r&&(m=n),!o&&r&&(m=a),await it.judgeTabTypeByChainId(m)}),s(Y,"formatDialogParams",t=>({from:{chainId:t==null?void 0:t.fromChainId,tokenContractAddress:t==null?void 0:t.fromTokenAddress},to:{chainId:t==null?void 0:t.toChainId,tokenContractAddress:t==null?void 0:t.toTokenAddress}})),s(Y,"getDialogInitTab",async t=>{let{from:e,to:i}=it.formatDialogParams(t);return await it.judgeTabTypeByParams(e,i)});var po=Y;export{io as a,To as b,po as c,ei as d,ut as e,ii as f,G as g,tt as h,wt as i,qt as j,lt as k,Lt as l,zt as m,d as n,c as o,U as p,xi as q,Hi as r,Wi as s};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-THYNIMEO.js.map
